/data/zhaorong/code/fused-attention/include/fused_attn.cuh -> /data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh [ok]
/data/zhaorong/code/fused-attention/src/fused_attn_extention.cu -> /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip [skipped, already hipified]
Total number of unsupported CUDA function calls: 0


Total number of replaced kernel launches: 1
running install
running bdist_egg
running egg_info
creating fused_attn.egg-info
writing fused_attn.egg-info/PKG-INFO
writing dependency_links to fused_attn.egg-info/dependency_links.txt
writing top-level names to fused_attn.egg-info/top_level.txt
writing manifest file 'fused_attn.egg-info/SOURCES.txt'
reading manifest file 'fused_attn.egg-info/SOURCES.txt'
writing manifest file 'fused_attn.egg-info/SOURCES.txt'
installing library code to build/bdist.linux-x86_64/egg
running install_lib
running build_ext
building 'fused_attn' extension
creating /data/zhaorong/code/fused-attention/build
creating /data/zhaorong/code/fused-attention/build/temp.linux-x86_64-cpython-38
creating /data/zhaorong/code/fused-attention/build/temp.linux-x86_64-cpython-38/data
creating /data/zhaorong/code/fused-attention/build/temp.linux-x86_64-cpython-38/data/zhaorong
creating /data/zhaorong/code/fused-attention/build/temp.linux-x86_64-cpython-38/data/zhaorong/code
creating /data/zhaorong/code/fused-attention/build/temp.linux-x86_64-cpython-38/data/zhaorong/code/fused-attention
creating /data/zhaorong/code/fused-attention/build/temp.linux-x86_64-cpython-38/data/zhaorong/code/fused-attention/src
Emitting ninja build file /data/zhaorong/code/fused-attention/build/temp.linux-x86_64-cpython-38/build.ninja...
Compiling objects...
Using envvar MAX_JOBS (32) as the number of workers...
[1/1] /opt/rocm/bin/hipcc  -I/data/zhaorong/code/fused-attention/include -I/opt/conda/lib/python3.8/site-packages/torch/include -I/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include -I/opt/conda/lib/python3.8/site-packages/torch/include/TH -I/opt/conda/lib/python3.8/site-packages/torch/include/THC -I/opt/conda/lib/python3.8/site-packages/torch/include/THH -I/opt/rocm/include -I/opt/rocm/miopen/include -I/opt/rocm/hip/include -I/opt/conda/include/python3.8 -c -c /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip -o /data/zhaorong/code/fused-attention/build/temp.linux-x86_64-cpython-38/data/zhaorong/code/fused-attention/src/fused_attn_extention.o -fPIC -D__HIP_PLATFORM_HCC__=1 -DUSE_ROCM=1 -DCUDA_HAS_FP16=1 -D__HIP_NO_HALF_OPERATORS__=1 -D__HIP_NO_HALF_CONVERSIONS__=1 -O3 -std=c++20 -I/opt/rocm/include -I/opt/rocm/hip/include --no-offload-arch=gfx1030 --no-offload-arch=gfx900 --no-offload-arch=gfx906 --no-offload-arch=gfx908 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1013"' -DTORCH_EXTENSION_NAME=fused_attn -D_GLIBCXX_USE_CXX11_ABI=1 --amdgpu-target=gfx900 --amdgpu-target=gfx906 --amdgpu-target=gfx908 --amdgpu-target=gfx90a --amdgpu-target=gfx1030 -fno-gpu-rdc
Warning: The --amdgpu-target option has been deprecated and will be removed in the future.  Use --offload-arch instead.
Warning: The --amdgpu-target option has been deprecated and will be removed in the future.  Use --offload-arch instead.
Warning: The --amdgpu-target option has been deprecated and will be removed in the future.  Use --offload-arch instead.
Warning: The --amdgpu-target option has been deprecated and will be removed in the future.  Use --offload-arch instead.
Warning: The --amdgpu-target option has been deprecated and will be removed in the future.  Use --offload-arch instead.
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
/opt/rocm/hip/include/hip/hip_runtime.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:59:
/opt/rocm/hip/include/hip/hip_common.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
/opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:32:
/opt/rocm/hip/include/hip/amd_detail/amd_hip_common.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:105:
/opt/rocm/hip/include/hip/hip_runtime_api.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:105:
In file included from /opt/rocm/hip/include/hip/hip_runtime_api.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime_api.h:480:
/opt/rocm/hip/include/hip/amd_detail/host_defines.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:105:
In file included from /opt/rocm/hip/include/hip/hip_runtime_api.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime_api.h:481:
/opt/rocm/hip/include/hip/driver_types.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:105:
In file included from /opt/rocm/hip/include/hip/hip_runtime_api.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime_api.h:482:
/opt/rocm/hip/include/hip/texture_types.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:105:
In file included from /opt/rocm/hip/include/hip/hip_runtime_api.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime_api.h:482:
In file included from /opt/rocm/hip/include/hip/texture_types.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/texture_types.h:38:
/opt/rocm/hip/include/hip/channel_descriptor.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:105:
In file included from /opt/rocm/hip/include/hip/hip_runtime_api.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime_api.h:482:
In file included from /opt/rocm/hip/include/hip/texture_types.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/texture_types.h:38:
In file included from /opt/rocm/hip/include/hip/channel_descriptor.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/channel_descriptor.h:32:
/opt/rocm/hip/include/hip/amd_detail/amd_channel_descriptor.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:105:
In file included from /opt/rocm/hip/include/hip/hip_runtime_api.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime_api.h:482:
In file included from /opt/rocm/hip/include/hip/texture_types.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/texture_types.h:38:
In file included from /opt/rocm/hip/include/hip/channel_descriptor.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/channel_descriptor.h:32:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_channel_descriptor.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_channel_descriptor.h:28:
/opt/rocm/hip/include/hip/amd_detail/amd_hip_vector_types.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:105:
In file included from /opt/rocm/hip/include/hip/hip_runtime_api.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime_api.h:483:
/opt/rocm/hip/include/hip/surface_types.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:105:
In file included from /opt/rocm/hip/include/hip/hip_runtime_api.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime_api.h:6964:
/opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime_pt_api.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:110:
/opt/rocm/hip/include/hip/amd_detail/hip_ldg.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:112:
/opt/rocm/hip/include/hip/amd_detail/amd_hip_atomic.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:112:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_atomic.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_atomic.h:25:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_device_functions.h:34:
/opt/rocm/hip/include/hip/hip_vector_types.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:112:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_atomic.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_atomic.h:25:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_device_functions.h:35:
/opt/rocm/hip/include/hip/amd_detail/device_library_decls.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:112:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_atomic.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_atomic.h:25:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_device_functions.h:36:
/opt/rocm/hip/include/hip/amd_detail/llvm_intrinsics.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:114:
/opt/rocm/hip/include/hip/amd_detail/amd_device_functions.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:115:
/opt/rocm/hip/include/hip/amd_detail/amd_surface_functions.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:115:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_surface_functions.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_surface_functions.h:30:
/opt/rocm/hip/include/hip/amd_detail/ockl_image.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:116:
/opt/rocm/hip/include/hip/amd_detail/texture_fetch_functions.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:116:
In file included from /opt/rocm/hip/include/hip/amd_detail/texture_fetch_functions.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/texture_fetch_functions.h:28:
/opt/rocm/hip/include/hip/hip_texture_types.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:117:
/opt/rocm/hip/include/hip/amd_detail/texture_indirect_functions.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
/opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:322:16: warning: attribute declaration must precede definition [-Wignored-attributes]
__attribute__((weak))
               ^
/opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:312:24: note: previous definition is here
  static constexpr __X x{};
                       ^
/opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:327:16: warning: attribute declaration must precede definition [-Wignored-attributes]
__attribute__((weak))
               ^
/opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:313:24: note: previous definition is here
  static constexpr __Y y{};
                       ^
/opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:332:16: warning: attribute declaration must precede definition [-Wignored-attributes]
__attribute__((weak))
               ^
/opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:314:24: note: previous definition is here
  static constexpr __Z z{};
                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:399:
/opt/rocm/hip/include/hip/amd_detail/amd_math_functions.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:114:
/opt/rocm/hip/include/hip/library_types.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Storage.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StorageImpl.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarType.h:5:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Half.h:45:
/opt/rocm/hip/include/hip/hip_fp16.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Storage.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StorageImpl.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarType.h:5:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Half.h:45:
In file included from /opt/rocm/hip/include/hip/hip_fp16.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_fp16.h:29:
/opt/rocm/hip/include/hip/amd_detail/amd_hip_fp16.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:580:38: note: in instantiation of template type alias 'OptionalBase' requested here
    return detail_::static_addressof(OptionalBase<T>::storage_.value_);
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:587:22: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::move(OptionalBase<T>::storage_.value_);
                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:596:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(false);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:612:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:648:40: note: in instantiation of template type alias 'OptionalBase' requested here
  explicit constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                                       ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:652:9: note: in instantiation of template type alias 'OptionalBase' requested here
      : OptionalBase<T>(in_place_t{}, constexpr_forward<Args>(args)...) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:662:9: note: in instantiation of template type alias 'OptionalBase' requested here
      : OptionalBase<T>(in_place_t{}, il, constexpr_forward<Args>(args)...) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:30:40: note: in instantiation of template class 'c10::optional<c10::ScalarType>' requested here
static inline optional<at::ScalarType> optTypeMetaToScalarType(
                                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:30:40: note: in instantiation of template class 'c10::optional<c10::ScalarType>' requested here
static inline optional<at::ScalarType> optTypeMetaToScalarType(
                                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:31:32: note: in instantiation of template class 'c10::optional<caffe2::TypeMeta>' requested here
    optional<caffe2::TypeMeta> type_meta) {
                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:31:32: note: in instantiation of template class 'c10::optional<caffe2::TypeMeta>' requested here
    optional<caffe2::TypeMeta> type_meta) {
                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<caffe2::TypeMeta>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:32:18: note: in instantiation of member function 'c10::optional<caffe2::TypeMeta>::has_value' requested here
  if (!type_meta.has_value()) {
                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:33:12: note: in instantiation of member function 'c10::optional<c10::ScalarType>::optional' requested here
    return c10::nullopt;
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:35:10: note: in instantiation of function template specialization 'c10::optional<c10::ScalarType>::optional<c10::ScalarType, false>' requested here
  return type_meta->toScalarType();
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<c10::ScalarType>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:796:12: note: in instantiation of member function 'c10::optional<c10::ScalarType>::has_value' requested here
  return v.has_value() ? *v : detail_::convert<T>(std::forward<F>(func)());
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:28:10: note: in instantiation of function template specialization 'c10::value_or_else<c10::ScalarType, (lambda at /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:28:31)>' requested here
  return value_or_else(dtype, [] { return get_default_dtype_as_scalartype(); });
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<c10::ScalarType>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:796:26: note: in instantiation of member function 'c10::optional<c10::ScalarType>::operator*' requested here
  return v.has_value() ? *v : detail_::convert<T>(std::forward<F>(func)());
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:28:10: note: in instantiation of function template specialization 'c10::value_or_else<c10::ScalarType, (lambda at /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:28:31)>' requested here
  return value_or_else(dtype, [] { return get_default_dtype_as_scalartype(); });
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<caffe2::TypeMeta>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:796:26: note: in instantiation of member function 'c10::optional<caffe2::TypeMeta>::operator*' requested here
  return v.has_value() ? *v : detail_::convert<T>(std::forward<F>(func)());
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:33:10: note: in instantiation of function template specialization 'c10::value_or_else<caffe2::TypeMeta, (lambda at /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:33:31)>' requested here
  return value_or_else(dtype, [] { return get_default_dtype(); });
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:36:55: note: in instantiation of template class 'c10::optional<c10::Layout>' requested here
inline Layout layout_or_default(c10::optional<Layout> layout) {
                                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:36:55: note: in instantiation of template class 'c10::optional<c10::Layout>' requested here
inline Layout layout_or_default(c10::optional<Layout> layout) {
                                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:45: note: in instantiation of member function 'c10::optional<c10::Layout>::initialized' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:773:20: note: in instantiation of member function 'c10::optional<c10::Layout>::operator*' requested here
    return *this ? **this : detail_::convert<T>(constexpr_forward<V>(v));
                   ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:37:17: note: in instantiation of function template specialization 'c10::optional<c10::Layout>::value_or<const c10::Layout &>' requested here
  return layout.value_or(kStrided);
                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<c10::Layout>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:773:20: note: in instantiation of member function 'c10::optional<c10::Layout>::operator*' requested here
    return *this ? **this : detail_::convert<T>(constexpr_forward<V>(v));
                   ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:37:17: note: in instantiation of function template specialization 'c10::optional<c10::Layout>::value_or<const c10::Layout &>' requested here
  return layout.value_or(kStrided);
                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:40:55: note: in instantiation of template class 'c10::optional<c10::Device>' requested here
inline Device device_or_default(c10::optional<Device> device) {
                                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:40:55: note: in instantiation of template class 'c10::optional<c10::Device>' requested here
inline Device device_or_default(c10::optional<Device> device) {
                                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<c10::Device>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:796:12: note: in instantiation of member function 'c10::optional<c10::Device>::has_value' requested here
  return v.has_value() ? *v : detail_::convert<T>(std::forward<F>(func)());
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:41:10: note: in instantiation of function template specialization 'c10::value_or_else<c10::Device, (lambda at /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:41:32)>' requested here
  return value_or_else(device, [] { return Device(kCPU); });
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<c10::Device>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:796:26: note: in instantiation of member function 'c10::optional<c10::Device>::operator*' requested here
  return v.has_value() ? *v : detail_::convert<T>(std::forward<F>(func)());
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:41:10: note: in instantiation of function template specialization 'c10::value_or_else<c10::Device, (lambda at /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:41:32)>' requested here
  return value_or_else(device, [] { return Device(kCPU); });
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:44:58: note: in instantiation of template class 'c10::optional<bool>' requested here
inline bool pinned_memory_or_default(c10::optional<bool> pinned_memory) {
                                                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:44:58: note: in instantiation of template class 'c10::optional<bool>' requested here
inline bool pinned_memory_or_default(c10::optional<bool> pinned_memory) {
                                                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:45: note: in instantiation of member function 'c10::optional<bool>::initialized' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:773:20: note: in instantiation of member function 'c10::optional<bool>::operator*' requested here
    return *this ? **this : detail_::convert<T>(constexpr_forward<V>(v));
                   ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:45:24: note: in instantiation of function template specialization 'c10::optional<bool>::value_or<bool>' requested here
  return pinned_memory.value_or(false);
                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<bool>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:773:20: note: in instantiation of member function 'c10::optional<bool>::operator*' requested here
    return *this ? **this : detail_::convert<T>(constexpr_forward<V>(v));
                   ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:45:24: note: in instantiation of function template specialization 'c10::optional<bool>::value_or<bool>' requested here
  return pinned_memory.value_or(false);
                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:148:22: note: in instantiation of function template specialization 'c10::optional<c10::Layout>::optional<c10::Layout &, false>' requested here
    this->set_layout(layout);
                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:177:21: note: in instantiation of function template specialization 'c10::optional<caffe2::TypeMeta>::optional<caffe2::TypeMeta &, false>' requested here
    this->set_dtype(dtype);
                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:182:21: note: in instantiation of function template specialization 'c10::optional<c10::ScalarType>::optional<c10::ScalarType &, false>' requested here
    this->set_dtype(dtype);
                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:187:23: note: in instantiation of template class 'c10::optional<c10::MemoryFormat>' requested here
    set_memory_format(memory_format);
                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:187:23: note: in instantiation of template class 'c10::optional<c10::MemoryFormat>' requested here
    set_memory_format(memory_format);
                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:187:23: note: in instantiation of function template specialization 'c10::optional<c10::MemoryFormat>::optional<c10::MemoryFormat &, false>' requested here
    set_memory_format(memory_format);
                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:1215:10: note: in instantiation of function template specialization 'c10::optional<c10::Device>::optional<const c10::Device &, false>' requested here
  return optional<typename std::decay<T>::type>(constexpr_forward<T>(v));
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:287:31: note: in instantiation of function template specialization 'c10::make_optional<const c10::Device &>' requested here
    return has_device_ ? c10::make_optional(device_) : c10::nullopt;
                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:287:56: note: in instantiation of member function 'c10::optional<c10::Device>::optional' requested here
    return has_device_ ? c10::make_optional(device_) : c10::nullopt;
                                                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:1215:10: note: in instantiation of function template specialization 'c10::optional<caffe2::TypeMeta>::optional<const caffe2::TypeMeta &, false>' requested here
  return optional<typename std::decay<T>::type>(constexpr_forward<T>(v));
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:308:30: note: in instantiation of function template specialization 'c10::make_optional<const caffe2::TypeMeta &>' requested here
    return has_dtype_ ? c10::make_optional(dtype_) : c10::nullopt;
                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:308:54: note: in instantiation of member function 'c10::optional<caffe2::TypeMeta>::optional' requested here
    return has_dtype_ ? c10::make_optional(dtype_) : c10::nullopt;
                                                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:1215:10: note: in instantiation of function template specialization 'c10::optional<c10::Layout>::optional<const c10::Layout &, false>' requested here
  return optional<typename std::decay<T>::type>(constexpr_forward<T>(v));
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:324:31: note: in instantiation of function template specialization 'c10::make_optional<const c10::Layout &>' requested here
    return has_layout_ ? c10::make_optional(layout_) : c10::nullopt;
                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:324:56: note: in instantiation of member function 'c10::optional<c10::Layout>::optional' requested here
    return has_layout_ ? c10::make_optional(layout_) : c10::nullopt;
                                                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:1215:10: note: in instantiation of function template specialization 'c10::optional<bool>::optional<const bool &, false>' requested here
  return optional<typename std::decay<T>::type>(constexpr_forward<T>(v));
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:340:38: note: in instantiation of function template specialization 'c10::make_optional<const bool &>' requested here
    return has_requires_grad_ ? c10::make_optional(requires_grad_)
                                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:341:33: note: in instantiation of member function 'c10::optional<bool>::optional' requested here
                              : c10::nullopt;
                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:1215:10: note: in instantiation of function template specialization 'c10::optional<c10::MemoryFormat>::optional<const c10::MemoryFormat &, false>' requested here
  return optional<typename std::decay<T>::type>(constexpr_forward<T>(v));
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:387:38: note: in instantiation of function template specialization 'c10::make_optional<const c10::MemoryFormat &>' requested here
    return has_memory_format_ ? c10::make_optional(memory_format_)
                                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:388:33: note: in instantiation of member function 'c10::optional<c10::MemoryFormat>::optional' requested here
                              : c10::nullopt;
                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<c10::MemoryFormat>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:429:32: note: in instantiation of member function 'c10::optional<c10::MemoryFormat>::has_value' requested here
    if (optional_memory_format.has_value()) {
                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<c10::MemoryFormat>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:430:32: note: in instantiation of member function 'c10::optional<c10::MemoryFormat>::operator*' requested here
      merged.set_memory_format(*optional_memory_format);
                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<c10::Device>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:460:17: note: in instantiation of member function 'c10::optional<c10::Device>::operator*' requested here
      device_ = *device;
                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<caffe2::TypeMeta>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:470:16: note: in instantiation of member function 'c10::optional<caffe2::TypeMeta>::operator*' requested here
      dtype_ = *dtype;
               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<c10::ScalarType>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:480:37: note: in instantiation of member function 'c10::optional<c10::ScalarType>::operator*' requested here
      dtype_ = scalarTypeToTypeMeta(*dtype);
                                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<c10::Layout>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:490:17: note: in instantiation of member function 'c10::optional<c10::Layout>::operator*' requested here
      layout_ = *layout;
                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<bool>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:500:24: note: in instantiation of member function 'c10::optional<bool>::operator*' requested here
      requires_grad_ = *requires_grad;
                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:573:32: note: in instantiation of function template specialization 'c10::optional<caffe2::TypeMeta>::optional<caffe2::TypeMeta, false>' requested here
  return TensorOptions().dtype(scalarTypeToTypeMeta(dtype));
                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:598:40: note: in instantiation of function template specialization 'c10::optional<bool>::optional<bool &, false>' requested here
  return TensorOptions().requires_grad(requires_grad);
                                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:828:15: note: in instantiation of function template specialization 'c10::optional<c10::Layout>::optional<c10::Layout, false>' requested here
      .layout(dispatchKeyToLayout(dispatch_key))
              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:1658:28: note: in instantiation of template class 'c10::optional<_object *>' requested here
  c10::optional<PyObject*> check_pyobj(impl::PyInterpreter* self_interpreter) {
                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:1658:28: note: in instantiation of template class 'c10::optional<_object *>' requested here
  c10::optional<PyObject*> check_pyobj(impl::PyInterpreter* self_interpreter) {
                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:1668:14: note: in instantiation of member function 'c10::optional<_object *>::optional' requested here
      return c10::nullopt;
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:1215:10: note: in instantiation of function template specialization 'c10::optional<_object *>::optional<_object *, false>' requested here
  return optional<typename std::decay<T>::type>(constexpr_forward<T>(v));
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:1671:19: note: in instantiation of function template specialization 'c10::make_optional<_object *>' requested here
      return c10::make_optional(_unchecked_untagged_pyobj());
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:146:60: note: in instantiation of template class 'c10::optional<at::Generator>' requested here
static inline T * check_generator(c10::optional<Generator> gen) {
                                                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:146:60: note: in instantiation of template class 'c10::optional<at::Generator>' requested here
static inline T * check_generator(c10::optional<Generator> gen) {
                                                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<at::Generator>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:147:19: note: in instantiation of member function 'c10::optional<at::Generator>::has_value' requested here
  TORCH_CHECK(gen.has_value(), "Expected Generator but received nullopt");
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:580:38: note: in instantiation of template type alias 'OptionalBase' requested here
    return detail_::static_addressof(OptionalBase<T>::storage_.value_);
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:731:60: note: in instantiation of member function 'c10::optional<at::Generator>::dataptr' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), dataptr());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:161:32: note: in instantiation of member function 'c10::optional<at::Generator>::operator->' requested here
  return gen.has_value() && gen->defined() ? check_generator<T>(gen) : check_generator<T>(default_gen);
                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/CPUGeneratorImpl.h:35:24: note: in instantiation of template class 'c10::optional<float>' requested here
  c10::optional<float> next_float_normal_sample_;
                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/CPUGeneratorImpl.h:35:24: note: in instantiation of template class 'c10::optional<float>' requested here
  c10::optional<float> next_float_normal_sample_;
                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/CPUGeneratorImpl.h:36:25: note: in instantiation of template class 'c10::optional<double>' requested here
  c10::optional<double> next_double_normal_sample_;
                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/CPUGeneratorImpl.h:36:25: note: in instantiation of template class 'c10::optional<double>' requested here
  c10::optional<double> next_double_normal_sample_;
                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/DeprecatedTypeProperties.h:128:91: note: in instantiation of member function 'c10::optional<c10::Device>::optional' requested here
  Tensor copy(const Tensor & src, bool non_blocking=false, c10::optional<Device> to_device={}) const;
                                                                                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:264:30: note: in instantiation of template class 'c10::optional<c10::QEngine>' requested here
  c10::optional<at::QEngine> quantized_engine = c10::nullopt;
                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:264:30: note: in instantiation of template class 'c10::optional<c10::QEngine>' requested here
  c10::optional<at::QEngine> quantized_engine = c10::nullopt;
                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:264:49: note: in instantiation of member function 'c10::optional<c10::QEngine>::optional' requested here
  c10::optional<at::QEngine> quantized_engine = c10::nullopt;
                                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:239:60: note: in instantiation of template class 'c10::optional<signed char>' requested here
  explicit InlineOptionalDeviceGuard(optional<DeviceIndex> device_index_opt)
                                                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:239:60: note: in instantiation of template class 'c10::optional<signed char>' requested here
  explicit InlineOptionalDeviceGuard(optional<DeviceIndex> device_index_opt)
                                                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<signed char>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:241:26: note: in instantiation of member function 'c10::optional<signed char>::has_value' requested here
    if (device_index_opt.has_value()) {
                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:761:11: note: in instantiation of member function 'c10::optional<signed char>::contained_val' requested here
        ? contained_val()
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:242:39: note: in instantiation of member function 'c10::optional<signed char>::value' requested here
      guard_.emplace(device_index_opt.value());
                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:427:34: note: in instantiation of template class 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>' requested here
  optional<InlineDeviceGuard<T>> guard_;
                                 ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceGuard.h:178:59: note: in instantiation of template class 'c10::impl::InlineOptionalDeviceGuard<c10::impl::VirtualGuardImpl>' requested here
  impl::InlineOptionalDeviceGuard<impl::VirtualGuardImpl> guard_;
                                                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:427:34: note: in instantiation of template class 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>' requested here
  optional<InlineDeviceGuard<T>> guard_;
                                 ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceGuard.h:178:59: note: in instantiation of template class 'c10::impl::InlineOptionalDeviceGuard<c10::impl::VirtualGuardImpl>' requested here
  impl::InlineOptionalDeviceGuard<impl::VirtualGuardImpl> guard_;
                                                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/OptionalArrayRef.h:208:25: note: in instantiation of template class 'c10::optional<c10::ArrayRef<long>>' requested here
  optional<ArrayRef<T>> wrapped_opt_array_ref;
                        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/OptionalArrayRef.h:216:10: note: in instantiation of template class 'c10::OptionalArrayRef<long>' requested here
  if (!a1.has_value()) {
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/OptionalArrayRef.h:208:25: note: in instantiation of template class 'c10::optional<c10::ArrayRef<long>>' requested here
  optional<ArrayRef<T>> wrapped_opt_array_ref;
                        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/OptionalArrayRef.h:216:10: note: in instantiation of template class 'c10::OptionalArrayRef<long>' requested here
  if (!a1.has_value()) {
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<c10::ArrayRef<long>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/OptionalArrayRef.h:148:34: note: in instantiation of member function 'c10::optional<c10::ArrayRef<long>>::has_value' requested here
    return wrapped_opt_array_ref.has_value();
                                 ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/OptionalArrayRef.h:216:11: note: in instantiation of member function 'c10::OptionalArrayRef<long>::has_value' requested here
  if (!a1.has_value()) {
          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:755:11: note: in instantiation of member function 'c10::optional<c10::ArrayRef<long>>::contained_val' requested here
        ? contained_val()
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/OptionalArrayRef.h:156:34: note: in instantiation of member function 'c10::optional<c10::ArrayRef<long>>::value' requested here
    return wrapped_opt_array_ref.value();
                                 ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/OptionalArrayRef.h:219:13: note: in instantiation of member function 'c10::OptionalArrayRef<long>::value' requested here
  return a1.value() == other;
            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBase.h:230:30: note: in instantiation of template class 'c10::optional<c10::ArrayRef<at::Dimname>>' requested here
  c10::optional<DimnameList> opt_names() const {
                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBase.h:230:30: note: in instantiation of template class 'c10::optional<c10::ArrayRef<at::Dimname>>' requested here
  c10::optional<DimnameList> opt_names() const {
                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBase.h:951:13: note: in instantiation of template class 'c10::optional<at::TensorBase>' requested here
  return opt.has_value()
            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBase.h:951:13: note: in instantiation of template class 'c10::optional<at::TensorBase>' requested here
  return opt.has_value()
            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<at::TensorBase>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBase.h:951:14: note: in instantiation of member function 'c10::optional<at::TensorBase>::has_value' requested here
  return opt.has_value()
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<at::TensorBase>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBase.h:952:45: note: in instantiation of member function 'c10::optional<at::TensorBase>::operator*' requested here
    ? c10::MaybeOwned<TensorBase>::borrowed(*opt)
                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:424:143: note: in instantiation of template class 'c10::optional<c10::ArrayRef<at::Tensor>>' requested here
  void backward(const Tensor & gradient={}, c10::optional<bool> retain_graph=c10::nullopt, bool create_graph=false, c10::optional<TensorList> inputs=c10::nullopt) const {
                                                                                                                                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:424:143: note: in instantiation of template class 'c10::optional<c10::ArrayRef<at::Tensor>>' requested here
  void backward(const Tensor & gradient={}, c10::optional<bool> retain_graph=c10::nullopt, bool create_graph=false, c10::optional<TensorList> inputs=c10::nullopt) const {
                                                                                                                                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:424:150: note: in instantiation of member function 'c10::optional<c10::ArrayRef<at::Tensor>>::optional' requested here
  void backward(const Tensor & gradient={}, c10::optional<bool> retain_graph=c10::nullopt, bool create_graph=false, c10::optional<TensorList> inputs=c10::nullopt) const {
                                                                                                                                                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:509:95: note: in instantiation of template class 'c10::optional<at::Tensor>' requested here
  void __dispatch__backward(at::TensorList inputs, const c10::optional<at::Tensor> & gradient={}, c10::optional<bool> retain_graph=c10::nullopt, bool create_graph=false) const;
                                                                                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:509:95: note: in instantiation of template class 'c10::optional<at::Tensor>' requested here
  void __dispatch__backward(at::TensorList inputs, const c10::optional<at::Tensor> & gradient={}, c10::optional<bool> retain_graph=c10::nullopt, bool create_graph=false) const;
                                                                                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:509:94: note: in instantiation of member function 'c10::optional<at::Tensor>::optional' requested here
  void __dispatch__backward(at::TensorList inputs, const c10::optional<at::Tensor> & gradient={}, c10::optional<bool> retain_graph=c10::nullopt, bool create_graph=false) const;
                                                                                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:558:44: note: in instantiation of template class 'c10::optional<long>' requested here
  at::Tensor argmax(c10::optional<int64_t> dim=c10::nullopt, bool keepdim=false) const;
                                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:558:44: note: in instantiation of template class 'c10::optional<long>' requested here
  at::Tensor argmax(c10::optional<int64_t> dim=c10::nullopt, bool keepdim=false) const;
                                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:558:48: note: in instantiation of member function 'c10::optional<long>::optional' requested here
  at::Tensor argmax(c10::optional<int64_t> dim=c10::nullopt, bool keepdim=false) const;
                                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:584:63: note: in instantiation of member function 'c10::optional<at::Generator>::optional' requested here
  at::Tensor bernoulli(c10::optional<at::Generator> generator=c10::nullopt) const;
                                                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:612:93: note: in instantiation of template class 'c10::optional<c10::Scalar>' requested here
  at::Tensor clamp(const c10::optional<at::Scalar> & min, const c10::optional<at::Scalar> & max=c10::nullopt) const;
                                                                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:612:93: note: in instantiation of template class 'c10::optional<c10::Scalar>' requested here
  at::Tensor clamp(const c10::optional<at::Scalar> & min, const c10::optional<at::Scalar> & max=c10::nullopt) const;
                                                                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:612:97: note: in instantiation of member function 'c10::optional<c10::Scalar>::optional' requested here
  at::Tensor clamp(const c10::optional<at::Scalar> & min, const c10::optional<at::Scalar> & max=c10::nullopt) const;
                                                                                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:706:97: note: in instantiation of member function 'c10::optional<c10::ArrayRef<at::Dimname>>::optional' requested here
  at::Tensor unflatten(int64_t dim, at::IntArrayRef sizes, c10::optional<at::DimnameList> names=c10::nullopt) const;
                                                                                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:746:51: note: in instantiation of member function 'c10::optional<double>::optional' requested here
  at::Tensor nan_to_num(c10::optional<double> nan=c10::nullopt, c10::optional<double> posinf=c10::nullopt, c10::optional<double> neginf=c10::nullopt) const;
                                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:1215:103: note: in instantiation of template class 'c10::optional<c10::ArrayRef<double>>' requested here
  ::std::tuple<at::Tensor,at::Tensor> histogram(int64_t bins=100, c10::optional<at::ArrayRef<double>> range=c10::nullopt, const c10::optional<at::Tensor> & weight={}, bool density=false) const;
                                                                                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:1215:103: note: in instantiation of template class 'c10::optional<c10::ArrayRef<double>>' requested here
  ::std::tuple<at::Tensor,at::Tensor> histogram(int64_t bins=100, c10::optional<at::ArrayRef<double>> range=c10::nullopt, const c10::optional<at::Tensor> & weight={}, bool density=false) const;
                                                                                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:1215:109: note: in instantiation of member function 'c10::optional<c10::ArrayRef<double>>::optional' requested here
  ::std::tuple<at::Tensor,at::Tensor> histogram(int64_t bins=100, c10::optional<at::ArrayRef<double>> range=c10::nullopt, const c10::optional<at::Tensor> & weight={}, bool density=false) const;
                                                                                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/OptionalArrayRef.h:26:13: note: in instantiation of member function 'c10::optional<c10::ArrayRef<long>>::optional' requested here
  constexpr OptionalArrayRef(nullopt_t) noexcept {}
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:1277:83: note: in instantiation of member function 'c10::OptionalArrayRef<long>::OptionalArrayRef' requested here
  at::Tensor to_padded_tensor(double padding, at::OptionalIntArrayRef output_size=c10::nullopt) const;
                                                                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<c10::ArrayRef<at::Tensor>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:429:16: note: in instantiation of member function 'c10::optional<c10::ArrayRef<at::Tensor>>::has_value' requested here
    if (inputs.has_value()) {
               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:761:11: note: in instantiation of member function 'c10::optional<c10::ArrayRef<at::Tensor>>::contained_val' requested here
        ? contained_val()
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:430:26: note: in instantiation of member function 'c10::optional<c10::ArrayRef<at::Tensor>>::value' requested here
      TORCH_CHECK(inputs.value().size() > 0, "'inputs' argument to backward cannot be empty")
                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:431:39: note: in instantiation of function template specialization 'c10::optional<at::Tensor>::optional<const at::Tensor &, false>' requested here
      this->_backward(inputs.value(), gradient, retain_graph, create_graph);
                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:2156:89: note: in instantiation of template class 'c10::optional<c10::basic_string_view<char>>' requested here
inline at::Tensor Tensor::div(const at::Tensor & other, c10::optional<c10::string_view> rounding_mode) const {
                                                                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:2156:89: note: in instantiation of template class 'c10::optional<c10::basic_string_view<char>>' requested here
inline at::Tensor Tensor::div(const at::Tensor & other, c10::optional<c10::string_view> rounding_mode) const {
                                                                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<at::Tensor>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:5347:14: note: in instantiation of member function 'c10::optional<at::Tensor>::has_value' requested here
  return opt.has_value()
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<at::Tensor>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:5348:41: note: in instantiation of member function 'c10::optional<at::Tensor>::operator*' requested here
    ? c10::MaybeOwned<Tensor>::borrowed(*opt)
                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:1215:10: note: in instantiation of function template specialization 'c10::optional<c10::Device>::optional<c10::Device, false>' requested here
  return optional<typename std::decay<T>::type>(constexpr_forward<T>(v));
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/DeviceGuard.h:19:17: note: in instantiation of function template specialization 'c10::make_optional<c10::Device>' requested here
    return c10::make_optional(t.device());
                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/ops/from_blob.h:83:36: note: in instantiation of member function 'c10::optional<long>::optional' requested here
  optional<int64_t> storage_offset_{};
                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/OptionalArrayRef.h:52:9: note: in instantiation of function template specialization 'c10::optional<c10::ArrayRef<long>>::optional<c10::ArrayRef<long> &, false>' requested here
      : wrapped_opt_array_ref(value) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/ops/from_blob.h:102:16: note: in instantiation of function template specialization 'c10::OptionalArrayRef<long>::OptionalArrayRef<c10::ArrayRef<long> &, false>' requested here
      .strides(strides)
               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/ops/_empty_affine_quantized.h:26:189: note: in instantiation of function template specialization 'c10::optional<c10::MemoryFormat>::optional<c10::MemoryFormat, false>' requested here
TORCH_API inline at::Tensor _empty_affine_quantized(at::IntArrayRef size, at::TensorOptions options={}, double scale=1, int64_t zero_point=0, c10::optional<at::MemoryFormat> memory_format=MemoryFormat::Contiguous) {
                                                                                                                                                                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/ops/fft_fft.h:26:154: note: in instantiation of member function 'c10::optional<c10::basic_string_view<char>>::optional' requested here
TORCH_API inline at::Tensor fft_fft(const at::Tensor & self, c10::optional<int64_t> n=c10::nullopt, int64_t dim=-1, c10::optional<c10::string_view> norm=c10::nullopt) {
                                                                                                                                                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/ops/from_file.h:26:135: note: in instantiation of function template specialization 'c10::optional<long>::optional<int, false>' requested here
TORCH_API inline at::Tensor from_file(c10::string_view filename, c10::optional<bool> shared=c10::nullopt, c10::optional<int64_t> size=0, at::TensorOptions options={}) {
                                                                                                                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/ScalarOps.h:33:50: note: in instantiation of function template specialization 'c10::optional<c10::ScalarType>::optional<const c10::ScalarType &, false>' requested here
      return at::detail::scalar_tensor_static(s, at::kDouble, at::kCPU);
                                                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/ScalarOps.h:33:63: note: in instantiation of function template specialization 'c10::optional<c10::Device>::optional<const c10::DeviceType &, false>' requested here
      return at::detail::scalar_tensor_static(s, at::kDouble, at::kCPU);
                                                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/TensorIterator.h:766:28: note: in instantiation of template class 'c10::optional<c10::SmallVector<long, 5>>' requested here
  c10::optional<DimVector> static_shape_ = c10::nullopt;
                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/TensorIterator.h:766:28: note: in instantiation of template class 'c10::optional<c10::SmallVector<long, 5>>' requested here
  c10::optional<DimVector> static_shape_ = c10::nullopt;
                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/TensorIterator.h:766:44: note: in instantiation of member function 'c10::optional<c10::SmallVector<long, 5>>::optional' requested here
  c10::optional<DimVector> static_shape_ = c10::nullopt;
                                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/ops/_cudnn_init_dropout_state_native.h:20:133: note: in instantiation of member function 'c10::optional<c10::ScalarType>::optional' requested here
TORCH_API at::Tensor _cudnn_init_dropout_state(double dropout, bool train, int64_t dropout_seed, c10::optional<at::ScalarType> dtype={}, c10::optional<at::Layout> layout={}, c10::optional<at::Device> device={}, c10::optional<bool> pin_memory={});
                                                                                                                                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/ops/_cudnn_init_dropout_state_native.h:20:170: note: in instantiation of member function 'c10::optional<c10::Layout>::optional' requested here
TORCH_API at::Tensor _cudnn_init_dropout_state(double dropout, bool train, int64_t dropout_seed, c10::optional<at::ScalarType> dtype={}, c10::optional<at::Layout> layout={}, c10::optional<at::Device> device={}, c10::optional<bool> pin_memory={});
                                                                                                                                                                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/ops/_cudnn_init_dropout_state_native.h:20:242: note: in instantiation of member function 'c10::optional<bool>::optional' requested here
TORCH_API at::Tensor _cudnn_init_dropout_state(double dropout, bool train, int64_t dropout_seed, c10::optional<at::ScalarType> dtype={}, c10::optional<at::Layout> layout={}, c10::optional<at::Device> device={}, c10::optional<bool> pin_memory={});
                                                                                                                                                                                                                                                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type_base.h:448:33: note: in instantiation of template class 'c10::optional<std::basic_string<char>>' requested here
      if (auto renamed = printer(*this)) {
                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type_base.h:448:33: note: in instantiation of template class 'c10::optional<std::basic_string<char>>' requested here
      if (auto renamed = printer(*this)) {
                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<std::basic_string<char>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type_base.h:448:16: note: in instantiation of member function 'c10::optional<std::basic_string<char>>::operator bool' requested here
      if (auto renamed = printer(*this)) {
               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<std::basic_string<char>>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type_base.h:449:16: note: in instantiation of member function 'c10::optional<std::basic_string<char>>::operator*' requested here
        return *renamed;
               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type_base.h:696:32: note: in instantiation of template class 'c10::optional<c10::QualifiedName>' requested here
  c10::optional<QualifiedName> name_;
                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type_base.h:696:32: note: in instantiation of template class 'c10::optional<c10::QualifiedName>' requested here
  c10::optional<QualifiedName> name_;
                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/dynamic_type.h:125:14: note: in instantiation of member function 'c10::optional<std::basic_string<char>>::optional' requested here
    explicit LabeledDynamicType(DynamicTypePtr t) : ty(std::move(t)) {}
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1338:63: note: in instantiation of template class 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>' requested here
  c10::optional<std::shared_ptr<torch::jit::CompilationUnit>> strong_ptr_;
                                                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1338:63: note: in instantiation of template class 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>' requested here
  c10::optional<std::shared_ptr<torch::jit::CompilationUnit>> strong_ptr_;
                                                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1339:61: note: in instantiation of template class 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>' requested here
  c10::optional<std::weak_ptr<torch::jit::CompilationUnit>> weak_ptr_;
                                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1339:61: note: in instantiation of template class 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>' requested here
  c10::optional<std::weak_ptr<torch::jit::CompilationUnit>> weak_ptr_;
                                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1312:12: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>::optional' requested here
  explicit WeakOrStrongCompilationUnit(
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1312:12: note: in instantiation of member function 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>::optional' requested here
  explicit WeakOrStrongCompilationUnit(
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:976:15: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>::operator bool' requested here
  return bool(x);
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1325:39: note: in instantiation of function template specialization 'c10::operator!=<std::shared_ptr<torch::jit::CompilationUnit>>' requested here
    TORCH_INTERNAL_ASSERT(strong_ptr_ != c10::nullopt);
                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1326:12: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>::operator*' requested here
    return *strong_ptr_;
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:976:15: note: in instantiation of member function 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>::operator bool' requested here
  return bool(x);
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1330:37: note: in instantiation of function template specialization 'c10::operator!=<std::weak_ptr<torch::jit::CompilationUnit>>' requested here
    TORCH_INTERNAL_ASSERT(weak_ptr_ != c10::nullopt);
                                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1331:12: note: in instantiation of member function 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>::operator*' requested here
    return *weak_ptr_;
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:288:25: note: in instantiation of template class 'c10::optional<unsigned long>' requested here
  c10::optional<size_t> stride_index_;
                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:288:25: note: in instantiation of template class 'c10::optional<unsigned long>' requested here
  c10::optional<size_t> stride_index_;
                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:272:3: note: in instantiation of member function 'c10::optional<unsigned long>::optional' requested here
  Stride() {}
  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<unsigned long>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:935:15: note: in instantiation of member function 'c10::optional<unsigned long>::operator bool' requested here
  return bool(x) != bool(y) ? false : bool(x) == false ? true : *x == *y;
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:280:26: note: in instantiation of function template specialization 'c10::operator==<unsigned long>' requested here
    return stride_index_ == b.stride_index_ && contiguous_ == b.contiguous_ &&
                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<unsigned long>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:935:65: note: in instantiation of member function 'c10::optional<unsigned long>::operator*' requested here
  return bool(x) != bool(y) ? false : bool(x) == false ? true : *x == *y;
                                                                ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:280:26: note: in instantiation of function template specialization 'c10::operator==<unsigned long>' requested here
    return stride_index_ == b.stride_index_ && contiguous_ == b.contiguous_ &&
                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:294:30: note: in instantiation of template class 'c10::optional<c10::Stride>' requested here
inline c10::optional<Stride> merge_primitive(
                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:294:30: note: in instantiation of template class 'c10::optional<c10::Stride>' requested here
inline c10::optional<Stride> merge_primitive(
                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<c10::Stride>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:299:13: note: in instantiation of member function 'c10::optional<c10::Stride>::has_value' requested here
  if (!left.has_value()) {
            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:314:12: note: in instantiation of member function 'c10::optional<c10::Stride>::optional' requested here
    return c10::optional<Stride>{};
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:317:10: note: in instantiation of function template specialization 'c10::optional<c10::Stride>::optional<c10::Stride, false>' requested here
  return r;
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:482:45: note: in instantiation of template class 'c10::optional<std::vector<c10::ShapeSymbol>>' requested here
    c10::optional<std::vector<ShapeSymbol>> dims_;
                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:482:45: note: in instantiation of template class 'c10::optional<std::vector<c10::ShapeSymbol>>' requested here
    c10::optional<std::vector<ShapeSymbol>> dims_;
                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:372:21: note: in instantiation of member function 'c10::optional<std::vector<c10::ShapeSymbol>>::optional' requested here
  SymbolicShape() : dims_(c10::nullopt) {}
                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<unsigned long>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:381:27: note: in instantiation of member function 'c10::optional<unsigned long>::operator*' requested here
    shape_symbols.reserve(*rank);
                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:389:3: note: in instantiation of member function 'c10::optional<std::vector<c10::ShapeSymbol>>::optional' requested here
  SymbolicShape(const std::vector<c10::optional<int64_t>>& dims) {
  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<long>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:393:11: note: in instantiation of member function 'c10::optional<long>::operator bool' requested here
      if(!dim) {
          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<long>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:396:61: note: in instantiation of member function 'c10::optional<long>::operator*' requested here
        shape_symbols.push_back(ShapeSymbol::fromStaticSize(*dim));
                                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:404:50: note: in instantiation of function template specialization 'c10::optional<std::vector<c10::ShapeSymbol>>::optional<std::vector<c10::ShapeSymbol>, false>' requested here
  SymbolicShape(std::vector<ShapeSymbol> dims) : dims_(std::move(dims)) {}
                                                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<std::vector<c10::ShapeSymbol>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:416:10: note: in instantiation of member function 'c10::optional<std::vector<c10::ShapeSymbol>>::operator bool' requested here
    if (!dims_) {
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<std::vector<c10::ShapeSymbol>>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:419:13: note: in instantiation of member function 'c10::optional<std::vector<c10::ShapeSymbol>>::operator*' requested here
    return (*dims_).at(i);
            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:432:14: note: in instantiation of member function 'c10::optional<unsigned long>::optional' requested here
      return c10::nullopt;
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:580:38: note: in instantiation of template type alias 'OptionalBase' requested here
    return detail_::static_addressof(OptionalBase<T>::storage_.value_);
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:731:60: note: in instantiation of member function 'c10::optional<std::vector<c10::ShapeSymbol>>::dataptr' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), dataptr());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:434:17: note: in instantiation of member function 'c10::optional<std::vector<c10::ShapeSymbol>>::operator->' requested here
    return dims_->size();
                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:434:12: note: in instantiation of function template specialization 'c10::optional<unsigned long>::optional<unsigned long, false>' requested here
    return dims_->size();
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:441:36: note: in instantiation of template class 'c10::optional<std::vector<bool>>' requested here
  c10::optional<std::vector<bool>> symbolicDims() const {
                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:441:36: note: in instantiation of template class 'c10::optional<std::vector<bool>>' requested here
  c10::optional<std::vector<bool>> symbolicDims() const {
                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:443:14: note: in instantiation of member function 'c10::optional<std::vector<bool>>::optional' requested here
      return c10::nullopt;
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:449:12: note: in instantiation of function template specialization 'c10::optional<std::vector<bool>>::optional<std::vector<bool>, false>' requested here
    return symbolic_dims;
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:513:44: note: in instantiation of function template specialization 'c10::optional<unsigned long>::optional<unsigned long &, false>' requested here
  VaryingShape(size_t size) : VaryingShape(c10::optional<size_t>(size)) {}
                                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:567:41: note: in instantiation of template class 'c10::optional<std::vector<c10::optional<c10::Stride>>>' requested here
  c10::optional<ListOfOptionalElements> dims_;
                                        ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:843:24: note: in instantiation of template class 'c10::VaryingShape<c10::Stride>' requested here
  VaryingShape<Stride> strides_;
                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:567:41: note: in instantiation of template class 'c10::optional<std::vector<c10::optional<c10::Stride>>>' requested here
  c10::optional<ListOfOptionalElements> dims_;
                                        ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:843:24: note: in instantiation of template class 'c10::VaryingShape<c10::Stride>' requested here
  VaryingShape<Stride> strides_;
                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:585:39: note: in instantiation of function template specialization 'c10::optional<bool>::optional<bool, false>' requested here
      c10::optional<bool> undefined = false,
                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:567:41: note: in instantiation of template class 'c10::optional<std::vector<c10::optional<long>>>' requested here
  c10::optional<ListOfOptionalElements> dims_;
                                        ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:613:12: note: in instantiation of template class 'c10::VaryingShape<long>' requested here
    return sizes().size();
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:567:41: note: in instantiation of template class 'c10::optional<std::vector<c10::optional<long>>>' requested here
  c10::optional<ListOfOptionalElements> dims_;
                                        ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:613:12: note: in instantiation of template class 'c10::VaryingShape<long>' requested here
    return sizes().size();
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:755:11: note: in instantiation of member function 'c10::optional<long>::contained_val' requested here
        ? contained_val()
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:658:24: note: in instantiation of member function 'c10::optional<long>::value' requested here
      prod *= shape[i].value();
                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:726:35: note: in instantiation of template class 'c10::optional<std::vector<long>>' requested here
    TORCH_INTERNAL_ASSERT(sizes().concrete_sizes().has_value());
                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:726:35: note: in instantiation of template class 'c10::optional<std::vector<long>>' requested here
    TORCH_INTERNAL_ASSERT(sizes().concrete_sizes().has_value());
                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<std::vector<long>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:726:52: note: in instantiation of member function 'c10::optional<std::vector<long>>::has_value' requested here
    TORCH_INTERNAL_ASSERT(sizes().concrete_sizes().has_value());
                                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:750:27: note: in instantiation of member function 'c10::optional<std::vector<long>>::contained_val' requested here
    return constexpr_move(contained_val());
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:728:9: note: in instantiation of member function 'c10::optional<std::vector<long>>::operator*' requested here
        *sizes().concrete_sizes(),
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:1121:9: note: in instantiation of member function 'c10::optional<c10::QualifiedName>::optional' requested here
        c10::nullopt,
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:754:12: note: in instantiation of member function 'c10::optional<c10::QualifiedName>::initialized' requested here
    return initialized()
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:1437:28: note: in instantiation of member function 'c10::optional<c10::QualifiedName>::value' requested here
    const auto& n = name().value();
                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:755:11: note: in instantiation of member function 'c10::optional<c10::QualifiedName>::contained_val' requested here
        ? contained_val()
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:1437:28: note: in instantiation of member function 'c10::optional<c10::QualifiedName>::value' requested here
    const auto& n = name().value();
                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:1985:41: note: in instantiation of function template specialization 'c10::optional<std::basic_string<char>>::optional<std::basic_string<char>, false>' requested here
  MatchTypeReturn(std::string reason) : reason_(std::move(reason)) {}
                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:755:11: note: in instantiation of member function 'c10::optional<std::basic_string<char>>::contained_val' requested here
        ? contained_val()
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:1993:20: note: in instantiation of member function 'c10::optional<std::basic_string<char>>::value' requested here
    return reason_.value();
                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:1998:5: note: in instantiation of member function 'c10::optional<std::basic_string<char>>::optional' requested here
  : reason_(c10::nullopt) {}
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:580:38: note: in instantiation of template type alias 'OptionalBase' requested here
    return detail_::static_addressof(OptionalBase<T>::storage_.value_);
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:731:60: note: in instantiation of member function 'c10::optional<c10::QualifiedName>::dataptr' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), dataptr());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:2041:50: note: in instantiation of member function 'c10::optional<c10::QualifiedName>::operator->' requested here
    return std::string("InterfaceType<") + name()->name() + ">";
                                                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:144:55: note: in instantiation of template class 'c10::optional<c10::Stream>' requested here
  explicit InlineOptionalStreamGuard(optional<Stream> stream_opt) : guard_() {
                                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:144:55: note: in instantiation of template class 'c10::optional<c10::Stream>' requested here
  explicit InlineOptionalStreamGuard(optional<Stream> stream_opt) : guard_() {
                                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<c10::Stream>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:145:20: note: in instantiation of member function 'c10::optional<c10::Stream>::has_value' requested here
    if (stream_opt.has_value()) {
                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:761:11: note: in instantiation of member function 'c10::optional<c10::Stream>::contained_val' requested here
        ? contained_val()
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:146:33: note: in instantiation of member function 'c10::optional<c10::Stream>::value' requested here
      guard_.emplace(stream_opt.value());
                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:197:34: note: in instantiation of template class 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>' requested here
  optional<InlineStreamGuard<T>> guard_;
                                 ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:139:64: note: in instantiation of template class 'c10::impl::InlineOptionalStreamGuard<c10::impl::VirtualGuardImpl>' requested here
  c10::impl::InlineOptionalStreamGuard<impl::VirtualGuardImpl> guard_;
                                                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:197:34: note: in instantiation of template class 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>' requested here
  optional<InlineStreamGuard<T>> guard_;
                                 ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:139:64: note: in instantiation of template class 'c10::impl::InlineOptionalStreamGuard<c10::impl::VirtualGuardImpl>' requested here
  c10::impl::InlineOptionalStreamGuard<impl::VirtualGuardImpl> guard_;
                                                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:232:15: note: in instantiation of template class 'c10::optional<c10::impl::VirtualGuardImpl>' requested here
  optional<T> impl_;
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:162:61: note: in instantiation of template class 'c10::impl::InlineMultiStreamGuard<c10::impl::VirtualGuardImpl>' requested here
  c10::impl::InlineMultiStreamGuard<impl::VirtualGuardImpl> guard_;
                                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:232:15: note: in instantiation of template class 'c10::optional<c10::impl::VirtualGuardImpl>' requested here
  optional<T> impl_;
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:162:61: note: in instantiation of template class 'c10::impl::InlineMultiStreamGuard<c10::impl::VirtualGuardImpl>' requested here
  c10::impl::InlineMultiStreamGuard<impl::VirtualGuardImpl> guard_;
                                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:834:47: note: in instantiation of template class 'c10::optional<std::vector<c10::weak_intrusive_ptr<c10::StorageImpl>>>' requested here
      c10::optional<std::vector<WeakStorage>> storages = c10::nullopt) {
                                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:834:47: note: in instantiation of template class 'c10::optional<std::vector<c10::weak_intrusive_ptr<c10::StorageImpl>>>' requested here
      c10::optional<std::vector<WeakStorage>> storages = c10::nullopt) {
                                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:834:58: note: in instantiation of member function 'c10::optional<std::vector<c10::weak_intrusive_ptr<c10::StorageImpl>>>::optional' requested here
      c10::optional<std::vector<WeakStorage>> storages = c10::nullopt) {
                                                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<std::vector<c10::weak_intrusive_ptr<c10::StorageImpl>>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:849:22: note: in instantiation of member function 'c10::optional<std::vector<c10::weak_intrusive_ptr<c10::StorageImpl>>>::has_value' requested here
            storages.has_value() ? std::move(*storages) : extractStorages(value);
                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<std::vector<c10::weak_intrusive_ptr<c10::StorageImpl>>>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:849:46: note: in instantiation of member function 'c10::optional<std::vector<c10::weak_intrusive_ptr<c10::StorageImpl>>>::operator*' requested here
            storages.has_value() ? std::move(*storages) : extractStorages(value);
                                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:1000:57: note: in instantiation of function template specialization 'c10::optional<std::vector<c10::weak_intrusive_ptr<c10::StorageImpl>>>::optional<std::vector<c10::weak_intrusive_ptr<c10::StorageImpl>>, false>' requested here
              childFut->markCompleted(std::move(value), std::move(storages));
                                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:1035:48: note: in instantiation of function template specialization 'c10::optional<std::vector<c10::weak_intrusive_ptr<c10::StorageImpl>>>::optional<const std::vector<c10::weak_intrusive_ptr<c10::StorageImpl>> &, false>' requested here
                      intermediateFut.value(), intermediateFut.storages());
                                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:1462:71: note: in instantiation of template class 'c10::optional<int>' requested here
  virtual IValue toIValue(const TypePtr& type, c10::optional<int32_t> N = c10::nullopt) = 0;
                                                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:1462:71: note: in instantiation of template class 'c10::optional<int>' requested here
  virtual IValue toIValue(const TypePtr& type, c10::optional<int32_t> N = c10::nullopt) = 0;
                                                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:1462:75: note: in instantiation of member function 'c10::optional<int>::optional' requested here
  virtual IValue toIValue(const TypePtr& type, c10::optional<int32_t> N = c10::nullopt) = 0;
                                                                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:2120:5: note: in instantiation of template class 'c10::optional<std::reference_wrapper<const std::basic_string<char>>>' requested here
    toOptionalStringRef() const {
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:2120:5: note: in instantiation of template class 'c10::optional<std::reference_wrapper<const std::basic_string<char>>>' requested here
    toOptionalStringRef() const {
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:2122:12: note: in instantiation of member function 'c10::optional<std::reference_wrapper<const std::basic_string<char>>>::optional' requested here
    return c10::nullopt;
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:2128:10: note: in instantiation of function template specialization 'c10::optional<std::reference_wrapper<const std::basic_string<char>>>::optional<std::reference_wrapper<const std::basic_string<char>>, false>' requested here
  return std::reference_wrapper<const std::string>(
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/TensorIndexing.h:212:26: note: in instantiation of function template specialization 'c10::optional<long>::optional<long &, false>' requested here
  return self.slice(dim, start, stop, step);
                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/TensorIndexing.h:241:27: note: in instantiation of member function 'c10::optional<c10::ArrayRef<at::Dimname>>::optional' requested here
    return at::empty({1}, {}, self.options().dtype(kLong)).fill_(0.);
                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/TensorIndexing.h:279:30: note: in instantiation of function template specialization 'c10::optional<at::Tensor>::optional<const at::Tensor, false>' requested here
    converted_inds.push_back(std::move(i));
                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/variable.h:525:27: note: in instantiation of template class 'c10::optional<torch::autograd::ViewInfo>' requested here
  c10::optional<ViewInfo> backward_info_;
                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/variable.h:525:27: note: in instantiation of template class 'c10::optional<torch::autograd::ViewInfo>' requested here
  c10::optional<ViewInfo> backward_info_;
                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<torch::autograd::ViewInfo>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/variable.h:560:27: note: in instantiation of member function 'c10::optional<torch::autograd::ViewInfo>::has_value' requested here
    return backward_info_.has_value();
                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:755:11: note: in instantiation of member function 'c10::optional<torch::autograd::ViewInfo>::contained_val' requested here
        ? contained_val()
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/variable.h:565:27: note: in instantiation of member function 'c10::optional<torch::autograd::ViewInfo>::value' requested here
    return backward_info_.value();
                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:1215:10: note: in instantiation of function template specialization 'c10::optional<c10::basic_string_view<char>>::optional<c10::basic_string_view<char>, false>' requested here
  return optional<typename std::decay<T>::type>(constexpr_forward<T>(v));
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/operator_name.h:31:19: note: in instantiation of function template specialization 'c10::make_optional<c10::basic_string_view<char>>' requested here
      return c10::make_optional(c10::string_view(name.data(), pos));
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<c10::basic_string_view<char>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/operator_name.h:37:25: note: in instantiation of member function 'c10::optional<c10::basic_string_view<char>>::has_value' requested here
    if (!getNamespace().has_value()) {
                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:179:25: note: in instantiation of template class 'c10::optional<c10::IValue>' requested here
  c10::optional<IValue> default_value_;
                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:179:25: note: in instantiation of template class 'c10::optional<c10::IValue>' requested here
  c10::optional<IValue> default_value_;
                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:30:45: note: in instantiation of member function 'c10::optional<c10::IValue>::optional' requested here
      c10::optional<IValue> default_value = c10::nullopt,
                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:32:32: note: in instantiation of template class 'c10::optional<c10::AliasInfo>' requested here
      c10::optional<AliasInfo> alias_info = c10::nullopt)
                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:32:32: note: in instantiation of template class 'c10::optional<c10::AliasInfo>' requested here
      c10::optional<AliasInfo> alias_info = c10::nullopt)
                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:32:45: note: in instantiation of member function 'c10::optional<c10::AliasInfo>::optional' requested here
      c10::optional<AliasInfo> alias_info = c10::nullopt)
                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:744:12: note: in instantiation of member function 'c10::optional<c10::AliasInfo>::initialized' requested here
    assert(initialized());
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:48:72: note: in instantiation of member function 'c10::optional<c10::AliasInfo>::operator*' requested here
        alias_info_(alias_info ? std::make_unique<AliasInfo>(std::move(*alias_info)) : nullptr),
                                                                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<c10::AliasInfo>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:48:72: note: in instantiation of member function 'c10::optional<c10::AliasInfo>::operator*' requested here
        alias_info_(alias_info ? std::make_unique<AliasInfo>(std::move(*alias_info)) : nullptr),
                                                                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:148:23: note: in instantiation of function template specialization 'c10::optional<c10::AliasInfo>::optional<c10::AliasInfo &, false>' requested here
        alias_info_ ? c10::optional<AliasInfo>(*alias_info_) : c10::nullopt);
                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<int>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:935:15: note: in instantiation of member function 'c10::optional<int>::operator bool' requested here
  return bool(x) != bool(y) ? false : bool(x) == false ? true : *x == *y;
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:193:22: note: in instantiation of function template specialization 'c10::operator==<int>' requested here
          && lhs.N() == rhs.N()
                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<int>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:935:65: note: in instantiation of member function 'c10::optional<int>::operator*' requested here
  return bool(x) != bool(y) ? false : bool(x) == false ? true : *x == *y;
                                                                ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:193:22: note: in instantiation of function template specialization 'c10::operator==<int>' requested here
          && lhs.N() == rhs.N()
                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<c10::IValue>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:935:15: note: in instantiation of member function 'c10::optional<c10::IValue>::operator bool' requested here
  return bool(x) != bool(y) ? false : bool(x) == false ? true : *x == *y;
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:194:34: note: in instantiation of function template specialization 'c10::operator==<c10::IValue>' requested here
          && lhs.default_value() == rhs.default_value()
                                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<c10::IValue>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:935:65: note: in instantiation of member function 'c10::optional<c10::IValue>::operator*' requested here
  return bool(x) != bool(y) ? false : bool(x) == false ? true : *x == *y;
                                                                ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:194:34: note: in instantiation of function template specialization 'c10::operator==<c10::IValue>' requested here
          && lhs.default_value() == rhs.default_value()
                                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:304:36: note: in instantiation of template class 'c10::optional<c10::AliasAnalysisKind>' requested here
  c10::optional<AliasAnalysisKind> alias_kind_;
                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:304:36: note: in instantiation of template class 'c10::optional<c10::AliasAnalysisKind>' requested here
  c10::optional<AliasAnalysisKind> alias_kind_;
                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:208:3: note: in instantiation of member function 'c10::optional<c10::AliasAnalysisKind>::optional' requested here
  FunctionSchema(
  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:366:16: note: in instantiation of function template specialization 'c10::optional<int>::optional<const unsigned long, false>' requested here
        return i;
               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<c10::AliasAnalysisKind>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:435:13: note: in instantiation of member function 'c10::optional<c10::AliasAnalysisKind>::operator bool' requested here
    return !alias_kind_;
            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<c10::AliasAnalysisKind>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:773:20: note: in instantiation of member function 'c10::optional<c10::AliasAnalysisKind>::operator*' requested here
    return *this ? **this : detail_::convert<T>(constexpr_forward<V>(v));
                   ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:438:24: note: in instantiation of function template specialization 'c10::optional<c10::AliasAnalysisKind>::value_or<c10::AliasAnalysisKind>' requested here
    return alias_kind_.value_or(AliasAnalysisKind::CONSERVATIVE);
                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:750:27: note: in instantiation of member function 'c10::optional<int>::contained_val' requested here
    return constexpr_move(contained_val());
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:489:52: note: in instantiation of member function 'c10::optional<int>::operator*' requested here
    out << list->getElementType()->str() << "[" << *arg.N() << "]";
                                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/op_registration/op_registration.h:428:34: note: in instantiation of template class 'c10::optional<c10::DispatchKey>' requested here
      c10::optional<DispatchKey> dispatch_key;
                                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/op_registration/op_registration.h:428:34: note: in instantiation of template class 'c10::optional<c10::DispatchKey>' requested here
      c10::optional<DispatchKey> dispatch_key;
                                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/op_registration/op_registration.h:430:41: note: in instantiation of template class 'c10::optional<c10::impl::CppSignature>' requested here
      c10::optional<impl::CppSignature> cpp_signature;
                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/op_registration/op_registration.h:430:41: note: in instantiation of template class 'c10::optional<c10::impl::CppSignature>' requested here
      c10::optional<impl::CppSignature> cpp_signature;
                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/op_registration/op_registration.h:434:62: note: in instantiation of template class 'c10::optional<c10::either<c10::OperatorName, c10::FunctionSchema>>' requested here
    c10::optional<c10::either<OperatorName, FunctionSchema>> schemaOrName_;
                                                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/op_registration/op_registration.h:434:62: note: in instantiation of template class 'c10::optional<c10::either<c10::OperatorName, c10::FunctionSchema>>' requested here
    c10::optional<c10::either<OperatorName, FunctionSchema>> schemaOrName_;
                                                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<c10::either<c10::OperatorName, c10::FunctionSchema>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/op_registration/op_registration.h:84:36: note: in instantiation of member function 'c10::optional<c10::either<c10::OperatorName, c10::FunctionSchema>>::has_value' requested here
        TORCH_CHECK(!schemaOrName_.has_value(), "You can only specify the schema once per operator registration.");
                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/op_registration/op_registration.h:413:7: note: in instantiation of member function 'c10::optional<c10::either<c10::OperatorName, c10::FunctionSchema>>::optional' requested here
    : schemaOrName_(c10::nullopt)
      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/op_registration/op_registration.h:415:7: note: in instantiation of member function 'c10::optional<c10::AliasAnalysisKind>::optional' requested here
    , aliasAnalysisKind_(c10::nullopt)
      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/op_registration/op_registration.h:422:11: note: in instantiation of member function 'c10::optional<c10::DispatchKey>::optional' requested here
        : dispatch_key(c10::nullopt)
          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/op_registration/op_registration.h:424:11: note: in instantiation of member function 'c10::optional<c10::impl::CppSignature>::optional' requested here
        , cpp_signature(c10::nullopt)
          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:580:38: note: in instantiation of template type alias 'OptionalBase' requested here
    return detail_::static_addressof(OptionalBase<T>::storage_.value_);
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:731:60: note: in instantiation of member function 'c10::optional<at::Tensor>::dataptr' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), dataptr());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/dispatch/DispatchKeyExtractor.h:61:20: note: in instantiation of member function 'c10::optional<at::Tensor>::operator->' requested here
        ts = ts | x->key_set();
                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:761:11: note: in instantiation of member function 'c10::optional<at::Tensor>::contained_val' requested here
        ? contained_val()
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/dispatch/DispatchKeyExtractor.h:73:23: note: in instantiation of member function 'c10::optional<at::Tensor>::value' requested here
          ts = ts | x.value().key_set();
                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/dispatch/OperatorEntry.h:212:34: note: in instantiation of template class 'c10::optional<c10::impl::AnnotatedSchema>' requested here
  c10::optional<AnnotatedSchema> schema_;
                                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/dispatch/OperatorEntry.h:212:34: note: in instantiation of template class 'c10::optional<c10::impl::AnnotatedSchema>' requested here
  c10::optional<AnnotatedSchema> schema_;
                                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/dispatch/OperatorEntry.h:271:40: note: in instantiation of template class 'c10::optional<c10::impl::OperatorEntry::CppSignatureWithDebug>' requested here
  c10::optional<CppSignatureWithDebug> cpp_signature_;
                                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/dispatch/OperatorEntry.h:271:40: note: in instantiation of template class 'c10::optional<c10::impl::OperatorEntry::CppSignatureWithDebug>' requested here
  c10::optional<CppSignatureWithDebug> cpp_signature_;
                                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<c10::impl::AnnotatedSchema>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/dispatch/OperatorEntry.h:78:35: note: in instantiation of member function 'c10::optional<c10::impl::AnnotatedSchema>::has_value' requested here
    TORCH_INTERNAL_ASSERT(schema_.has_value(), "Tried to access the schema for ", name_, " which doesn't have a schema registered yet");
                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:580:38: note: in instantiation of template type alias 'OptionalBase' requested here
    return detail_::static_addressof(OptionalBase<T>::storage_.value_);
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:731:60: note: in instantiation of member function 'c10::optional<c10::impl::AnnotatedSchema>::dataptr' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), dataptr());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/dispatch/OperatorEntry.h:79:19: note: in instantiation of member function 'c10::optional<c10::impl::AnnotatedSchema>::operator->' requested here
    return schema_->schema;
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<c10::impl::OperatorEntry::CppSignatureWithDebug>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/dispatch/OperatorEntry.h:169:37: note: in instantiation of member function 'c10::optional<c10::impl::OperatorEntry::CppSignatureWithDebug>::has_value' requested here
    if (C10_UNLIKELY(cpp_signature_.has_value() && (call_signature != cpp_signature_->signature))) {
                                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:30:3: note: in instantiation of template class 'c10::optional<std::chrono::duration<long, std::ratio<1, 1000>>>' requested here
  TORCH_ARG(optional<std::chrono::milliseconds>, timeout);
  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/arg.h:22:5: note: expanded from macro 'TORCH_ARG'
  T name##_ /* NOLINT */
    ^
<scratch space>:224:1: note: expanded from here
timeout_
^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:30:3: note: in instantiation of template class 'c10::optional<std::chrono::duration<long, std::ratio<1, 1000>>>' requested here
  TORCH_ARG(optional<std::chrono::milliseconds>, timeout);
  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/arg.h:22:5: note: expanded from macro 'TORCH_ARG'
  T name##_ /* NOLINT */
    ^
<scratch space>:224:1: note: expanded from here
timeout_
^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:15:18: note: in instantiation of member function 'c10::optional<std::chrono::duration<long, std::ratio<1, 1000>>>::optional' requested here
  /* implicit */ DataLoaderOptions(size_t batch_size)
                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/detail/queue.h:43:55: note: in instantiation of member function 'c10::optional<std::chrono::duration<long, std::ratio<1, 1000>>>::optional' requested here
  T pop(optional<std::chrono::milliseconds> timeout = nullopt) {
                                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<std::chrono::duration<long, std::ratio<1, 1000>>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/detail/queue.h:45:9: note: in instantiation of member function 'c10::optional<std::chrono::duration<long, std::ratio<1, 1000>>>::operator bool' requested here
    if (timeout) {
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<std::chrono::duration<long, std::ratio<1, 1000>>>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/detail/queue.h:47:21: note: in instantiation of member function 'c10::optional<std::chrono::duration<long, std::ratio<1, 1000>>>::operator*' requested here
              lock, *timeout, [this] { return !this->queue_.empty(); })) {
                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/frontend/source_range.h:357:58: note: in instantiation of template class 'c10::optional<std::tuple<std::basic_string<char>, unsigned long, unsigned long>>' requested here
  c10::optional<std::tuple<std::string, size_t, size_t>> file_line_col() const {
                                                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/frontend/source_range.h:357:58: note: in instantiation of template class 'c10::optional<std::tuple<std::basic_string<char>, unsigned long, unsigned long>>' requested here
  c10::optional<std::tuple<std::string, size_t, size_t>> file_line_col() const {
                                                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/frontend/source_range.h:359:14: note: in instantiation of member function 'c10::optional<std::tuple<std::basic_string<char>, unsigned long, unsigned long>>::optional' requested here
      return c10::nullopt;
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/frontend/source_range.h:365:12: note: in instantiation of function template specialization 'c10::optional<std::tuple<std::basic_string<char>, unsigned long, unsigned long>>::optional<std::tuple<std::basic_string<char>, unsigned long, unsigned long>, false>' requested here
    return std::make_tuple<std::string, size_t, size_t>(
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/frontend/source_range.h:380:30: note: in instantiation of template class 'c10::optional<torch::jit::SourceRange>' requested here
  c10::optional<SourceRange> findSourceRangeThatGenerated() const {
                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/frontend/source_range.h:380:30: note: in instantiation of template class 'c10::optional<torch::jit::SourceRange>' requested here
  c10::optional<SourceRange> findSourceRangeThatGenerated() const {
                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/frontend/source_range.h:382:14: note: in instantiation of member function 'c10::optional<torch::jit::SourceRange>::optional' requested here
      return c10::nullopt;
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/scope.h:127:38: note: in instantiation of template class 'c10::optional<c10::intrusive_ptr<torch::jit::InlinedCallStack>>' requested here
  c10::optional<InlinedCallStackPtr> callee_;
                                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/scope.h:127:38: note: in instantiation of template class 'c10::optional<c10::intrusive_ptr<torch::jit::InlinedCallStack>>' requested here
  c10::optional<InlinedCallStackPtr> callee_;
                                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/scope.h:140:37: note: in instantiation of template class 'c10::optional<torch::jit::ModuleInstanceInfo>' requested here
  c10::optional<ModuleInstanceInfo> module_instance_info_;
                                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/scope.h:140:37: note: in instantiation of template class 'c10::optional<torch::jit::ModuleInstanceInfo>' requested here
  c10::optional<ModuleInstanceInfo> module_instance_info_;
                                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<torch::jit::ModuleInstanceInfo>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/scope.h:187:31: note: in instantiation of member function 'c10::optional<torch::jit::ModuleInstanceInfo>::has_value' requested here
    return (module_instance().has_value() ==
                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:768:22: note: in instantiation of member function 'c10::optional<torch::jit::ModuleInstanceInfo>::contained_val' requested here
    return std::move(contained_val());
                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/scope.h:190:28: note: in instantiation of member function 'c10::optional<torch::jit::ModuleInstanceInfo>::value' requested here
         module_instance().value() == rhs.module_instance().value()) &&
                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<c10::intrusive_ptr<torch::jit::InlinedCallStack>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:935:15: note: in instantiation of member function 'c10::optional<c10::intrusive_ptr<torch::jit::InlinedCallStack>>::operator bool' requested here
  return bool(x) != bool(y) ? false : bool(x) == false ? true : *x == *y;
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/scope.h:191:18: note: in instantiation of function template specialization 'c10::operator==<c10::intrusive_ptr<torch::jit::InlinedCallStack>>' requested here
        callee() == rhs.callee() && source_range() == rhs.source_range();
                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<c10::intrusive_ptr<torch::jit::InlinedCallStack>>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:935:65: note: in instantiation of member function 'c10::optional<c10::intrusive_ptr<torch::jit::InlinedCallStack>>::operator*' requested here
  return bool(x) != bool(y) ? false : bool(x) == false ? true : *x == *y;
                                                                ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/scope.h:191:18: note: in instantiation of function template specialization 'c10::operator==<c10::intrusive_ptr<torch::jit::InlinedCallStack>>' requested here
        callee() == rhs.callee() && source_range() == rhs.source_range();
                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/constants.h:29:29: note: in instantiation of template class 'c10::optional<c10::intrusive_ptr<torch::jit::Scope>>' requested here
    c10::optional<ScopePtr> scope = c10::nullopt);
                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/constants.h:29:29: note: in instantiation of template class 'c10::optional<c10::intrusive_ptr<torch::jit::Scope>>' requested here
    c10::optional<ScopePtr> scope = c10::nullopt);
                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/constants.h:29:37: note: in instantiation of member function 'c10::optional<c10::intrusive_ptr<torch::jit::Scope>>::optional' requested here
    c10::optional<ScopePtr> scope = c10::nullopt);
                                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/named_value.h:18:9: note: in instantiation of function template specialization 'c10::optional<torch::jit::SourceRange>::optional<const torch::jit::SourceRange &, false>' requested here
      : loc_(loc), name_(name), value_(value) {}
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/named_value.h:18:20: note: in instantiation of function template specialization 'c10::optional<std::basic_string<char>>::optional<const std::basic_string<char> &, false>' requested here
      : loc_(loc), name_(name), value_(value) {}
                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/named_value.h:21:18: note: in instantiation of member function 'c10::optional<torch::jit::SourceRange>::optional' requested here
  /* implicit */ NamedValue(Value* value) : value_(value) {}
                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<torch::jit::SourceRange>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/named_value.h:49:10: note: in instantiation of member function 'c10::optional<torch::jit::SourceRange>::operator bool' requested here
    if (!loc_)
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<torch::jit::SourceRange>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/named_value.h:70:12: note: in instantiation of member function 'c10::optional<torch::jit::SourceRange>::operator*' requested here
    return *loc_;
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/runtime/operator.h:86:59: note: in instantiation of function template specialization 'c10::optional<c10::AliasAnalysisKind>::optional<c10::AliasAnalysisKind &, false>' requested here
                UnparsedFunctionSchema{std::move(schema), alias_analysis}),
                                                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<c10::AliasAnalysisKind>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/runtime/operator.h:154:39: note: in instantiation of member function 'c10::optional<c10::AliasAnalysisKind>::operator*' requested here
              schema.setAliasAnalysis(*unmaterializedSchema.alias_analysis_);
                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/runtime/operator.h:256:25: note: in instantiation of template class 'c10::optional<torch::jit::Operator>' requested here
c10::optional<Operator> OperatorGenerator(
                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/runtime/operator.h:256:25: note: in instantiation of template class 'c10::optional<torch::jit::Operator>' requested here
c10::optional<Operator> OperatorGenerator(
                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/runtime/operator.h:280:10: note: in instantiation of member function 'c10::optional<torch::jit::Operator>::optional' requested here
  return c10::nullopt;
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/enum_type.h:83:39: note: in instantiation of function template specialization 'c10::optional<c10::QualifiedName>::optional<c10::QualifiedName, false>' requested here
      : NamedType(TypeKind::EnumType, std::move(qualified_class_name)),
                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<c10::intrusive_ptr<torch::jit::InlinedCallStack>>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/ir.h:430:26: note: in instantiation of member function 'c10::optional<c10::intrusive_ptr<torch::jit::InlinedCallStack>>::operator*' requested here
      this->setCallStack(*cs);
                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/runtime/argument_spec.h:51:27: note: in instantiation of function template specialization 'c10::optional<unsigned long>::optional<int, false>' requested here
        type(), device(), c10::optional<size_t>(dim()), requires_grad());
                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/runtime/argument_spec.h:465:19: note: in instantiation of function template specialization 'c10::optional<signed char>::optional<signed char, false>' requested here
  return (from) ? c10::optional<int8_t>(static_cast<int8_t>(*from))
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/runtime/argument_spec.h:466:19: note: in instantiation of member function 'c10::optional<signed char>::optional' requested here
                : c10::optional<int8_t>{};
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/runtime/interpreter.h:150:39: note: in instantiation of template class 'c10::optional<at::ThreadLocalState>' requested here
  c10::optional<at::ThreadLocalState> tls_state_ = c10::nullopt;
                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/runtime/interpreter.h:150:39: note: in instantiation of template class 'c10::optional<at::ThreadLocalState>' requested here
  c10::optional<at::ThreadLocalState> tls_state_ = c10::nullopt;
                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/runtime/interpreter.h:136:55: note: in instantiation of member function 'c10::optional<at::ThreadLocalState>::optional' requested here
      c10::optional<at::ThreadLocalState> tls_state = c10::nullopt)
                                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:156:48: note: in instantiation of template class 'c10::optional<torch::jit::ExecutorExecutionMode>' requested here
  mutable c10::optional<ExecutorExecutionMode> executor_execution_mode_;
                                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:156:48: note: in instantiation of template class 'c10::optional<torch::jit::ExecutorExecutionMode>' requested here
  mutable c10::optional<ExecutorExecutionMode> executor_execution_mode_;
                                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/array:110:56: note: in instantiation of template class 'c10::optional<std::shared_ptr<torch::jit::Graph>>' requested here
      typename _AT_Type::_Type                         _M_elems;
                                                       ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:165:7: note: in instantiation of template class 'std::array<c10::optional<std::shared_ptr<torch::jit::Graph>>, 4>' requested here
      optimized_graphs_;
      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/array:110:56: note: in instantiation of template class 'c10::optional<std::shared_ptr<torch::jit::Graph>>' requested here
      typename _AT_Type::_Type                         _M_elems;
                                                       ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:165:7: note: in instantiation of template class 'std::array<c10::optional<std::shared_ptr<torch::jit::Graph>>, 4>' requested here
      optimized_graphs_;
      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/array:110:56: note: in instantiation of template class 'c10::optional<torch::jit::GraphExecutor>' requested here
      typename _AT_Type::_Type                         _M_elems;
                                                       ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:179:7: note: in instantiation of template class 'std::array<c10::optional<torch::jit::GraphExecutor>, 4>' requested here
      executors_;
      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/array:110:56: note: in instantiation of template class 'c10::optional<torch::jit::GraphExecutor>' requested here
      typename _AT_Type::_Type                         _M_elems;
                                                       ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:179:7: note: in instantiation of template class 'std::array<c10::optional<torch::jit::GraphExecutor>, 4>' requested here
      executors_;
      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:18:11: note: in instantiation of member function 'c10::optional<torch::jit::ExecutorExecutionMode>::optional' requested here
          c10::nullopt)
          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:13:3: note: in instantiation of member function 'c10::optional<torch::jit::ExecutorExecutionMode>::optional' requested here
  GraphFunction(
  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/array:94:12: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::Graph>>::optional' requested here
    struct array
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:13:3: note: in implicit default constructor for 'std::array<c10::optional<std::shared_ptr<torch::jit::Graph>>, 4>' first required here
  GraphFunction(
  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/array:94:12: note: in instantiation of member function 'c10::optional<torch::jit::GraphExecutor>::optional' requested here
    struct array
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:13:3: note: in implicit default constructor for 'std::array<c10::optional<torch::jit::GraphExecutor>, 4>' first required here
  GraphFunction(
  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::Graph>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:46:9: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::Graph>>::operator bool' requested here
    if (optimized_graph) {
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::Graph>>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:47:14: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::Graph>>::operator*' requested here
      return *optimized_graph;
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<torch::jit::GraphExecutor>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:108:9: note: in instantiation of member function 'c10::optional<torch::jit::GraphExecutor>::operator bool' requested here
    if (executor) {
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<torch::jit::GraphExecutor>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:109:14: note: in instantiation of member function 'c10::optional<torch::jit::GraphExecutor>::operator*' requested here
      return *executor;
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<torch::jit::ExecutorExecutionMode>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:114:10: note: in instantiation of member function 'c10::optional<torch::jit::ExecutorExecutionMode>::operator bool' requested here
    if (!executor_execution_mode_) {
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<torch::jit::ExecutorExecutionMode>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:117:49: note: in instantiation of member function 'c10::optional<torch::jit::ExecutorExecutionMode>::operator*' requested here
      executor = GraphExecutor(opt_graph, name, *executor_execution_mode_);
                                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:132:28: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::Graph>>::optional' requested here
    optimized_graphs_.fill(c10::nullopt);
                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/object.h:46:27: note: in instantiation of template class 'c10::optional<torch::jit::Method>' requested here
    c10::optional<Method> setter_func;
                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/object.h:46:27: note: in instantiation of template class 'c10::optional<torch::jit::Method>' requested here
    c10::optional<Method> setter_func;
                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<torch::jit::Method>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/object.h:105:14: note: in instantiation of member function 'c10::optional<torch::jit::Method>::operator bool' requested here
    if (auto method = find_method(name)) {
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<torch::jit::Method>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/object.h:106:14: note: in instantiation of member function 'c10::optional<torch::jit::Method>::operator*' requested here
      return *method;
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/object.h:129:40: note: in instantiation of member function 'c10::optional<torch::jit::Method>::optional' requested here
        c10::optional<Method> setter = c10::nullopt;
                                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/module.h:304:45: note: in instantiation of template class 'c10::optional<std::vector<std::basic_string<char>>>' requested here
    c10::optional<std::vector<std::string>> preserved_attrs = c10::nullopt,
                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/module.h:304:45: note: in instantiation of template class 'c10::optional<std::vector<std::basic_string<char>>>' requested here
    c10::optional<std::vector<std::string>> preserved_attrs = c10::nullopt,
                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/module.h:304:63: note: in instantiation of member function 'c10::optional<std::vector<std::basic_string<char>>>::optional' requested here
    c10::optional<std::vector<std::string>> preserved_attrs = c10::nullopt,
                                                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/datasets/tensor.h:30:12: note: in instantiation of function template specialization 'c10::optional<unsigned long>::optional<long, false>' requested here
    return tensor.size(0);
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_legacy.h:340:90: note: in instantiation of template class 'c10::optional<torch::autograd::profiler::ProfilerDisableOptions>' requested here
TORCH_API thread_event_lists disableProfilerLegacy(c10::optional<ProfilerDisableOptions> profilerDisableOptions = c10::nullopt);
                                                                                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_legacy.h:340:90: note: in instantiation of template class 'c10::optional<torch::autograd::profiler::ProfilerDisableOptions>' requested here
TORCH_API thread_event_lists disableProfilerLegacy(c10::optional<ProfilerDisableOptions> profilerDisableOptions = c10::nullopt);
                                                                                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_legacy.h:340:115: note: in instantiation of member function 'c10::optional<torch::autograd::profiler::ProfilerDisableOptions>::optional' requested here
TORCH_API thread_event_lists disableProfilerLegacy(c10::optional<ProfilerDisableOptions> profilerDisableOptions = c10::nullopt);
                                                                                                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_legacy.h:400:65: note: in instantiation of template class 'c10::optional<std::function<void (const std::vector<std::vector<torch::autograd::profiler::LegacyEvent>> &)>>' requested here
  c10::optional<std::function<void(const thread_event_lists&)>> cb_;
                                                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_legacy.h:400:65: note: in instantiation of template class 'c10::optional<std::function<void (const std::vector<std::vector<torch::autograd::profiler::LegacyEvent>> &)>>' requested here
  c10::optional<std::function<void(const thread_event_lists&)>> cb_;
                                                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_legacy.h:379:28: note: in instantiation of member function 'c10::optional<std::function<void (const std::vector<std::vector<torch::autograd::profiler::LegacyEvent>> &)>>::optional' requested here
          resultCallback = c10::nullopt,
                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<std::function<void (const std::vector<std::vector<torch::autograd::profiler::LegacyEvent>> &)>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_legacy.h:390:9: note: in instantiation of member function 'c10::optional<std::function<void (const std::vector<std::vector<torch::autograd::profiler::LegacyEvent>> &)>>::operator bool' requested here
    if (cb_) {
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<std::function<void (const std::vector<std::vector<torch::autograd::profiler::LegacyEvent>> &)>>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_legacy.h:392:10: note: in instantiation of member function 'c10::optional<std::function<void (const std::vector<std::vector<torch::autograd::profiler::LegacyEvent>> &)>>::operator*' requested here
        (*cb_)(event_lists);
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_kineto.h:247:52: note: in instantiation of template class 'c10::optional<std::vector<std::vector<long>>>' requested here
  c10::optional<std::vector<std::vector<int64_t>>> shapes_;
                                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_kineto.h:247:52: note: in instantiation of template class 'c10::optional<std::vector<std::vector<long>>>' requested here
  c10::optional<std::vector<std::vector<int64_t>>> shapes_;
                                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<std::vector<std::vector<long>>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:976:15: note: in instantiation of member function 'c10::optional<std::vector<std::vector<long>>>::operator bool' requested here
  return bool(x);
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_kineto.h:52:20: note: in instantiation of function template specialization 'c10::operator!=<std::vector<std::vector<long>>>' requested here
    return shapes_ != c10::nullopt;
                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<std::vector<std::vector<long>>>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_kineto.h:56:12: note: in instantiation of member function 'c10::optional<std::vector<std::vector<long>>>::operator*' requested here
    return *shapes_;
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<std::vector<std::basic_string<char>>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:976:15: note: in instantiation of member function 'c10::optional<std::vector<std::basic_string<char>>>::operator bool' requested here
  return bool(x);
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_kineto.h:65:20: note: in instantiation of function template specialization 'c10::operator!=<std::vector<std::basic_string<char>>>' requested here
    return dtypes_ != c10::nullopt;
                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<std::vector<std::basic_string<char>>>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_kineto.h:69:12: note: in instantiation of member function 'c10::optional<std::vector<std::basic_string<char>>>::operator*' requested here
    return *dtypes_;
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/batchnorm.h:24:48: note: in instantiation of function template specialization 'c10::optional<double>::optional<double, false>' requested here
  TORCH_ARG(c10::optional<double>, momentum) = 0.1;
                                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:760:12: note: in instantiation of member function 'c10::optional<double>::initialized' requested here
    return initialized()
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/batchnorm.h:38:14: note: in instantiation of member function 'c10::optional<double>::value' requested here
    momentum.value(),
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:761:11: note: in instantiation of member function 'c10::optional<double>::contained_val' requested here
        ? contained_val()
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/batchnorm.h:38:14: note: in instantiation of member function 'c10::optional<double>::value' requested here
    momentum.value(),
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/batchnorm.h:33:5: note: in instantiation of function template specialization 'c10::optional<at::Tensor>::optional<at::Tensor &, false>' requested here
    weight,
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:649:49: note: in instantiation of function template specialization 'c10::optional<long>::optional<int &, false>' requested here
      auto _w = in_proj_weight.slice(/*dim=*/0, _start, _end);
                                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:727:84: note: in instantiation of function template specialization 'c10::optional<long>::optional<const long &, false>' requested here
      q = F::linear(query, q_proj_weight_non_opt, in_proj_bias.slice(/*dim=*/0, 0, embed_dim));
                                                                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:728:90: note: in instantiation of function template specialization 'c10::optional<long>::optional<long, false>' requested here
      k = F::linear(key, k_proj_weight_non_opt, in_proj_bias.slice(/*dim=*/0, embed_dim, (embed_dim * 2)));
                                                                                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/loss.h:404:3: note: in instantiation of template class 'c10::optional<std::function<at::Tensor (const at::Tensor &, const at::Tensor &)>>' requested here
  TORCH_ARG(c10::optional<distance_function_t>, distance_function) = c10::nullopt;
  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/arg.h:22:5: note: expanded from macro 'TORCH_ARG'
  T name##_ /* NOLINT */
    ^
<scratch space>:250:1: note: expanded from here
distance_function_
^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/loss.h:404:3: note: in instantiation of template class 'c10::optional<std::function<at::Tensor (const at::Tensor &, const at::Tensor &)>>' requested here
  TORCH_ARG(c10::optional<distance_function_t>, distance_function) = c10::nullopt;
  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/arg.h:22:5: note: expanded from macro 'TORCH_ARG'
  T name##_ /* NOLINT */
    ^
<scratch space>:250:1: note: expanded from here
distance_function_
^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/loss.h:404:70: note: in instantiation of member function 'c10::optional<std::function<at::Tensor (const at::Tensor &, const at::Tensor &)>>::optional' requested here
  TORCH_ARG(c10::optional<distance_function_t>, distance_function) = c10::nullopt;
                                                                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<std::function<at::Tensor (const at::Tensor &, const at::Tensor &)>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:583:25: note: in instantiation of member function 'c10::optional<std::function<at::Tensor (const at::Tensor &, const at::Tensor &)>>::has_value' requested here
  if (distance_function.has_value()) {
                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:761:11: note: in instantiation of member function 'c10::optional<std::function<at::Tensor (const at::Tensor &, const at::Tensor &)>>::contained_val' requested here
        ? contained_val()
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:584:53: note: in instantiation of member function 'c10::optional<std::function<at::Tensor (const at::Tensor &, const at::Tensor &)>>::value' requested here
    auto distance_function_impl = distance_function.value();
                                                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/normalization.h:133:43: note: in instantiation of member function 'c10::optional<at::Tensor>::optional' requested here
  TORCH_ARG(c10::optional<Tensor>, out) = c10::nullopt;
                                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/padding.h:29:25: note: in instantiation of member function 'c10::optional<double>::optional' requested here
  c10::optional<double> fill_value;
                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/pooling.h:393:65: note: in instantiation of member function 'c10::optional<std::vector<long>>::optional' requested here
  TORCH_ARG(c10::optional<std::vector<int64_t>>, output_size) = c10::nullopt;
                                                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:580:38: note: in instantiation of template type alias 'OptionalBase' requested here
    return detail_::static_addressof(OptionalBase<T>::storage_.value_);
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:731:60: note: in instantiation of member function 'c10::optional<std::vector<long>>::dataptr' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), dataptr());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:611:20: note: in instantiation of member function 'c10::optional<std::vector<long>>::operator->' requested here
    if (output_size->size() == kernel_size.size() + 2) {
                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<std::vector<long>>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:612:34: note: in instantiation of member function 'c10::optional<std::vector<long>>::operator*' requested here
      output_size_ = IntArrayRef(*output_size).slice(2).vec();
                                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:764:19: note: in instantiation of template class 'c10::optional<torch::ExpandingArray<2>>' requested here
  if (output_size == c10::nullopt && output_ratio == c10::nullopt) {
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:764:19: note: in instantiation of template class 'c10::optional<torch::ExpandingArray<2>>' requested here
  if (output_size == c10::nullopt && output_ratio == c10::nullopt) {
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<2>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:966:12: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<2>>::operator bool' requested here
  return (!x);
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:764:19: note: in instantiation of function template specialization 'c10::operator==<torch::ExpandingArray<2>>' requested here
  if (output_size == c10::nullopt && output_ratio == c10::nullopt) {
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:764:51: note: in instantiation of template class 'c10::optional<torch::ExpandingArray<2, double>>' requested here
  if (output_size == c10::nullopt && output_ratio == c10::nullopt) {
                                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:764:51: note: in instantiation of template class 'c10::optional<torch::ExpandingArray<2, double>>' requested here
  if (output_size == c10::nullopt && output_ratio == c10::nullopt) {
                                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<2, double>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:966:12: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<2, double>>::operator bool' requested here
  return (!x);
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:764:51: note: in instantiation of function template specialization 'c10::operator==<torch::ExpandingArray<2, double>>' requested here
  if (output_size == c10::nullopt && output_ratio == c10::nullopt) {
                                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:755:11: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<2, double>>::contained_val' requested here
        ? contained_val()
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:773:84: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<2, double>>::value' requested here
    output_size_ = {(int64_t)(static_cast<double>(input.size(-2)) * (*output_ratio.value())[0]),
                                                                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<2>>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:782:59: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<2>>::operator*' requested here
  return torch::fractional_max_pool2d(input, kernel_size, *output_size_, _random_samples_);
                                                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:842:19: note: in instantiation of template class 'c10::optional<torch::ExpandingArray<3>>' requested here
  if (output_size == c10::nullopt && output_ratio == c10::nullopt) {
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:842:19: note: in instantiation of template class 'c10::optional<torch::ExpandingArray<3>>' requested here
  if (output_size == c10::nullopt && output_ratio == c10::nullopt) {
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<3>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:966:12: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<3>>::operator bool' requested here
  return (!x);
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:842:19: note: in instantiation of function template specialization 'c10::operator==<torch::ExpandingArray<3>>' requested here
  if (output_size == c10::nullopt && output_ratio == c10::nullopt) {
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:842:51: note: in instantiation of template class 'c10::optional<torch::ExpandingArray<3, double>>' requested here
  if (output_size == c10::nullopt && output_ratio == c10::nullopt) {
                                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:842:51: note: in instantiation of template class 'c10::optional<torch::ExpandingArray<3, double>>' requested here
  if (output_size == c10::nullopt && output_ratio == c10::nullopt) {
                                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<3, double>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:966:12: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<3, double>>::operator bool' requested here
  return (!x);
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:842:51: note: in instantiation of function template specialization 'c10::operator==<torch::ExpandingArray<3, double>>' requested here
  if (output_size == c10::nullopt && output_ratio == c10::nullopt) {
                                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:755:11: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<3, double>>::contained_val' requested here
        ? contained_val()
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:852:84: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<3, double>>::value' requested here
    output_size_ = {(int64_t)(static_cast<double>(input.size(-3)) * (*output_ratio.value())[0]),
                                                                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<3>>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:862:59: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<3>>::operator*' requested here
  return torch::fractional_max_pool3d(input, kernel_size, *output_size_, _random_samples_);
                                                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:21:31: note: in instantiation of function template specialization 'c10::optional<c10::Scalar>::optional<double &, false>' requested here
      auto denom = input.norm(p, dim, true).clamp_min(eps).expand_as(input);
                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/upsampling.h:26:3: note: in instantiation of template class 'c10::optional<std::vector<double>>' requested here
  TORCH_ARG(c10::optional<std::vector<double>>, scale_factor) = c10::nullopt;
  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/arg.h:22:5: note: expanded from macro 'TORCH_ARG'
  T name##_ /* NOLINT */
    ^
<scratch space>:85:1: note: expanded from here
scale_factor_
^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/upsampling.h:26:3: note: in instantiation of template class 'c10::optional<std::vector<double>>' requested here
  TORCH_ARG(c10::optional<std::vector<double>>, scale_factor) = c10::nullopt;
  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/arg.h:22:5: note: expanded from macro 'TORCH_ARG'
  T name##_ /* NOLINT */
    ^
<scratch space>:85:1: note: expanded from here
scale_factor_
^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/upsampling.h:26:65: note: in instantiation of member function 'c10::optional<std::vector<double>>::optional' requested here
  TORCH_ARG(c10::optional<std::vector<double>>, scale_factor) = c10::nullopt;
                                                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:21:39: note: in instantiation of member function 'c10::optional<std::vector<long>>::optional' requested here
  c10::optional<std::vector<int64_t>> size;
                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:22:38: note: in instantiation of member function 'c10::optional<std::vector<double>>::optional' requested here
  c10::optional<std::vector<double>> scale_factor;
                                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<std::vector<double>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:966:12: note: in instantiation of member function 'c10::optional<std::vector<double>>::operator bool' requested here
  return (!x);
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:25:44: note: in instantiation of function template specialization 'c10::operator==<std::vector<double>>' requested here
  if (size == c10::nullopt && scale_factor == c10::nullopt) {
                                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:761:11: note: in instantiation of member function 'c10::optional<std::vector<double>>::contained_val' requested here
        ? contained_val()
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:32:43: note: in instantiation of member function 'c10::optional<std::vector<double>>::value' requested here
    if (static_cast<int64_t>(scale_factor.value().size()) != dim) {
                                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<std::vector<double>>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:104:35: note: in instantiation of member function 'c10::optional<std::vector<double>>::operator*' requested here
    auto _scale_factor_repeated = *scale_factor;
                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:344:70: note: in instantiation of member function 'c10::optional<c10::ArrayRef<long>>::optional' requested here
                 const c10::optional<at::IntArrayRef>& output_size = c10::nullopt);
                                                                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:155:70: note: in instantiation of template class 'c10::optional<std::tuple<at::Tensor, at::Tensor>>' requested here
    const Tensor& input, torch::optional<std::tuple<Tensor, Tensor>> hx_opt = {});
                                                                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:155:70: note: in instantiation of template class 'c10::optional<std::tuple<at::Tensor, at::Tensor>>' requested here
    const Tensor& input, torch::optional<std::tuple<Tensor, Tensor>> hx_opt = {});
                                                                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:155:77: note: in instantiation of member function 'c10::optional<std::tuple<at::Tensor, at::Tensor>>::optional' requested here
    const Tensor& input, torch::optional<std::tuple<Tensor, Tensor>> hx_opt = {});
                                                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/function.h:230:59: note: in instantiation of function template specialization 'c10::optional<c10::Stream>::optional<c10::Stream, false>' requested here
      if (metadata.device().type() == device_type) return metadata.stream();
                                                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/function.h:233:12: note: in instantiation of member function 'c10::optional<c10::Stream>::optional' requested here
    return c10::nullopt;
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h:72:76: note: in instantiation of function template specialization 'c10::optional<c10::Scalar>::optional<double, false>' requested here
  auto clip_coef_clamped = torch::clamp(clip_coef, c10::nullopt /* min */, 1.0 /* max */);
                                                                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/optim/lbfgs.h:46:3: note: in instantiation of template class 'c10::optional<std::vector<at::Tensor>>' requested here
  TORCH_ARG(c10::optional<std::vector<Tensor>>, al) = c10::nullopt;
  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/arg.h:22:5: note: expanded from macro 'TORCH_ARG'
  T name##_ /* NOLINT */
    ^
<scratch space>:162:1: note: expanded from here
al_
^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/optim/lbfgs.h:46:3: note: in instantiation of template class 'c10::optional<std::vector<at::Tensor>>' requested here
  TORCH_ARG(c10::optional<std::vector<Tensor>>, al) = c10::nullopt;
  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/arg.h:22:5: note: expanded from macro 'TORCH_ARG'
  T name##_ /* NOLINT */
    ^
<scratch space>:162:1: note: expanded from here
al_
^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/optim/lbfgs.h:46:55: note: in instantiation of member function 'c10::optional<std::vector<at::Tensor>>::optional' requested here
  TORCH_ARG(c10::optional<std::vector<Tensor>>, al) = c10::nullopt;
                                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:4:
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:102:5: warning: 'deviceCount' has a non-throwing exception specification but can still throw [-Wexceptions]
    C10_HIP_CHECK(hipGetDeviceCount(&deviceCnt));
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/hip/HIPException.h:45:7: note: expanded from macro 'C10_HIP_CHECK'
      throw c10::HIPError(                                         \
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:100:15: note: function declared non-throwing here
  DeviceIndex deviceCount() const noexcept override {
              ^                   ~~~~~~~~
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:192:7: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
      hipGetLastError();
      ^~~~~~~~~~~~~~~
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:427:34: note: in instantiation of template class 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>' requested here
  optional<InlineDeviceGuard<T>> guard_;
                                 ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:261:72: note: in instantiation of template class 'c10::impl::InlineOptionalDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>' requested here
  c10::impl::InlineOptionalDeviceGuard<HIPGuardImplMasqueradingAsCUDA> guard_;
                                                                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:427:34: note: in instantiation of template class 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>' requested here
  optional<InlineDeviceGuard<T>> guard_;
                                 ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:261:72: note: in instantiation of template class 'c10::impl::InlineOptionalDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>' requested here
  c10::impl::InlineOptionalDeviceGuard<HIPGuardImplMasqueradingAsCUDA> guard_;
                                                                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:197:34: note: in instantiation of template class 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>' requested here
  optional<InlineStreamGuard<T>> guard_;
                                 ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:321:72: note: in instantiation of template class 'c10::impl::InlineOptionalStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>' requested here
  c10::impl::InlineOptionalStreamGuard<HIPGuardImplMasqueradingAsCUDA> guard_;
                                                                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:197:34: note: in instantiation of template class 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>' requested here
  optional<InlineStreamGuard<T>> guard_;
                                 ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:321:72: note: in instantiation of template class 'c10::impl::InlineOptionalStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>' requested here
  c10::impl::InlineOptionalStreamGuard<HIPGuardImplMasqueradingAsCUDA> guard_;
                                                                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:300:41: note: in instantiation of template class 'c10::optional<c10::hip::HIPStreamMasqueradingAsCUDA>' requested here
  optional<HIPStreamMasqueradingAsCUDA> original_stream() const {
                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:300:41: note: in instantiation of template class 'c10::optional<c10::hip::HIPStreamMasqueradingAsCUDA>' requested here
  optional<HIPStreamMasqueradingAsCUDA> original_stream() const {
                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:1215:10: note: in instantiation of function template specialization 'c10::optional<c10::hip::HIPStreamMasqueradingAsCUDA>::optional<c10::hip::HIPStreamMasqueradingAsCUDA, false>' requested here
  return optional<typename std::decay<T>::type>(constexpr_forward<T>(v));
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:303:14: note: in instantiation of function template specialization 'c10::make_optional<c10::hip::HIPStreamMasqueradingAsCUDA>' requested here
      return make_optional(HIPStreamMasqueradingAsCUDA(HIPStreamMasqueradingAsCUDA::UNCHECKED, r.value()));
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:305:14: note: in instantiation of member function 'c10::optional<c10::hip::HIPStreamMasqueradingAsCUDA>::optional' requested here
      return nullopt;
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:232:15: note: in instantiation of template class 'c10::optional<c10::hip::HIPGuardImplMasqueradingAsCUDA>' requested here
  optional<T> impl_;
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:334:69: note: in instantiation of template class 'c10::impl::InlineMultiStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>' requested here
  c10::impl::InlineMultiStreamGuard<HIPGuardImplMasqueradingAsCUDA> guard_;
                                                                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:232:15: note: in instantiation of template class 'c10::optional<c10::hip::HIPGuardImplMasqueradingAsCUDA>' requested here
  optional<T> impl_;
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:334:69: note: in instantiation of template class 'c10::impl::InlineMultiStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>' requested here
  c10::impl::InlineMultiStreamGuard<HIPGuardImplMasqueradingAsCUDA> guard_;
                                                                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:5:
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1192:20: warning: argument to '#pragma unroll' should not be in parentheses in CUDA C/C++ [-Wcuda-compat]
    #pragma unroll(1)
                   ^
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1470:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
    hipDeviceSynchronize();
    ^~~~~~~~~~~~~~~~~~~~
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:736:12: note: in instantiation of member function 'c10::optional<caffe2::TypeMeta>::dataptr' requested here
    return dataptr();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:652:9: note: in instantiation of template type alias 'OptionalBase' requested here
      : OptionalBase<T>(in_place_t{}, constexpr_forward<Args>(args)...) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:205:9: note: in instantiation of function template specialization 'c10::optional<c10::Device>::optional<c10::DeviceType, signed char &>' requested here
        c10::optional<Device>(c10::in_place, std::forward<Args>(args)...));
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:215:12: note: in instantiation of function template specialization 'c10::TensorOptions::device<c10::DeviceType, signed char &>' requested here
    return device(Device::Type::CUDA, device_index);
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:652:9: note: in instantiation of template type alias 'OptionalBase' requested here
      : OptionalBase<T>(in_place_t{}, constexpr_forward<Args>(args)...) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:205:9: note: in instantiation of function template specialization 'c10::optional<c10::Device>::optional<c10::Device>' requested here
        c10::optional<Device>(c10::in_place, std::forward<Args>(args)...));
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:585:26: note: in instantiation of function template specialization 'c10::TensorOptions::device<c10::Device>' requested here
  return TensorOptions().device(std::move(device));
                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:652:9: note: in instantiation of template type alias 'OptionalBase' requested here
      : OptionalBase<T>(in_place_t{}, constexpr_forward<Args>(args)...) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:205:9: note: in instantiation of function template specialization 'c10::optional<c10::Device>::optional<c10::DeviceType>' requested here
        c10::optional<Device>(c10::in_place, std::forward<Args>(args)...));
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:829:8: note: in instantiation of function template specialization 'c10::TensorOptions::device<c10::DeviceType>' requested here
      .device(dispatchKeyToDeviceType(dispatch_key));
       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<c10::Device>::initialize<c10::Device>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:1853:19: note: in instantiation of function template specialization 'c10::optional<c10::Device>::operator=<c10::Device>' requested here
      device_opt_ = storage_.device();
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<c10::Device>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<c10::Device>::initialize<c10::Device>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:1853:19: note: in instantiation of function template specialization 'c10::optional<c10::Device>::operator=<c10::Device>' requested here
      device_opt_ = storage_.device();
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:736:12: note: in instantiation of member function 'c10::optional<at::Generator>::dataptr' requested here
    return dataptr();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:652:9: note: in instantiation of template type alias 'OptionalBase' requested here
      : OptionalBase<T>(in_place_t{}, constexpr_forward<Args>(args)...) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:205:9: note: in instantiation of function template specialization 'c10::optional<c10::Device>::optional<c10::DeviceType, signed char>' requested here
        c10::optional<Device>(c10::in_place, std::forward<Args>(args)...));
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/DeprecatedTypeProperties.h:100:28: note: in instantiation of function template specialization 'c10::TensorOptions::device<c10::DeviceType, signed char>' requested here
                          .device(device_type(), static_cast<c10::DeviceIndex>(device_index))
                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:223:9: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::optional' requested here
      : guard_() // See Note [Explicit initialization of optional fields]
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceGuard.h:127:36: note: in instantiation of member function 'c10::impl::InlineOptionalDeviceGuard<c10::impl::VirtualGuardImpl>::InlineOptionalDeviceGuard' requested here
  explicit OptionalDeviceGuard() : guard_() {}
                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:652:9: note: in instantiation of template type alias 'OptionalBase' requested here
      : OptionalBase<T>(in_place_t{}, constexpr_forward<Args>(args)...) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:250:9: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::optional<c10::Device &>' requested here
      : guard_(in_place, std::forward<Args>(args)...) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceGuard.h:130:49: note: in instantiation of function template specialization 'c10::impl::InlineOptionalDeviceGuard<c10::impl::VirtualGuardImpl>::InlineOptionalDeviceGuard<c10::Device &>' requested here
  explicit OptionalDeviceGuard(Device device) : guard_(device) {}
                                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:594:9: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::initialized' requested here
    if (initialized())
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:695:5: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:230:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::emplace<c10::Device &>' requested here
      guard_.emplace(device_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceGuard.h:134:59: note: in instantiation of member function 'c10::impl::InlineOptionalDeviceGuard<c10::impl::VirtualGuardImpl>::InlineOptionalDeviceGuard' requested here
  explicit OptionalDeviceGuard(optional<Device> device) : guard_(device) {}
                                                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:596:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(false);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:695:5: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:230:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::emplace<c10::Device &>' requested here
      guard_.emplace(device_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceGuard.h:134:59: note: in instantiation of member function 'c10::impl::InlineOptionalDeviceGuard<c10::impl::VirtualGuardImpl>::InlineOptionalDeviceGuard' requested here
  explicit OptionalDeviceGuard(optional<Device> device) : guard_(device) {}
                                                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:595:7: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::dataptr' requested here
      dataptr()->~T();
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:695:5: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:230:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::emplace<c10::Device &>' requested here
      guard_.emplace(device_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceGuard.h:134:59: note: in instantiation of member function 'c10::impl::InlineOptionalDeviceGuard<c10::impl::VirtualGuardImpl>::InlineOptionalDeviceGuard' requested here
  explicit OptionalDeviceGuard(optional<Device> device) : guard_(device) {}
                                                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:696:5: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::initialize<c10::Device &>' requested here
    initialize(std::forward<Args>(args)...);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:230:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::emplace<c10::Device &>' requested here
      guard_.emplace(device_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceGuard.h:134:59: note: in instantiation of member function 'c10::impl::InlineOptionalDeviceGuard<c10::impl::VirtualGuardImpl>::InlineOptionalDeviceGuard' requested here
  explicit OptionalDeviceGuard(optional<Device> device) : guard_(device) {}
                                                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:652:9: note: in instantiation of template type alias 'OptionalBase' requested here
      : OptionalBase<T>(in_place_t{}, constexpr_forward<Args>(args)...) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:250:9: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::optional<c10::Device &, const c10::impl::DeviceGuardImplInterface *&>' requested here
      : guard_(in_place, std::forward<Args>(args)...) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceGuard.h:140:9: note: in instantiation of function template specialization 'c10::impl::InlineOptionalDeviceGuard<c10::impl::VirtualGuardImpl>::InlineOptionalDeviceGuard<c10::Device &, const c10::impl::DeviceGuardImplInterface *&>' requested here
      : guard_(device, impl) {}
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:696:5: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::initialize<c10::Device &, const c10::impl::DeviceGuardImplInterface *&>' requested here
    initialize(std::forward<Args>(args)...);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:370:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::emplace<c10::Device &, const c10::impl::DeviceGuardImplInterface *&>' requested here
      guard_.emplace(device, impl);
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceGuard.h:156:12: note: in instantiation of function template specialization 'c10::impl::InlineOptionalDeviceGuard<c10::impl::VirtualGuardImpl>::reset_device<c10::impl::VirtualGuardImpl, void>' requested here
    guard_.reset_device(device);
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:580:38: note: in instantiation of template type alias 'OptionalBase' requested here
    return detail_::static_addressof(OptionalBase<T>::storage_.value_);
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:731:60: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::dataptr' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), dataptr());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:409:53: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::operator->' requested here
    return guard_.has_value() ? make_optional(guard_->original_device())
                                                    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceGuard.h:168:19: note: in instantiation of member function 'c10::impl::InlineOptionalDeviceGuard<c10::impl::VirtualGuardImpl>::original_device' requested here
    return guard_.original_device();
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:686:7: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>::contained_val' requested here
      contained_val() = std::forward<U>(v);
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1314:17: note: in instantiation of function template specialization 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>::operator=<std::shared_ptr<torch::jit::CompilationUnit> &>' requested here
    strong_ptr_ = shared_cu;
                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>::initialize<std::shared_ptr<torch::jit::CompilationUnit> &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1314:17: note: in instantiation of function template specialization 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>::operator=<std::shared_ptr<torch::jit::CompilationUnit> &>' requested here
    strong_ptr_ = shared_cu;
                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>::initialize<std::shared_ptr<torch::jit::CompilationUnit> &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1314:17: note: in instantiation of function template specialization 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>::operator=<std::shared_ptr<torch::jit::CompilationUnit> &>' requested here
    strong_ptr_ = shared_cu;
                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:596:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(false);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:669:5: note: in instantiation of member function 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1315:15: note: in instantiation of member function 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>::operator=' requested here
    weak_ptr_ = c10::nullopt;
              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:595:7: note: in instantiation of member function 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>::dataptr' requested here
      dataptr()->~T();
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:669:5: note: in instantiation of member function 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1315:15: note: in instantiation of member function 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>::operator=' requested here
    weak_ptr_ = c10::nullopt;
              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:596:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(false);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:669:5: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1320:17: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>::operator=' requested here
    strong_ptr_ = c10::nullopt;
                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:686:7: note: in instantiation of member function 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>::contained_val' requested here
      contained_val() = std::forward<U>(v);
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1321:15: note: in instantiation of function template specialization 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>::operator=<std::weak_ptr<torch::jit::CompilationUnit> &>' requested here
    weak_ptr_ = weak_cu;
              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>::initialize<std::weak_ptr<torch::jit::CompilationUnit> &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1321:15: note: in instantiation of function template specialization 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>::operator=<std::weak_ptr<torch::jit::CompilationUnit> &>' requested here
    weak_ptr_ = weak_cu;
              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:686:7: note: in instantiation of member function 'c10::optional<c10::Stride>::contained_val' requested here
      contained_val() = std::forward<U>(v);
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:300:10: note: in instantiation of function template specialization 'c10::optional<c10::Stride>::operator=<c10::Stride>' requested here
    left = {Stride()};
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<c10::Stride>::initialize<c10::Stride>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:300:10: note: in instantiation of function template specialization 'c10::optional<c10::Stride>::operator=<c10::Stride>' requested here
    left = {Stride()};
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:736:12: note: in instantiation of member function 'c10::optional<c10::Stride>::dataptr' requested here
    return dataptr();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:686:7: note: in instantiation of member function 'c10::optional<std::vector<c10::ShapeSymbol>>::contained_val' requested here
      contained_val() = std::forward<U>(v);
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:385:11: note: in instantiation of function template specialization 'c10::optional<std::vector<c10::ShapeSymbol>>::operator=<std::vector<c10::ShapeSymbol> &>' requested here
    dims_ = shape_symbols;
          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<std::vector<c10::ShapeSymbol>>::initialize<std::vector<c10::ShapeSymbol> &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:385:11: note: in instantiation of function template specialization 'c10::optional<std::vector<c10::ShapeSymbol>>::operator=<std::vector<c10::ShapeSymbol> &>' requested here
    dims_ = shape_symbols;
          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<std::vector<c10::ShapeSymbol>>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<std::vector<c10::ShapeSymbol>>::initialize<std::vector<c10::ShapeSymbol> &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:385:11: note: in instantiation of function template specialization 'c10::optional<std::vector<c10::ShapeSymbol>>::operator=<std::vector<c10::ShapeSymbol> &>' requested here
    dims_ = shape_symbols;
          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<std::vector<c10::optional<long>>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:527:10: note: in instantiation of member function 'c10::optional<std::vector<c10::optional<long>>>::operator bool' requested here
    if (!dims_) {
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:613:20: note: in instantiation of member function 'c10::VaryingShape<long>::size' requested here
    return sizes().size();
                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:755:11: note: in instantiation of member function 'c10::optional<std::vector<c10::optional<long>>>::contained_val' requested here
        ? contained_val()
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:530:30: note: in instantiation of member function 'c10::optional<std::vector<c10::optional<long>>>::value' requested here
    const auto& dims = dims_.value();
                             ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:613:20: note: in instantiation of member function 'c10::VaryingShape<long>::size' requested here
    return sizes().size();
                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:505:61: note: in instantiation of member function 'c10::optional<std::vector<c10::optional<c10::Stride>>>::optional' requested here
  VaryingShape(c10::optional<size_t> size = c10::nullopt) : dims_(c10::nullopt) {
                                                            ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:680:22: note: in instantiation of member function 'c10::VaryingShape<c10::Stride>::VaryingShape' requested here
    copy->strides_ = VaryingShape<Stride>(d);
                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:685:9: note: in instantiation of member function 'c10::optional<std::vector<c10::optional<c10::Stride>>>::initialized' requested here
    if (initialized()) {
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:507:13: note: in instantiation of function template specialization 'c10::optional<std::vector<c10::optional<c10::Stride>>>::operator=<std::vector<c10::optional<c10::Stride>>>' requested here
      dims_ = ListOfOptionalElements(*size);
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:680:22: note: in instantiation of member function 'c10::VaryingShape<c10::Stride>::VaryingShape' requested here
    copy->strides_ = VaryingShape<Stride>(d);
                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:686:7: note: in instantiation of member function 'c10::optional<std::vector<c10::optional<c10::Stride>>>::contained_val' requested here
      contained_val() = std::forward<U>(v);
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:507:13: note: in instantiation of function template specialization 'c10::optional<std::vector<c10::optional<c10::Stride>>>::operator=<std::vector<c10::optional<c10::Stride>>>' requested here
      dims_ = ListOfOptionalElements(*size);
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:680:22: note: in instantiation of member function 'c10::VaryingShape<c10::Stride>::VaryingShape' requested here
    copy->strides_ = VaryingShape<Stride>(d);
                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<std::vector<c10::optional<c10::Stride>>>::initialize<std::vector<c10::optional<c10::Stride>>>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:507:13: note: in instantiation of function template specialization 'c10::optional<std::vector<c10::optional<c10::Stride>>>::operator=<std::vector<c10::optional<c10::Stride>>>' requested here
      dims_ = ListOfOptionalElements(*size);
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:680:22: note: in instantiation of member function 'c10::VaryingShape<c10::Stride>::VaryingShape' requested here
    copy->strides_ = VaryingShape<Stride>(d);
                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<std::vector<c10::optional<c10::Stride>>>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<std::vector<c10::optional<c10::Stride>>>::initialize<std::vector<c10::optional<c10::Stride>>>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:507:13: note: in instantiation of function template specialization 'c10::optional<std::vector<c10::optional<c10::Stride>>>::operator=<std::vector<c10::optional<c10::Stride>>>' requested here
      dims_ = ListOfOptionalElements(*size);
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:680:22: note: in instantiation of member function 'c10::VaryingShape<c10::Stride>::VaryingShape' requested here
    copy->strides_ = VaryingShape<Stride>(d);
                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:551:12: note: in instantiation of function template specialization 'c10::optional<std::vector<long>>::optional<std::vector<long>, false>' requested here
    return sizes;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:726:35: note: in instantiation of member function 'c10::VaryingShape<long>::concrete_sizes' requested here
    TORCH_INTERNAL_ASSERT(sizes().concrete_sizes().has_value());
                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<std::vector<c10::optional<c10::Stride>>>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:558:19: note: in instantiation of member function 'c10::optional<std::vector<c10::optional<c10::Stride>>>::operator*' requested here
    for (auto d : *dims_) {
                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:745:71: note: in instantiation of member function 'c10::VaryingShape<c10::Stride>::isComplete' requested here
    return scalar_type_ && device_ && sizes_.isComplete() && strides_.isComplete();
                                                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<bool>::initialize<bool>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:773:19: note: in instantiation of function template specialization 'c10::optional<bool>::operator=<bool>' requested here
    r->undefined_ = true;
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<bool>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<bool>::initialize<bool>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:773:19: note: in instantiation of function template specialization 'c10::optional<bool>::operator=<bool>' requested here
    r->undefined_ = true;
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:596:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(false);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:669:5: note: in instantiation of member function 'c10::optional<bool>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:779:19: note: in instantiation of member function 'c10::optional<bool>::operator=' requested here
    r->undefined_ = c10::nullopt;
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:138:9: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>::optional' requested here
      : guard_() // See Note [Explicit initialization of optional fields]
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:88:36: note: in instantiation of member function 'c10::impl::InlineOptionalStreamGuard<c10::impl::VirtualGuardImpl>::InlineOptionalStreamGuard' requested here
  explicit OptionalStreamGuard() : guard_() {}
                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:652:9: note: in instantiation of template type alias 'OptionalBase' requested here
      : OptionalBase<T>(in_place_t{}, constexpr_forward<Args>(args)...) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:153:9: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>::optional<c10::Stream &>' requested here
      : guard_(in_place, std::forward<Args>(args)...) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:92:49: note: in instantiation of function template specialization 'c10::impl::InlineOptionalStreamGuard<c10::impl::VirtualGuardImpl>::InlineOptionalStreamGuard<c10::Stream &>' requested here
  explicit OptionalStreamGuard(Stream stream) : guard_(stream) {}
                                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:594:9: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>::initialized' requested here
    if (initialized())
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:695:5: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:146:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>::emplace<c10::Stream &>' requested here
      guard_.emplace(stream_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:98:9: note: in instantiation of member function 'c10::impl::InlineOptionalStreamGuard<c10::impl::VirtualGuardImpl>::InlineOptionalStreamGuard' requested here
      : guard_(stream_opt) {}
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:596:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(false);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:695:5: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:146:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>::emplace<c10::Stream &>' requested here
      guard_.emplace(stream_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:98:9: note: in instantiation of member function 'c10::impl::InlineOptionalStreamGuard<c10::impl::VirtualGuardImpl>::InlineOptionalStreamGuard' requested here
      : guard_(stream_opt) {}
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:595:7: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>::dataptr' requested here
      dataptr()->~T();
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:695:5: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:146:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>::emplace<c10::Stream &>' requested here
      guard_.emplace(stream_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:98:9: note: in instantiation of member function 'c10::impl::InlineOptionalStreamGuard<c10::impl::VirtualGuardImpl>::InlineOptionalStreamGuard' requested here
      : guard_(stream_opt) {}
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:696:5: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>::initialize<c10::Stream &>' requested here
    initialize(std::forward<Args>(args)...);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:146:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>::emplace<c10::Stream &>' requested here
      guard_.emplace(stream_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:98:9: note: in instantiation of member function 'c10::impl::InlineOptionalStreamGuard<c10::impl::VirtualGuardImpl>::InlineOptionalStreamGuard' requested here
      : guard_(stream_opt) {}
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:580:38: note: in instantiation of template type alias 'OptionalBase' requested here
    return detail_::static_addressof(OptionalBase<T>::storage_.value_);
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:731:60: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>::dataptr' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), dataptr());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:178:53: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>::operator->' requested here
    return guard_.has_value() ? make_optional(guard_->original_stream())
                                                    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:122:19: note: in instantiation of member function 'c10::impl::InlineOptionalStreamGuard<c10::impl::VirtualGuardImpl>::original_stream' requested here
    return guard_.original_stream();
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:206:12: note: in instantiation of member function 'c10::optional<c10::impl::VirtualGuardImpl>::optional' requested here
  explicit InlineMultiStreamGuard(ArrayRef<Stream> streams) {
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:149:57: note: in instantiation of member function 'c10::impl::InlineMultiStreamGuard<c10::impl::VirtualGuardImpl>::InlineMultiStreamGuard' requested here
  explicit MultiStreamGuard(ArrayRef<Stream> streams) : guard_(streams) {}
                                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:735:12: note: in instantiation of member function 'c10::optional<c10::impl::VirtualGuardImpl>::initialized' requested here
    assert(initialized());
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:211:48: note: in instantiation of member function 'c10::optional<c10::impl::VirtualGuardImpl>::operator->' requested here
        original_streams_.push_back(this->impl_->exchangeStream(s));
                                               ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:149:57: note: in instantiation of member function 'c10::impl::InlineMultiStreamGuard<c10::impl::VirtualGuardImpl>::InlineMultiStreamGuard' requested here
  explicit MultiStreamGuard(ArrayRef<Stream> streams) : guard_(streams) {}
                                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:596:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(false);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:695:5: note: in instantiation of member function 'c10::optional<c10::impl::VirtualGuardImpl>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:208:13: note: in instantiation of function template specialization 'c10::optional<c10::impl::VirtualGuardImpl>::emplace<c10::DeviceType>' requested here
      impl_.emplace(getDeviceTypeOfStreams(streams));
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:149:57: note: in instantiation of member function 'c10::impl::InlineMultiStreamGuard<c10::impl::VirtualGuardImpl>::InlineMultiStreamGuard' requested here
  explicit MultiStreamGuard(ArrayRef<Stream> streams) : guard_(streams) {}
                                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:696:5: note: in instantiation of function template specialization 'c10::optional<c10::impl::VirtualGuardImpl>::initialize<c10::DeviceType>' requested here
    initialize(std::forward<Args>(args)...);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:208:13: note: in instantiation of function template specialization 'c10::optional<c10::impl::VirtualGuardImpl>::emplace<c10::DeviceType>' requested here
      impl_.emplace(getDeviceTypeOfStreams(streams));
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:149:57: note: in instantiation of member function 'c10::impl::InlineMultiStreamGuard<c10::impl::VirtualGuardImpl>::InlineMultiStreamGuard' requested here
  explicit MultiStreamGuard(ArrayRef<Stream> streams) : guard_(streams) {}
                                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:736:12: note: in instantiation of member function 'c10::optional<c10::impl::VirtualGuardImpl>::dataptr' requested here
    return dataptr();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:149:57: note: in instantiation of member function 'c10::impl::InlineMultiStreamGuard<c10::impl::VirtualGuardImpl>::InlineMultiStreamGuard' requested here
  explicit MultiStreamGuard(ArrayRef<Stream> streams) : guard_(streams) {}
                                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:1759:10: note: in instantiation of function template specialization 'c10::optional<at::Tensor>::optional<at::Tensor, false>' requested here
  return std::move(ivalue).to<T>();
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:1801:10: note: in instantiation of function template specialization 'c10::generic_to<at::Tensor>' requested here
  return generic_to(*this, _fake_type<T>{});
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:1675:36: note: in instantiation of function template specialization 'c10::IValue::to<c10::optional<at::Tensor>>' requested here
    result.push_back(impl->list[i].to<typename T::value_type>());
                                   ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:1682:10: note: in instantiation of function template specialization 'c10::createVectorLikeFromList<std::vector<c10::optional<at::Tensor>>>' requested here
  return createVectorLikeFromList<std::vector<T>>(impl);
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:1897:10: note: in instantiation of function template specialization 'c10::createVectorFromList<c10::optional<at::Tensor>>' requested here
  return createVectorFromList<c10::optional<at::Tensor>>(
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:652:9: note: in instantiation of template type alias 'OptionalBase' requested here
      : OptionalBase<T>(in_place_t{}, constexpr_forward<Args>(args)...) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:205:9: note: in instantiation of function template specialization 'c10::optional<c10::Device>::optional<const c10::DeviceType &>' requested here
        c10::optional<Device>(c10::in_place, std::forward<Args>(args)...));
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:163:51: note: in instantiation of function template specialization 'c10::TensorOptions::device<const c10::DeviceType &>' requested here
AT_FORALL_SCALAR_TYPES_AND3(Bool, Half, BFloat16, TENSOR)
                                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<c10::AliasAnalysisKind>::initialize<c10::AliasAnalysisKind &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:441:17: note: in instantiation of function template specialization 'c10::optional<c10::AliasAnalysisKind>::operator=<c10::AliasAnalysisKind &>' requested here
    alias_kind_ = v;
                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<c10::AliasAnalysisKind>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<c10::AliasAnalysisKind>::initialize<c10::AliasAnalysisKind &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:441:17: note: in instantiation of function template specialization 'c10::optional<c10::AliasAnalysisKind>::operator=<c10::AliasAnalysisKind &>' requested here
    alias_kind_ = v;
                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:686:7: note: in instantiation of member function 'c10::optional<c10::either<c10::OperatorName, c10::FunctionSchema>>::contained_val' requested here
      contained_val() = std::forward<U>(v);
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/op_registration/op_registration.h:85:23: note: in instantiation of function template specialization 'c10::optional<c10::either<c10::OperatorName, c10::FunctionSchema>>::operator=<c10::either<c10::OperatorName, c10::FunctionSchema>>' requested here
        schemaOrName_ = c10::make_right<OperatorName, FunctionSchema>(std::move(schema));
                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<c10::either<c10::OperatorName, c10::FunctionSchema>>::initialize<c10::either<c10::OperatorName, c10::FunctionSchema>>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/op_registration/op_registration.h:85:23: note: in instantiation of function template specialization 'c10::optional<c10::either<c10::OperatorName, c10::FunctionSchema>>::operator=<c10::either<c10::OperatorName, c10::FunctionSchema>>' requested here
        schemaOrName_ = c10::make_right<OperatorName, FunctionSchema>(std::move(schema));
                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<c10::either<c10::OperatorName, c10::FunctionSchema>>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<c10::either<c10::OperatorName, c10::FunctionSchema>>::initialize<c10::either<c10::OperatorName, c10::FunctionSchema>>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/op_registration/op_registration.h:85:23: note: in instantiation of function template specialization 'c10::optional<c10::either<c10::OperatorName, c10::FunctionSchema>>::operator=<c10::either<c10::OperatorName, c10::FunctionSchema>>' requested here
        schemaOrName_ = c10::make_right<OperatorName, FunctionSchema>(std::move(schema));
                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema_inl.h:355:42: note: in instantiation of function template specialization 'c10::optional<unsigned long>::optional<const unsigned long &, false>' requested here
      checkArg<T>(inputs[pos], argument, pos);
                                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function.h:61:17: note: in instantiation of function template specialization 'c10::FunctionSchema::checkAndNormalizeInputs<c10::Type>' requested here
    getSchema().checkAndNormalizeInputs(stack, kwargs);
                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:686:7: note: in instantiation of member function 'c10::optional<c10::IValue>::contained_val' requested here
      contained_val() = std::forward<U>(v);
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/custom_class_detail.h:54:12: note: in instantiation of function template specialization 'c10::optional<c10::IValue>::operator=<const c10::IValue &>' requested here
    value_ = rhs;
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<c10::IValue>::initialize<const c10::IValue &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/custom_class_detail.h:54:12: note: in instantiation of function template specialization 'c10::optional<c10::IValue>::operator=<const c10::IValue &>' requested here
    value_ = rhs;
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:736:12: note: in instantiation of member function 'c10::optional<c10::impl::AnnotatedSchema>::dataptr' requested here
    return dataptr();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:736:12: note: in instantiation of member function 'c10::optional<c10::impl::OperatorEntry::CppSignatureWithDebug>::dataptr' requested here
    return dataptr();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:736:12: note: in instantiation of member function 'c10::optional<std::chrono::duration<long, std::ratio<1, 1000>>>::dataptr' requested here
    return dataptr();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:736:12: note: in instantiation of member function 'c10::optional<c10::IValue>::dataptr' requested here
    return dataptr();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<std::basic_string<char>>::initialize<const std::basic_string<char> &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/ir.h:376:27: note: in instantiation of function template specialization 'c10::optional<std::basic_string<char>>::operator=<const std::basic_string<char> &>' requested here
    historic_schema_name_ = name;
                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<std::basic_string<char>>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<std::basic_string<char>>::initialize<const std::basic_string<char> &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/ir.h:376:27: note: in instantiation of function template specialization 'c10::optional<std::basic_string<char>>::operator=<const std::basic_string<char> &>' requested here
    historic_schema_name_ = name;
                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:686:7: note: in instantiation of member function 'c10::optional<torch::jit::SourceRange>::contained_val' requested here
      contained_val() = std::forward<U>(v);
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/ir.h:396:19: note: in instantiation of function template specialization 'c10::optional<torch::jit::SourceRange>::operator=<torch::jit::SourceRange>' requested here
    source_range_ = std::move(r);
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<torch::jit::SourceRange>::initialize<torch::jit::SourceRange>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/ir.h:396:19: note: in instantiation of function template specialization 'c10::optional<torch::jit::SourceRange>::operator=<torch::jit::SourceRange>' requested here
    source_range_ = std::move(r);
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<torch::jit::SourceRange>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<torch::jit::SourceRange>::initialize<torch::jit::SourceRange>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/ir.h:396:19: note: in instantiation of function template specialization 'c10::optional<torch::jit::SourceRange>::operator=<torch::jit::SourceRange>' requested here
    source_range_ = std::move(r);
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<c10::intrusive_ptr<torch::jit::InlinedCallStack>>::initialize<c10::intrusive_ptr<torch::jit::InlinedCallStack> &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/ir.h:439:16: note: in instantiation of function template specialization 'c10::optional<c10::intrusive_ptr<torch::jit::InlinedCallStack>>::operator=<c10::intrusive_ptr<torch::jit::InlinedCallStack> &>' requested here
    callstack_ = cs;
               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<c10::intrusive_ptr<torch::jit::InlinedCallStack>>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<c10::intrusive_ptr<torch::jit::InlinedCallStack>>::initialize<c10::intrusive_ptr<torch::jit::InlinedCallStack> &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/ir.h:439:16: note: in instantiation of function template specialization 'c10::optional<c10::intrusive_ptr<torch::jit::InlinedCallStack>>::operator=<c10::intrusive_ptr<torch::jit::InlinedCallStack> &>' requested here
    callstack_ = cs;
               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:511:47: note: in instantiation of function template specialization 'c10::optional<std::vector<c10::optional<long>>>::optional<std::vector<c10::optional<long>>, false>' requested here
  VaryingShape(ListOfOptionalElements dims) : dims_(std::move(dims)) {}
                                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:503:9: note: in instantiation of member function 'c10::VaryingShape<long>::VaryingShape' requested here
      : VaryingShape(ListOfOptionalElements(vec.begin(), vec.end())) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/runtime/argument_spec.h:384:9: note: in instantiation of member function 'c10::VaryingShape<long>::VaryingShape' requested here
        c10::VaryingShape<int64_t>{sizes()},
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<signed char>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:1232:33: note: in instantiation of member function 'c10::optional<signed char>::operator*' requested here
    return arg ? std::hash<T>{}(*arg) : result_type{};
                                ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/hash.h:258:10: note: in instantiation of member function 'std::hash<c10::optional<signed char>>::operator()' requested here
  return std::hash<T>()(o);
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/hash.h:279:26: note: in instantiation of function template specialization 'c10::_hash_detail::dispatch_hash<c10::optional<signed char>>' requested here
    return _hash_detail::dispatch_hash(o);
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/hash.h:330:10: note: (skipping 3 contexts in backtrace; use -ftemplate-backtrace-limit=0 to see all)
  return c10::hash<T>()(o);
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/hash.h:291:11: note: in instantiation of member function 'c10::hash<std::tuple<const c10::optional<signed char> &, const c10::VaryingShape<long> &, const c10::VaryingShape<long> &, const c10::optional<bool> &>>::tuple_hash<1, const c10::optional<signed char> &, const c10::VaryingShape<long> &, const c10::VaryingShape<long> &, const c10::optional<bool> &>::operator()' requested here
          tuple_hash<idx - 1, Ts...>()(t));
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/hash.h:291:11: note: in instantiation of member function 'c10::hash<std::tuple<const c10::optional<signed char> &, const c10::VaryingShape<long> &, const c10::VaryingShape<long> &, const c10::optional<bool> &>>::tuple_hash<2, const c10::optional<signed char> &, const c10::VaryingShape<long> &, const c10::VaryingShape<long> &, const c10::optional<bool> &>::operator()' requested here
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/hash.h:303:12: note: in instantiation of member function 'c10::hash<std::tuple<const c10::optional<signed char> &, const c10::VaryingShape<long> &, const c10::VaryingShape<long> &, const c10::optional<bool> &>>::tuple_hash<3, const c10::optional<signed char> &, const c10::VaryingShape<long> &, const c10::VaryingShape<long> &, const c10::optional<bool> &>::operator()' requested here
    return tuple_hash<sizeof...(Types) - 1, Types...>()(t);
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/hash.h:344:10: note: in instantiation of member function 'c10::hash<std::tuple<const c10::optional<signed char> &, const c10::VaryingShape<long> &, const c10::VaryingShape<long> &, const c10::optional<bool> &>>::operator()' requested here
  return c10::hash<decltype(std::tie(args...))>()(std::tie(args...));
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/runtime/argument_spec.h:486:17: note: in instantiation of function template specialization 'c10::get_hash<c10::optional<signed char>, c10::VaryingShape<long>, c10::VaryingShape<long>, c10::optional<bool>>' requested here
    return c10::get_hash<
                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<std::shared_ptr<torch::jit::Graph>>::initialize<std::shared_ptr<torch::jit::Graph>>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:49:21: note: in instantiation of function template specialization 'c10::optional<std::shared_ptr<torch::jit::Graph>>::operator=<std::shared_ptr<torch::jit::Graph>>' requested here
    optimized_graph = graph_->copy();
                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::Graph>>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<std::shared_ptr<torch::jit::Graph>>::initialize<std::shared_ptr<torch::jit::Graph>>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:49:21: note: in instantiation of function template specialization 'c10::optional<std::shared_ptr<torch::jit::Graph>>::operator=<std::shared_ptr<torch::jit::Graph>>' requested here
    optimized_graph = graph_->copy();
                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<torch::jit::ExecutorExecutionMode>::initialize<torch::jit::ExecutorExecutionMode &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:64:30: note: in instantiation of function template specialization 'c10::optional<torch::jit::ExecutorExecutionMode>::operator=<torch::jit::ExecutorExecutionMode &>' requested here
    executor_execution_mode_ = mode;
                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<torch::jit::ExecutorExecutionMode>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<torch::jit::ExecutorExecutionMode>::initialize<torch::jit::ExecutorExecutionMode &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:64:30: note: in instantiation of function template specialization 'c10::optional<torch::jit::ExecutorExecutionMode>::operator=<torch::jit::ExecutorExecutionMode &>' requested here
    executor_execution_mode_ = mode;
                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<torch::jit::GraphExecutor>::initialize<torch::jit::GraphExecutor>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:115:16: note: in instantiation of function template specialization 'c10::optional<torch::jit::GraphExecutor>::operator=<torch::jit::GraphExecutor>' requested here
      executor = GraphExecutor(opt_graph, name);
               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<torch::jit::GraphExecutor>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<torch::jit::GraphExecutor>::initialize<torch::jit::GraphExecutor>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:115:16: note: in instantiation of function template specialization 'c10::optional<torch::jit::GraphExecutor>::operator=<torch::jit::GraphExecutor>' requested here
      executor = GraphExecutor(opt_graph, name);
               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<torch::jit::Method>::initialize<torch::jit::Method>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/object.h:131:18: note: in instantiation of function template specialization 'c10::optional<torch::jit::Method>::operator=<torch::jit::Method>' requested here
          setter = Method(_ivalue(), prop.setter);
                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<torch::jit::Method>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<torch::jit::Method>::initialize<torch::jit::Method>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/object.h:131:18: note: in instantiation of function template specialization 'c10::optional<torch::jit::Method>::operator=<torch::jit::Method>' requested here
          setter = Method(_ivalue(), prop.setter);
                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:686:7: note: in instantiation of member function 'c10::optional<std::vector<std::vector<long>>>::contained_val' requested here
      contained_val() = std::forward<U>(v);
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_kineto.h:60:13: note: in instantiation of function template specialization 'c10::optional<std::vector<std::vector<long>>>::operator=<const std::vector<std::vector<long>> &>' requested here
    shapes_ = shapes;
            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<std::vector<std::vector<long>>>::initialize<const std::vector<std::vector<long>> &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_kineto.h:60:13: note: in instantiation of function template specialization 'c10::optional<std::vector<std::vector<long>>>::operator=<const std::vector<std::vector<long>> &>' requested here
    shapes_ = shapes;
            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<std::vector<std::vector<long>>>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<std::vector<std::vector<long>>>::initialize<const std::vector<std::vector<long>> &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_kineto.h:60:13: note: in instantiation of function template specialization 'c10::optional<std::vector<std::vector<long>>>::operator=<const std::vector<std::vector<long>> &>' requested here
    shapes_ = shapes;
            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:686:7: note: in instantiation of member function 'c10::optional<std::vector<std::basic_string<char>>>::contained_val' requested here
      contained_val() = std::forward<U>(v);
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_kineto.h:73:13: note: in instantiation of function template specialization 'c10::optional<std::vector<std::basic_string<char>>>::operator=<const std::vector<std::basic_string<char>> &>' requested here
    dtypes_ = dtypes;
            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<std::vector<std::basic_string<char>>>::initialize<const std::vector<std::basic_string<char>> &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_kineto.h:73:13: note: in instantiation of function template specialization 'c10::optional<std::vector<std::basic_string<char>>>::operator=<const std::vector<std::basic_string<char>> &>' requested here
    dtypes_ = dtypes;
            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<std::vector<std::basic_string<char>>>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<std::vector<std::basic_string<char>>>::initialize<const std::vector<std::basic_string<char>> &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_kineto.h:73:13: note: in instantiation of function template specialization 'c10::optional<std::vector<std::basic_string<char>>>::operator=<const std::vector<std::basic_string<char>> &>' requested here
    dtypes_ = dtypes;
            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<long>::initialize<long>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/embedding.h:35:19: note: in instantiation of function template specialization 'c10::optional<long>::operator=<long>' requested here
      padding_idx = weight.size(0) + *padding_idx;
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<long>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<long>::initialize<long>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/embedding.h:35:19: note: in instantiation of function template specialization 'c10::optional<long>::operator=<long>' requested here
      padding_idx = weight.size(0) + *padding_idx;
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<long>::initialize<int>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/embedding.h:38:17: note: in instantiation of function template specialization 'c10::optional<long>::operator=<int>' requested here
    padding_idx = -1;
                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<double>::initialize<double &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/padding.h:31:16: note: in instantiation of function template specialization 'c10::optional<double>::operator=<double &>' requested here
    fill_value = value;
               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<double>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<double>::initialize<double &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/padding.h:31:16: note: in instantiation of function template specialization 'c10::optional<double>::operator=<double &>' requested here
    fill_value = value;
               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<torch::ExpandingArray<2>>::initialize<torch::ExpandingArray<2>>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:773:18: note: in instantiation of function template specialization 'c10::optional<torch::ExpandingArray<2>>::operator=<torch::ExpandingArray<2>>' requested here
    output_size_ = {(int64_t)(static_cast<double>(input.size(-2)) * (*output_ratio.value())[0]),
                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<2>>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<torch::ExpandingArray<2>>::initialize<torch::ExpandingArray<2>>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:773:18: note: in instantiation of function template specialization 'c10::optional<torch::ExpandingArray<2>>::operator=<torch::ExpandingArray<2>>' requested here
    output_size_ = {(int64_t)(static_cast<double>(input.size(-2)) * (*output_ratio.value())[0]),
                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<torch::ExpandingArray<3>>::initialize<torch::ExpandingArray<3>>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:852:18: note: in instantiation of function template specialization 'c10::optional<torch::ExpandingArray<3>>::operator=<torch::ExpandingArray<3>>' requested here
    output_size_ = {(int64_t)(static_cast<double>(input.size(-3)) * (*output_ratio.value())[0]),
                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<3>>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<torch::ExpandingArray<3>>::initialize<torch::ExpandingArray<3>>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:852:18: note: in instantiation of function template specialization 'c10::optional<torch::ExpandingArray<3>>::operator=<torch::ExpandingArray<3>>' requested here
    output_size_ = {(int64_t)(static_cast<double>(input.size(-3)) * (*output_ratio.value())[0]),
                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/ext/new_allocator.h:146:23: note: in instantiation of function template specialization 'c10::optional<double>::optional<const double &, false>' requested here
        { ::new((void *)__p) _Up(std::forward<_Args>(__args)...); }
                             ^
/usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/bits/alloc_traits.h:483:8: note: in instantiation of function template specialization '__gnu_cxx::new_allocator<c10::optional<double>>::construct<c10::optional<double>, const double &>' requested here
        { __a.construct(__p, std::forward<_Args>(__args)...); }
              ^
/usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/bits/vector.tcc:115:21: note: in instantiation of function template specialization 'std::allocator_traits<std::allocator<c10::optional<double>>>::construct<c10::optional<double>, const double &>' requested here
            _Alloc_traits::construct(this->_M_impl, this->_M_impl._M_finish,
                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:107:25: note: in instantiation of function template specialization 'std::vector<c10::optional<double>>::emplace_back<const double &>' requested here
      scale_factor_list.emplace_back(elem);
                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<long>::initialize<const long &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/expanding_array.h:137:24: note: in instantiation of function template specialization 'c10::optional<long>::operator=<const long &>' requested here
      this->values_[i] = values[i];
                       ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/expanding_array.h:125:9: note: in instantiation of member function 'torch::ExpandingArrayWithOptionalElem<2>::ExpandingArrayWithOptionalElem' requested here
      : ExpandingArrayWithOptionalElem(at::ArrayRef<T>(vec)) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:137:47: note: in instantiation of member function 'torch::ExpandingArrayWithOptionalElem<2>::ExpandingArrayWithOptionalElem' requested here
    return detail::adaptive_avg_pool2d(input, _interp_output_size(2, closed_over_args));
                                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/pooling.h:437:62: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<2>>::optional' requested here
  TORCH_ARG(c10::optional<ExpandingArray<D>>, output_size) = c10::nullopt;
                                                             ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/pooling.h:430:3: note: in instantiation of default member initializer 'torch::nn::FractionalMaxPoolOptions<2>::output_size_' requested here
  FractionalMaxPoolOptions(ExpandingArray<D> kernel_size)
  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/modules/pooling.h:587:33: note: in instantiation of member function 'torch::nn::FractionalMaxPoolOptions<2>::FractionalMaxPoolOptions' requested here
      : FractionalMaxPool2dImpl(FractionalMaxPool2dOptions(kernel_size)) {}
                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/pooling.h:442:66: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<2, double>>::optional' requested here
  TORCH_ARG(c10::optional<ExpandingArrayDouble>, output_ratio) = c10::nullopt;
                                                                 ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/pooling.h:430:3: note: in instantiation of default member initializer 'torch::nn::FractionalMaxPoolOptions<2>::output_ratio_' requested here
  FractionalMaxPoolOptions(ExpandingArray<D> kernel_size)
  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/modules/pooling.h:587:33: note: in instantiation of member function 'torch::nn::FractionalMaxPoolOptions<2>::FractionalMaxPoolOptions' requested here
      : FractionalMaxPool2dImpl(FractionalMaxPool2dOptions(kernel_size)) {}
                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/pooling.h:437:62: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<3>>::optional' requested here
  TORCH_ARG(c10::optional<ExpandingArray<D>>, output_size) = c10::nullopt;
                                                             ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/pooling.h:430:3: note: in instantiation of default member initializer 'torch::nn::FractionalMaxPoolOptions<3>::output_size_' requested here
  FractionalMaxPoolOptions(ExpandingArray<D> kernel_size)
  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/modules/pooling.h:631:33: note: in instantiation of member function 'torch::nn::FractionalMaxPoolOptions<3>::FractionalMaxPoolOptions' requested here
      : FractionalMaxPool3dImpl(FractionalMaxPool3dOptions(kernel_size)) {}
                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/pooling.h:442:66: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<3, double>>::optional' requested here
  TORCH_ARG(c10::optional<ExpandingArrayDouble>, output_ratio) = c10::nullopt;
                                                                 ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/pooling.h:430:3: note: in instantiation of default member initializer 'torch::nn::FractionalMaxPoolOptions<3>::output_ratio_' requested here
  FractionalMaxPoolOptions(ExpandingArray<D> kernel_size)
  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/modules/pooling.h:631:33: note: in instantiation of member function 'torch::nn::FractionalMaxPoolOptions<3>::FractionalMaxPoolOptions' requested here
      : FractionalMaxPool3dImpl(FractionalMaxPool3dOptions(kernel_size)) {}
                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<double>::initialize<double>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h:63:16: note: in instantiation of function template specialization 'c10::optional<double>::operator=<double>' requested here
    total_norm = total_norm_tensor.item().toDouble();
               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:596:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(false);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:669:5: note: in instantiation of member function 'c10::optional<long>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/optim/lbfgs.h:65:19: note: in instantiation of member function 'c10::optional<long>::operator=' requested here
     _numel_cache = c10::nullopt;
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:223:9: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::optional' requested here
      : guard_() // See Note [Explicit initialization of optional fields]
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:244:51: note: in instantiation of member function 'c10::impl::InlineOptionalDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineOptionalDeviceGuard' requested here
  explicit OptionalHIPGuardMasqueradingAsCUDA() : guard_() {}
                                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:594:9: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::initialized' requested here
    if (initialized())
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:695:5: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:230:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::emplace<c10::Device &>' requested here
      guard_.emplace(device_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:245:78: note: in instantiation of member function 'c10::impl::InlineOptionalDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineOptionalDeviceGuard' requested here
  explicit OptionalHIPGuardMasqueradingAsCUDA(optional<Device> device_opt) : guard_(device_opt) {}
                                                                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:596:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(false);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:695:5: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:230:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::emplace<c10::Device &>' requested here
      guard_.emplace(device_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:245:78: note: in instantiation of member function 'c10::impl::InlineOptionalDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineOptionalDeviceGuard' requested here
  explicit OptionalHIPGuardMasqueradingAsCUDA(optional<Device> device_opt) : guard_(device_opt) {}
                                                                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:595:7: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::dataptr' requested here
      dataptr()->~T();
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:695:5: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:230:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::emplace<c10::Device &>' requested here
      guard_.emplace(device_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:245:78: note: in instantiation of member function 'c10::impl::InlineOptionalDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineOptionalDeviceGuard' requested here
  explicit OptionalHIPGuardMasqueradingAsCUDA(optional<Device> device_opt) : guard_(device_opt) {}
                                                                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:696:5: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::initialize<c10::Device &>' requested here
    initialize(std::forward<Args>(args)...);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:230:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::emplace<c10::Device &>' requested here
      guard_.emplace(device_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:245:78: note: in instantiation of member function 'c10::impl::InlineOptionalDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineOptionalDeviceGuard' requested here
  explicit OptionalHIPGuardMasqueradingAsCUDA(optional<Device> device_opt) : guard_(device_opt) {}
                                                                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:696:5: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::initialize<signed char &>' requested here
    initialize(std::forward<Args>(args)...);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:242:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::emplace<signed char &>' requested here
      guard_.emplace(device_index_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:246:89: note: in instantiation of function template specialization 'c10::impl::InlineOptionalDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineOptionalDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA, void>' requested here
  explicit OptionalHIPGuardMasqueradingAsCUDA(optional<DeviceIndex> device_index_opt) : guard_(device_index_opt) {}
                                                                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:580:38: note: in instantiation of template type alias 'OptionalBase' requested here
    return detail_::static_addressof(OptionalBase<T>::storage_.value_);
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:731:60: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::dataptr' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), dataptr());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:409:53: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::operator->' requested here
    return guard_.has_value() ? make_optional(guard_->original_device())
                                                    ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:256:60: note: in instantiation of member function 'c10::impl::InlineOptionalDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::original_device' requested here
  optional<Device> original_device() const { return guard_.original_device(); }
                                                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:138:9: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::optional' requested here
      : guard_() // See Note [Explicit initialization of optional fields]
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:289:57: note: in instantiation of member function 'c10::impl::InlineOptionalStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineOptionalStreamGuard' requested here
  explicit OptionalHIPStreamGuardMasqueradingAsCUDA() : guard_() {}
                                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:652:9: note: in instantiation of template type alias 'OptionalBase' requested here
      : OptionalBase<T>(in_place_t{}, constexpr_forward<Args>(args)...) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:153:9: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::optional<c10::Stream &>' requested here
      : guard_(in_place, std::forward<Args>(args)...) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:290:70: note: in instantiation of function template specialization 'c10::impl::InlineOptionalStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineOptionalStreamGuard<c10::Stream &>' requested here
  explicit OptionalHIPStreamGuardMasqueradingAsCUDA(Stream stream) : guard_(stream) {}
                                                                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:594:9: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::initialized' requested here
    if (initialized())
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:695:5: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:146:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::emplace<c10::Stream &>' requested here
      guard_.emplace(stream_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:291:84: note: in instantiation of member function 'c10::impl::InlineOptionalStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineOptionalStreamGuard' requested here
  explicit OptionalHIPStreamGuardMasqueradingAsCUDA(optional<Stream> stream_opt) : guard_(stream_opt) {}
                                                                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:596:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(false);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:695:5: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:146:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::emplace<c10::Stream &>' requested here
      guard_.emplace(stream_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:291:84: note: in instantiation of member function 'c10::impl::InlineOptionalStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineOptionalStreamGuard' requested here
  explicit OptionalHIPStreamGuardMasqueradingAsCUDA(optional<Stream> stream_opt) : guard_(stream_opt) {}
                                                                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:595:7: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::dataptr' requested here
      dataptr()->~T();
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:695:5: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:146:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::emplace<c10::Stream &>' requested here
      guard_.emplace(stream_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:291:84: note: in instantiation of member function 'c10::impl::InlineOptionalStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineOptionalStreamGuard' requested here
  explicit OptionalHIPStreamGuardMasqueradingAsCUDA(optional<Stream> stream_opt) : guard_(stream_opt) {}
                                                                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:696:5: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::initialize<c10::Stream &>' requested here
    initialize(std::forward<Args>(args)...);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:146:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::emplace<c10::Stream &>' requested here
      guard_.emplace(stream_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:291:84: note: in instantiation of member function 'c10::impl::InlineOptionalStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineOptionalStreamGuard' requested here
  explicit OptionalHIPStreamGuardMasqueradingAsCUDA(optional<Stream> stream_opt) : guard_(stream_opt) {}
                                                                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:580:38: note: in instantiation of template type alias 'OptionalBase' requested here
    return detail_::static_addressof(OptionalBase<T>::storage_.value_);
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:731:60: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::dataptr' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), dataptr());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:178:53: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::operator->' requested here
    return guard_.has_value() ? make_optional(guard_->original_stream())
                                                    ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:301:21: note: in instantiation of member function 'c10::impl::InlineOptionalStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::original_stream' requested here
    auto r = guard_.original_stream();
                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:206:12: note: in instantiation of member function 'c10::optional<c10::hip::HIPGuardImplMasqueradingAsCUDA>::optional' requested here
  explicit InlineMultiStreamGuard(ArrayRef<Stream> streams) {
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:326:7: note: in instantiation of member function 'c10::impl::InlineMultiStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineMultiStreamGuard' requested here
    : guard_(unwrapStreams(streams)) {}
      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:735:12: note: in instantiation of member function 'c10::optional<c10::hip::HIPGuardImplMasqueradingAsCUDA>::initialized' requested here
    assert(initialized());
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:211:48: note: in instantiation of member function 'c10::optional<c10::hip::HIPGuardImplMasqueradingAsCUDA>::operator->' requested here
        original_streams_.push_back(this->impl_->exchangeStream(s));
                                               ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:326:7: note: in instantiation of member function 'c10::impl::InlineMultiStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineMultiStreamGuard' requested here
    : guard_(unwrapStreams(streams)) {}
      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:596:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(false);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:695:5: note: in instantiation of member function 'c10::optional<c10::hip::HIPGuardImplMasqueradingAsCUDA>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:208:13: note: in instantiation of function template specialization 'c10::optional<c10::hip::HIPGuardImplMasqueradingAsCUDA>::emplace<c10::DeviceType>' requested here
      impl_.emplace(getDeviceTypeOfStreams(streams));
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:326:7: note: in instantiation of member function 'c10::impl::InlineMultiStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineMultiStreamGuard' requested here
    : guard_(unwrapStreams(streams)) {}
      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:696:5: note: in instantiation of function template specialization 'c10::optional<c10::hip::HIPGuardImplMasqueradingAsCUDA>::initialize<c10::DeviceType>' requested here
    initialize(std::forward<Args>(args)...);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:208:13: note: in instantiation of function template specialization 'c10::optional<c10::hip::HIPGuardImplMasqueradingAsCUDA>::emplace<c10::DeviceType>' requested here
      impl_.emplace(getDeviceTypeOfStreams(streams));
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:326:7: note: in instantiation of member function 'c10::impl::InlineMultiStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineMultiStreamGuard' requested here
    : guard_(unwrapStreams(streams)) {}
      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:736:12: note: in instantiation of member function 'c10::optional<c10::hip::HIPGuardImplMasqueradingAsCUDA>::dataptr' requested here
    return dataptr();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:326:7: note: in instantiation of member function 'c10::impl::InlineMultiStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineMultiStreamGuard' requested here
    : guard_(unwrapStreams(streams)) {}
      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:736:12: note: in instantiation of member function 'c10::optional<at::Tensor>::dataptr' requested here
    return dataptr();
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:5:
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1470:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
    hipDeviceSynchronize();
    ^~~~~~~~~~~~~~~~~~~~
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:83:18: note: in instantiation of function template specialization 'launch_attention_kernel<16U, 16U>' requested here
        case 16: LAUNCH_WITH_ARGS(16, 16); break;
                 ^
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:8:5: note: expanded from macro 'LAUNCH_WITH_ARGS'
    launch_attention_kernel<head_dim, chunk_size>(                          \
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:5:
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1470:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
    hipDeviceSynchronize();
    ^~~~~~~~~~~~~~~~~~~~
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:84:18: note: in instantiation of function template specialization 'launch_attention_kernel<16U, 32U>' requested here
        case 32: LAUNCH_WITH_ARGS(16, 32); break;
                 ^
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:8:5: note: expanded from macro 'LAUNCH_WITH_ARGS'
    launch_attention_kernel<head_dim, chunk_size>(                          \
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:5:
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1470:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
    hipDeviceSynchronize();
    ^~~~~~~~~~~~~~~~~~~~
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:91:18: note: in instantiation of function template specialization 'launch_attention_kernel<32U, 16U>' requested here
        case 16: LAUNCH_WITH_ARGS(32, 16); break;
                 ^
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:8:5: note: expanded from macro 'LAUNCH_WITH_ARGS'
    launch_attention_kernel<head_dim, chunk_size>(                          \
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:5:
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1470:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
    hipDeviceSynchronize();
    ^~~~~~~~~~~~~~~~~~~~
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:92:18: note: in instantiation of function template specialization 'launch_attention_kernel<32U, 32U>' requested here
        case 32: LAUNCH_WITH_ARGS(32, 32); break;
                 ^
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:8:5: note: expanded from macro 'LAUNCH_WITH_ARGS'
    launch_attention_kernel<head_dim, chunk_size>(                          \
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:5:
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1470:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
    hipDeviceSynchronize();
    ^~~~~~~~~~~~~~~~~~~~
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:93:18: note: in instantiation of function template specialization 'launch_attention_kernel<32U, 64U>' requested here
        case 64: LAUNCH_WITH_ARGS(32, 64); break;
                 ^
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:8:5: note: expanded from macro 'LAUNCH_WITH_ARGS'
    launch_attention_kernel<head_dim, chunk_size>(                          \
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:5:
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1470:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
    hipDeviceSynchronize();
    ^~~~~~~~~~~~~~~~~~~~
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:100:18: note: in instantiation of function template specialization 'launch_attention_kernel<64U, 16U>' requested here
        case 16: LAUNCH_WITH_ARGS(64, 16); break;
                 ^
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:8:5: note: expanded from macro 'LAUNCH_WITH_ARGS'
    launch_attention_kernel<head_dim, chunk_size>(                          \
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:5:
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1470:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
    hipDeviceSynchronize();
    ^~~~~~~~~~~~~~~~~~~~
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:101:18: note: in instantiation of function template specialization 'launch_attention_kernel<64U, 32U>' requested here
        case 32: LAUNCH_WITH_ARGS(64, 32); break;
                 ^
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:8:5: note: expanded from macro 'LAUNCH_WITH_ARGS'
    launch_attention_kernel<head_dim, chunk_size>(                          \
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:5:
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1470:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
    hipDeviceSynchronize();
    ^~~~~~~~~~~~~~~~~~~~
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:102:18: note: in instantiation of function template specialization 'launch_attention_kernel<64U, 64U>' requested here
        case 64: LAUNCH_WITH_ARGS(64, 64); break;
                 ^
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:8:5: note: expanded from macro 'LAUNCH_WITH_ARGS'
    launch_attention_kernel<head_dim, chunk_size>(                          \
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:5:
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1470:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
    hipDeviceSynchronize();
    ^~~~~~~~~~~~~~~~~~~~
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:103:19: note: in instantiation of function template specialization 'launch_attention_kernel<64U, 128U>' requested here
        case 128: LAUNCH_WITH_ARGS(64, 128); break;
                  ^
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:8:5: note: expanded from macro 'LAUNCH_WITH_ARGS'
    launch_attention_kernel<head_dim, chunk_size>(                          \
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:5:
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1470:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
    hipDeviceSynchronize();
    ^~~~~~~~~~~~~~~~~~~~
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:110:18: note: in instantiation of function template specialization 'launch_attention_kernel<128U, 16U>' requested here
        case 16: LAUNCH_WITH_ARGS(128, 16); break;
                 ^
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:8:5: note: expanded from macro 'LAUNCH_WITH_ARGS'
    launch_attention_kernel<head_dim, chunk_size>(                          \
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:5:
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1470:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
    hipDeviceSynchronize();
    ^~~~~~~~~~~~~~~~~~~~
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:111:18: note: in instantiation of function template specialization 'launch_attention_kernel<128U, 32U>' requested here
        case 32: LAUNCH_WITH_ARGS(128, 32); break;
                 ^
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:8:5: note: expanded from macro 'LAUNCH_WITH_ARGS'
    launch_attention_kernel<head_dim, chunk_size>(                          \
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:5:
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1470:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
    hipDeviceSynchronize();
    ^~~~~~~~~~~~~~~~~~~~
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:112:18: note: in instantiation of function template specialization 'launch_attention_kernel<128U, 64U>' requested here
        case 64: LAUNCH_WITH_ARGS(128, 64); break;
                 ^
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:8:5: note: expanded from macro 'LAUNCH_WITH_ARGS'
    launch_attention_kernel<head_dim, chunk_size>(                          \
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:5:
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1470:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
    hipDeviceSynchronize();
    ^~~~~~~~~~~~~~~~~~~~
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:113:19: note: in instantiation of function template specialization 'launch_attention_kernel<128U, 128U>' requested here
        case 128: LAUNCH_WITH_ARGS(128, 128); break;
                  ^
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:8:5: note: expanded from macro 'LAUNCH_WITH_ARGS'
    launch_attention_kernel<head_dim, chunk_size>(                          \
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:596:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(false);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:695:5: note: in instantiation of member function 'c10::optional<at::Tensor>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/pybind11/stl.h:285:15: note: in instantiation of function template specialization 'c10::optional<at::Tensor>::emplace<at::Tensor>' requested here
        value.emplace(cast_op<typename T::value_type &&>(std::move(inner_caster)));
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/pybind11/cast.h:2030:47: note: in instantiation of member function 'pybind11::detail::optional_caster<c10::optional<at::Tensor>>::load' requested here
        if ((... || !std::get<Is>(argcasters).load(call.args[Is], call.args_convert[Is])))
                                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/pybind11/cast.h:2009:16: note: in instantiation of function template specialization 'pybind11::detail::argument_loader<int, int, at::Tensor, at::Tensor, at::Tensor, c10::optional<at::Tensor>>::load_impl_sequence<0UL, 1UL, 2UL, 3UL, 4UL, 5UL>' requested here
        return load_impl_sequence(call, indices{});
               ^
/opt/conda/lib/python3.8/site-packages/torch/include/pybind11/pybind11.h:174:33: note: in instantiation of member function 'pybind11::detail::argument_loader<int, int, at::Tensor, at::Tensor, at::Tensor, c10::optional<at::Tensor>>::load_args' requested here
            if (!args_converter.load_args(call))
                                ^
/opt/conda/lib/python3.8/site-packages/torch/include/pybind11/pybind11.h:70:9: note: in instantiation of function template specialization 'pybind11::cpp_function::initialize<at::Tensor (*&)(int, int, at::Tensor, at::Tensor, at::Tensor, c10::optional<at::Tensor>), at::Tensor, int, int, at::Tensor, at::Tensor, at::Tensor, c10::optional<at::Tensor>, pybind11::name, pybind11::scope, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg_v, char[26]>' requested here
        initialize(f, f, extra...);
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/pybind11/pybind11.h:962:22: note: in instantiation of function template specialization 'pybind11::cpp_function::cpp_function<at::Tensor, int, int, at::Tensor, at::Tensor, at::Tensor, c10::optional<at::Tensor>, pybind11::name, pybind11::scope, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg_v, char[26]>' requested here
        cpp_function func(std::forward<Func>(f), name(name_), scope(*this),
                     ^
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:127:7: note: in instantiation of function template specialization 'pybind11::module_::def<at::Tensor (*)(int, int, at::Tensor, at::Tensor, at::Tensor, c10::optional<at::Tensor>), pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg_v, char[26]>' requested here
    m.def("attention_forward",
      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:696:5: note: in instantiation of function template specialization 'c10::optional<at::Tensor>::initialize<at::Tensor>' requested here
    initialize(std::forward<Args>(args)...);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/pybind11/stl.h:285:15: note: in instantiation of function template specialization 'c10::optional<at::Tensor>::emplace<at::Tensor>' requested here
        value.emplace(cast_op<typename T::value_type &&>(std::move(inner_caster)));
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/pybind11/cast.h:2030:47: note: in instantiation of member function 'pybind11::detail::optional_caster<c10::optional<at::Tensor>>::load' requested here
        if ((... || !std::get<Is>(argcasters).load(call.args[Is], call.args_convert[Is])))
                                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/pybind11/cast.h:2009:16: note: in instantiation of function template specialization 'pybind11::detail::argument_loader<int, int, at::Tensor, at::Tensor, at::Tensor, c10::optional<at::Tensor>>::load_impl_sequence<0UL, 1UL, 2UL, 3UL, 4UL, 5UL>' requested here
        return load_impl_sequence(call, indices{});
               ^
/opt/conda/lib/python3.8/site-packages/torch/include/pybind11/pybind11.h:174:33: note: in instantiation of member function 'pybind11::detail::argument_loader<int, int, at::Tensor, at::Tensor, at::Tensor, c10::optional<at::Tensor>>::load_args' requested here
            if (!args_converter.load_args(call))
                                ^
/opt/conda/lib/python3.8/site-packages/torch/include/pybind11/pybind11.h:70:9: note: in instantiation of function template specialization 'pybind11::cpp_function::initialize<at::Tensor (*&)(int, int, at::Tensor, at::Tensor, at::Tensor, c10::optional<at::Tensor>), at::Tensor, int, int, at::Tensor, at::Tensor, at::Tensor, c10::optional<at::Tensor>, pybind11::name, pybind11::scope, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg_v, char[26]>' requested here
        initialize(f, f, extra...);
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/pybind11/pybind11.h:962:22: note: in instantiation of function template specialization 'pybind11::cpp_function::cpp_function<at::Tensor, int, int, at::Tensor, at::Tensor, at::Tensor, c10::optional<at::Tensor>, pybind11::name, pybind11::scope, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg_v, char[26]>' requested here
        cpp_function func(std::forward<Func>(f), name(name_), scope(*this),
                     ^
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:127:7: note: in instantiation of function template specialization 'pybind11::module_::def<at::Tensor (*)(int, int, at::Tensor, at::Tensor, at::Tensor, c10::optional<at::Tensor>), pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg_v, char[26]>' requested here
    m.def("attention_forward",
      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:5:
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1073:28: warning: loop not unrolled: the optimizer was unable to perform the requested transformation; the transformation might be disabled or specified as part of an unsupported transformation ordering [-Wpass-failed=transform-warning]
__launch_bounds__(64) void attention_kernel(
                           ^
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1073:28: warning: loop not unrolled: the optimizer was unable to perform the requested transformation; the transformation might be disabled or specified as part of an unsupported transformation ordering [-Wpass-failed=transform-warning]
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1073:28: warning: loop not unrolled: the optimizer was unable to perform the requested transformation; the transformation might be disabled or specified as part of an unsupported transformation ordering [-Wpass-failed=transform-warning]
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1073:28: warning: loop not unrolled: the optimizer was unable to perform the requested transformation; the transformation might be disabled or specified as part of an unsupported transformation ordering [-Wpass-failed=transform-warning]
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1073:28: warning: loop not unrolled: the optimizer was unable to perform the requested transformation; the transformation might be disabled or specified as part of an unsupported transformation ordering [-Wpass-failed=transform-warning]
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1073:28: warning: loop not unrolled: the optimizer was unable to perform the requested transformation; the transformation might be disabled or specified as part of an unsupported transformation ordering [-Wpass-failed=transform-warning]
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1073:28: warning: loop not unrolled: the optimizer was unable to perform the requested transformation; the transformation might be disabled or specified as part of an unsupported transformation ordering [-Wpass-failed=transform-warning]
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1073:28: warning: loop not unrolled: the optimizer was unable to perform the requested transformation; the transformation might be disabled or specified as part of an unsupported transformation ordering [-Wpass-failed=transform-warning]
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1073:28: warning: loop not unrolled: the optimizer was unable to perform the requested transformation; the transformation might be disabled or specified as part of an unsupported transformation ordering [-Wpass-failed=transform-warning]
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1073:28: warning: loop not unrolled: the optimizer was unable to perform the requested transformation; the transformation might be disabled or specified as part of an unsupported transformation ordering [-Wpass-failed=transform-warning]
604 warnings generated when compiling for gfx90a.
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
/opt/rocm/hip/include/hip/hip_runtime.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:59:
/opt/rocm/hip/include/hip/hip_common.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
/opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:32:
/opt/rocm/hip/include/hip/amd_detail/amd_hip_common.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:105:
/opt/rocm/hip/include/hip/hip_runtime_api.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:105:
In file included from /opt/rocm/hip/include/hip/hip_runtime_api.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime_api.h:480:
/opt/rocm/hip/include/hip/amd_detail/host_defines.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:105:
In file included from /opt/rocm/hip/include/hip/hip_runtime_api.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime_api.h:481:
/opt/rocm/hip/include/hip/driver_types.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:105:
In file included from /opt/rocm/hip/include/hip/hip_runtime_api.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime_api.h:482:
/opt/rocm/hip/include/hip/texture_types.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:105:
In file included from /opt/rocm/hip/include/hip/hip_runtime_api.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime_api.h:482:
In file included from /opt/rocm/hip/include/hip/texture_types.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/texture_types.h:38:
/opt/rocm/hip/include/hip/channel_descriptor.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:105:
In file included from /opt/rocm/hip/include/hip/hip_runtime_api.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime_api.h:482:
In file included from /opt/rocm/hip/include/hip/texture_types.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/texture_types.h:38:
In file included from /opt/rocm/hip/include/hip/channel_descriptor.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/channel_descriptor.h:32:
/opt/rocm/hip/include/hip/amd_detail/amd_channel_descriptor.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:105:
In file included from /opt/rocm/hip/include/hip/hip_runtime_api.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime_api.h:482:
In file included from /opt/rocm/hip/include/hip/texture_types.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/texture_types.h:38:
In file included from /opt/rocm/hip/include/hip/channel_descriptor.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/channel_descriptor.h:32:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_channel_descriptor.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_channel_descriptor.h:28:
/opt/rocm/hip/include/hip/amd_detail/amd_hip_vector_types.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:105:
In file included from /opt/rocm/hip/include/hip/hip_runtime_api.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime_api.h:483:
/opt/rocm/hip/include/hip/surface_types.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:105:
In file included from /opt/rocm/hip/include/hip/hip_runtime_api.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime_api.h:6964:
/opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime_pt_api.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:110:
/opt/rocm/hip/include/hip/amd_detail/hip_ldg.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:112:
/opt/rocm/hip/include/hip/amd_detail/amd_hip_atomic.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:112:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_atomic.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_atomic.h:25:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_device_functions.h:34:
/opt/rocm/hip/include/hip/hip_vector_types.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:112:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_atomic.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_atomic.h:25:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_device_functions.h:35:
/opt/rocm/hip/include/hip/amd_detail/device_library_decls.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:112:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_atomic.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_atomic.h:25:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_device_functions.h:36:
/opt/rocm/hip/include/hip/amd_detail/llvm_intrinsics.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:114:
/opt/rocm/hip/include/hip/amd_detail/amd_device_functions.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:115:
/opt/rocm/hip/include/hip/amd_detail/amd_surface_functions.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:115:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_surface_functions.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_surface_functions.h:30:
/opt/rocm/hip/include/hip/amd_detail/ockl_image.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:116:
/opt/rocm/hip/include/hip/amd_detail/texture_fetch_functions.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:116:
In file included from /opt/rocm/hip/include/hip/amd_detail/texture_fetch_functions.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/texture_fetch_functions.h:28:
/opt/rocm/hip/include/hip/hip_texture_types.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:117:
/opt/rocm/hip/include/hip/amd_detail/texture_indirect_functions.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
/opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:322:16: warning: attribute declaration must precede definition [-Wignored-attributes]
__attribute__((weak))
               ^
/opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:312:24: note: previous definition is here
  static constexpr __X x{};
                       ^
/opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:327:16: warning: attribute declaration must precede definition [-Wignored-attributes]
__attribute__((weak))
               ^
/opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:313:24: note: previous definition is here
  static constexpr __Y y{};
                       ^
/opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:332:16: warning: attribute declaration must precede definition [-Wignored-attributes]
__attribute__((weak))
               ^
/opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:314:24: note: previous definition is here
  static constexpr __Z z{};
                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:62:
In file included from /opt/rocm/hip/include/hip/amd_detail/amd_hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/amd_detail/../../../../include/hip/amd_detail/amd_hip_runtime.h:399:
/opt/rocm/hip/include/hip/amd_detail/amd_math_functions.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:7:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Allocator.h:6:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Device.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceType.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:253:
In file included from /opt/rocm/hip/include/hip/hip_runtime.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_runtime.h:114:
/opt/rocm/hip/include/hip/library_types.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Storage.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StorageImpl.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarType.h:5:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Half.h:45:
/opt/rocm/hip/include/hip/hip_fp16.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/Storage.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StorageImpl.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarType.h:5:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Half.h:45:
In file included from /opt/rocm/hip/include/hip/hip_fp16.h:26:
In file included from /opt/rocm/hip/include/hip/../../../include/hip/hip_fp16.h:29:
/opt/rocm/hip/include/hip/amd_detail/amd_hip_fp16.h:25:9: warning: This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path [-W#pragma-messages]
#pragma message("This file is deprecated. Use header files from HIP_PATH/include, where HIP_PATH corresponds to HIP install path")
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:580:38: note: in instantiation of template type alias 'OptionalBase' requested here
    return detail_::static_addressof(OptionalBase<T>::storage_.value_);
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:587:22: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::move(OptionalBase<T>::storage_.value_);
                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:596:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(false);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:612:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:648:40: note: in instantiation of template type alias 'OptionalBase' requested here
  explicit constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                                       ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:652:9: note: in instantiation of template type alias 'OptionalBase' requested here
      : OptionalBase<T>(in_place_t{}, constexpr_forward<Args>(args)...) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:662:9: note: in instantiation of template type alias 'OptionalBase' requested here
      : OptionalBase<T>(in_place_t{}, il, constexpr_forward<Args>(args)...) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:30:40: note: in instantiation of template class 'c10::optional<c10::ScalarType>' requested here
static inline optional<at::ScalarType> optTypeMetaToScalarType(
                                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:30:40: note: in instantiation of template class 'c10::optional<c10::ScalarType>' requested here
static inline optional<at::ScalarType> optTypeMetaToScalarType(
                                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:31:32: note: in instantiation of template class 'c10::optional<caffe2::TypeMeta>' requested here
    optional<caffe2::TypeMeta> type_meta) {
                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:31:32: note: in instantiation of template class 'c10::optional<caffe2::TypeMeta>' requested here
    optional<caffe2::TypeMeta> type_meta) {
                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<caffe2::TypeMeta>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:32:18: note: in instantiation of member function 'c10::optional<caffe2::TypeMeta>::has_value' requested here
  if (!type_meta.has_value()) {
                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:33:12: note: in instantiation of member function 'c10::optional<c10::ScalarType>::optional' requested here
    return c10::nullopt;
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:35:10: note: in instantiation of function template specialization 'c10::optional<c10::ScalarType>::optional<c10::ScalarType, false>' requested here
  return type_meta->toScalarType();
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<c10::ScalarType>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:796:12: note: in instantiation of member function 'c10::optional<c10::ScalarType>::has_value' requested here
  return v.has_value() ? *v : detail_::convert<T>(std::forward<F>(func)());
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:28:10: note: in instantiation of function template specialization 'c10::value_or_else<c10::ScalarType, (lambda at /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:28:31)>' requested here
  return value_or_else(dtype, [] { return get_default_dtype_as_scalartype(); });
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<c10::ScalarType>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:796:26: note: in instantiation of member function 'c10::optional<c10::ScalarType>::operator*' requested here
  return v.has_value() ? *v : detail_::convert<T>(std::forward<F>(func)());
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:28:10: note: in instantiation of function template specialization 'c10::value_or_else<c10::ScalarType, (lambda at /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:28:31)>' requested here
  return value_or_else(dtype, [] { return get_default_dtype_as_scalartype(); });
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<caffe2::TypeMeta>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:796:26: note: in instantiation of member function 'c10::optional<caffe2::TypeMeta>::operator*' requested here
  return v.has_value() ? *v : detail_::convert<T>(std::forward<F>(func)());
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:33:10: note: in instantiation of function template specialization 'c10::value_or_else<caffe2::TypeMeta, (lambda at /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:33:31)>' requested here
  return value_or_else(dtype, [] { return get_default_dtype(); });
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:36:55: note: in instantiation of template class 'c10::optional<c10::Layout>' requested here
inline Layout layout_or_default(c10::optional<Layout> layout) {
                                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:36:55: note: in instantiation of template class 'c10::optional<c10::Layout>' requested here
inline Layout layout_or_default(c10::optional<Layout> layout) {
                                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:45: note: in instantiation of member function 'c10::optional<c10::Layout>::initialized' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:773:20: note: in instantiation of member function 'c10::optional<c10::Layout>::operator*' requested here
    return *this ? **this : detail_::convert<T>(constexpr_forward<V>(v));
                   ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:37:17: note: in instantiation of function template specialization 'c10::optional<c10::Layout>::value_or<const c10::Layout &>' requested here
  return layout.value_or(kStrided);
                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<c10::Layout>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:773:20: note: in instantiation of member function 'c10::optional<c10::Layout>::operator*' requested here
    return *this ? **this : detail_::convert<T>(constexpr_forward<V>(v));
                   ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:37:17: note: in instantiation of function template specialization 'c10::optional<c10::Layout>::value_or<const c10::Layout &>' requested here
  return layout.value_or(kStrided);
                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:40:55: note: in instantiation of template class 'c10::optional<c10::Device>' requested here
inline Device device_or_default(c10::optional<Device> device) {
                                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:40:55: note: in instantiation of template class 'c10::optional<c10::Device>' requested here
inline Device device_or_default(c10::optional<Device> device) {
                                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<c10::Device>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:796:12: note: in instantiation of member function 'c10::optional<c10::Device>::has_value' requested here
  return v.has_value() ? *v : detail_::convert<T>(std::forward<F>(func)());
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:41:10: note: in instantiation of function template specialization 'c10::value_or_else<c10::Device, (lambda at /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:41:32)>' requested here
  return value_or_else(device, [] { return Device(kCPU); });
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<c10::Device>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:796:26: note: in instantiation of member function 'c10::optional<c10::Device>::operator*' requested here
  return v.has_value() ? *v : detail_::convert<T>(std::forward<F>(func)());
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:41:10: note: in instantiation of function template specialization 'c10::value_or_else<c10::Device, (lambda at /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:41:32)>' requested here
  return value_or_else(device, [] { return Device(kCPU); });
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:44:58: note: in instantiation of template class 'c10::optional<bool>' requested here
inline bool pinned_memory_or_default(c10::optional<bool> pinned_memory) {
                                                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:44:58: note: in instantiation of template class 'c10::optional<bool>' requested here
inline bool pinned_memory_or_default(c10::optional<bool> pinned_memory) {
                                                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:45: note: in instantiation of member function 'c10::optional<bool>::initialized' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:773:20: note: in instantiation of member function 'c10::optional<bool>::operator*' requested here
    return *this ? **this : detail_::convert<T>(constexpr_forward<V>(v));
                   ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:45:24: note: in instantiation of function template specialization 'c10::optional<bool>::value_or<bool>' requested here
  return pinned_memory.value_or(false);
                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<bool>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:773:20: note: in instantiation of member function 'c10::optional<bool>::operator*' requested here
    return *this ? **this : detail_::convert<T>(constexpr_forward<V>(v));
                   ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:45:24: note: in instantiation of function template specialization 'c10::optional<bool>::value_or<bool>' requested here
  return pinned_memory.value_or(false);
                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:148:22: note: in instantiation of function template specialization 'c10::optional<c10::Layout>::optional<c10::Layout &, false>' requested here
    this->set_layout(layout);
                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:177:21: note: in instantiation of function template specialization 'c10::optional<caffe2::TypeMeta>::optional<caffe2::TypeMeta &, false>' requested here
    this->set_dtype(dtype);
                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:182:21: note: in instantiation of function template specialization 'c10::optional<c10::ScalarType>::optional<c10::ScalarType &, false>' requested here
    this->set_dtype(dtype);
                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:187:23: note: in instantiation of template class 'c10::optional<c10::MemoryFormat>' requested here
    set_memory_format(memory_format);
                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:187:23: note: in instantiation of template class 'c10::optional<c10::MemoryFormat>' requested here
    set_memory_format(memory_format);
                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:187:23: note: in instantiation of function template specialization 'c10::optional<c10::MemoryFormat>::optional<c10::MemoryFormat &, false>' requested here
    set_memory_format(memory_format);
                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:1215:10: note: in instantiation of function template specialization 'c10::optional<c10::Device>::optional<const c10::Device &, false>' requested here
  return optional<typename std::decay<T>::type>(constexpr_forward<T>(v));
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:287:31: note: in instantiation of function template specialization 'c10::make_optional<const c10::Device &>' requested here
    return has_device_ ? c10::make_optional(device_) : c10::nullopt;
                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:287:56: note: in instantiation of member function 'c10::optional<c10::Device>::optional' requested here
    return has_device_ ? c10::make_optional(device_) : c10::nullopt;
                                                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:1215:10: note: in instantiation of function template specialization 'c10::optional<caffe2::TypeMeta>::optional<const caffe2::TypeMeta &, false>' requested here
  return optional<typename std::decay<T>::type>(constexpr_forward<T>(v));
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:308:30: note: in instantiation of function template specialization 'c10::make_optional<const caffe2::TypeMeta &>' requested here
    return has_dtype_ ? c10::make_optional(dtype_) : c10::nullopt;
                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:308:54: note: in instantiation of member function 'c10::optional<caffe2::TypeMeta>::optional' requested here
    return has_dtype_ ? c10::make_optional(dtype_) : c10::nullopt;
                                                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:1215:10: note: in instantiation of function template specialization 'c10::optional<c10::Layout>::optional<const c10::Layout &, false>' requested here
  return optional<typename std::decay<T>::type>(constexpr_forward<T>(v));
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:324:31: note: in instantiation of function template specialization 'c10::make_optional<const c10::Layout &>' requested here
    return has_layout_ ? c10::make_optional(layout_) : c10::nullopt;
                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:324:56: note: in instantiation of member function 'c10::optional<c10::Layout>::optional' requested here
    return has_layout_ ? c10::make_optional(layout_) : c10::nullopt;
                                                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:1215:10: note: in instantiation of function template specialization 'c10::optional<bool>::optional<const bool &, false>' requested here
  return optional<typename std::decay<T>::type>(constexpr_forward<T>(v));
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:340:38: note: in instantiation of function template specialization 'c10::make_optional<const bool &>' requested here
    return has_requires_grad_ ? c10::make_optional(requires_grad_)
                                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:341:33: note: in instantiation of member function 'c10::optional<bool>::optional' requested here
                              : c10::nullopt;
                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:1215:10: note: in instantiation of function template specialization 'c10::optional<c10::MemoryFormat>::optional<const c10::MemoryFormat &, false>' requested here
  return optional<typename std::decay<T>::type>(constexpr_forward<T>(v));
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:387:38: note: in instantiation of function template specialization 'c10::make_optional<const c10::MemoryFormat &>' requested here
    return has_memory_format_ ? c10::make_optional(memory_format_)
                                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:388:33: note: in instantiation of member function 'c10::optional<c10::MemoryFormat>::optional' requested here
                              : c10::nullopt;
                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<c10::MemoryFormat>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:429:32: note: in instantiation of member function 'c10::optional<c10::MemoryFormat>::has_value' requested here
    if (optional_memory_format.has_value()) {
                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<c10::MemoryFormat>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:430:32: note: in instantiation of member function 'c10::optional<c10::MemoryFormat>::operator*' requested here
      merged.set_memory_format(*optional_memory_format);
                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<c10::Device>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:460:17: note: in instantiation of member function 'c10::optional<c10::Device>::operator*' requested here
      device_ = *device;
                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<caffe2::TypeMeta>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:470:16: note: in instantiation of member function 'c10::optional<caffe2::TypeMeta>::operator*' requested here
      dtype_ = *dtype;
               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<c10::ScalarType>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:480:37: note: in instantiation of member function 'c10::optional<c10::ScalarType>::operator*' requested here
      dtype_ = scalarTypeToTypeMeta(*dtype);
                                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<c10::Layout>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:490:17: note: in instantiation of member function 'c10::optional<c10::Layout>::operator*' requested here
      layout_ = *layout;
                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<bool>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:500:24: note: in instantiation of member function 'c10::optional<bool>::operator*' requested here
      requires_grad_ = *requires_grad;
                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:573:32: note: in instantiation of function template specialization 'c10::optional<caffe2::TypeMeta>::optional<caffe2::TypeMeta, false>' requested here
  return TensorOptions().dtype(scalarTypeToTypeMeta(dtype));
                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:598:40: note: in instantiation of function template specialization 'c10::optional<bool>::optional<bool &, false>' requested here
  return TensorOptions().requires_grad(requires_grad);
                                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:828:15: note: in instantiation of function template specialization 'c10::optional<c10::Layout>::optional<c10::Layout, false>' requested here
      .layout(dispatchKeyToLayout(dispatch_key))
              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:1658:28: note: in instantiation of template class 'c10::optional<_object *>' requested here
  c10::optional<PyObject*> check_pyobj(impl::PyInterpreter* self_interpreter) {
                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:1658:28: note: in instantiation of template class 'c10::optional<_object *>' requested here
  c10::optional<PyObject*> check_pyobj(impl::PyInterpreter* self_interpreter) {
                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:1668:14: note: in instantiation of member function 'c10::optional<_object *>::optional' requested here
      return c10::nullopt;
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:1215:10: note: in instantiation of function template specialization 'c10::optional<_object *>::optional<_object *, false>' requested here
  return optional<typename std::decay<T>::type>(constexpr_forward<T>(v));
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:1671:19: note: in instantiation of function template specialization 'c10::make_optional<_object *>' requested here
      return c10::make_optional(_unchecked_untagged_pyobj());
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:146:60: note: in instantiation of template class 'c10::optional<at::Generator>' requested here
static inline T * check_generator(c10::optional<Generator> gen) {
                                                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:146:60: note: in instantiation of template class 'c10::optional<at::Generator>' requested here
static inline T * check_generator(c10::optional<Generator> gen) {
                                                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<at::Generator>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:147:19: note: in instantiation of member function 'c10::optional<at::Generator>::has_value' requested here
  TORCH_CHECK(gen.has_value(), "Expected Generator but received nullopt");
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:580:38: note: in instantiation of template type alias 'OptionalBase' requested here
    return detail_::static_addressof(OptionalBase<T>::storage_.value_);
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:731:60: note: in instantiation of member function 'c10::optional<at::Generator>::dataptr' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), dataptr());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:161:32: note: in instantiation of member function 'c10::optional<at::Generator>::operator->' requested here
  return gen.has_value() && gen->defined() ? check_generator<T>(gen) : check_generator<T>(default_gen);
                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/CPUGeneratorImpl.h:35:24: note: in instantiation of template class 'c10::optional<float>' requested here
  c10::optional<float> next_float_normal_sample_;
                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/CPUGeneratorImpl.h:35:24: note: in instantiation of template class 'c10::optional<float>' requested here
  c10::optional<float> next_float_normal_sample_;
                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/CPUGeneratorImpl.h:36:25: note: in instantiation of template class 'c10::optional<double>' requested here
  c10::optional<double> next_double_normal_sample_;
                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/CPUGeneratorImpl.h:36:25: note: in instantiation of template class 'c10::optional<double>' requested here
  c10::optional<double> next_double_normal_sample_;
                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/DeprecatedTypeProperties.h:128:91: note: in instantiation of member function 'c10::optional<c10::Device>::optional' requested here
  Tensor copy(const Tensor & src, bool non_blocking=false, c10::optional<Device> to_device={}) const;
                                                                                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:264:30: note: in instantiation of template class 'c10::optional<c10::QEngine>' requested here
  c10::optional<at::QEngine> quantized_engine = c10::nullopt;
                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:264:30: note: in instantiation of template class 'c10::optional<c10::QEngine>' requested here
  c10::optional<at::QEngine> quantized_engine = c10::nullopt;
                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:264:49: note: in instantiation of member function 'c10::optional<c10::QEngine>::optional' requested here
  c10::optional<at::QEngine> quantized_engine = c10::nullopt;
                                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:239:60: note: in instantiation of template class 'c10::optional<signed char>' requested here
  explicit InlineOptionalDeviceGuard(optional<DeviceIndex> device_index_opt)
                                                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:239:60: note: in instantiation of template class 'c10::optional<signed char>' requested here
  explicit InlineOptionalDeviceGuard(optional<DeviceIndex> device_index_opt)
                                                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<signed char>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:241:26: note: in instantiation of member function 'c10::optional<signed char>::has_value' requested here
    if (device_index_opt.has_value()) {
                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:761:11: note: in instantiation of member function 'c10::optional<signed char>::contained_val' requested here
        ? contained_val()
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:242:39: note: in instantiation of member function 'c10::optional<signed char>::value' requested here
      guard_.emplace(device_index_opt.value());
                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:427:34: note: in instantiation of template class 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>' requested here
  optional<InlineDeviceGuard<T>> guard_;
                                 ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceGuard.h:178:59: note: in instantiation of template class 'c10::impl::InlineOptionalDeviceGuard<c10::impl::VirtualGuardImpl>' requested here
  impl::InlineOptionalDeviceGuard<impl::VirtualGuardImpl> guard_;
                                                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:427:34: note: in instantiation of template class 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>' requested here
  optional<InlineDeviceGuard<T>> guard_;
                                 ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceGuard.h:178:59: note: in instantiation of template class 'c10::impl::InlineOptionalDeviceGuard<c10::impl::VirtualGuardImpl>' requested here
  impl::InlineOptionalDeviceGuard<impl::VirtualGuardImpl> guard_;
                                                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/OptionalArrayRef.h:208:25: note: in instantiation of template class 'c10::optional<c10::ArrayRef<long>>' requested here
  optional<ArrayRef<T>> wrapped_opt_array_ref;
                        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/OptionalArrayRef.h:216:10: note: in instantiation of template class 'c10::OptionalArrayRef<long>' requested here
  if (!a1.has_value()) {
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/OptionalArrayRef.h:208:25: note: in instantiation of template class 'c10::optional<c10::ArrayRef<long>>' requested here
  optional<ArrayRef<T>> wrapped_opt_array_ref;
                        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/OptionalArrayRef.h:216:10: note: in instantiation of template class 'c10::OptionalArrayRef<long>' requested here
  if (!a1.has_value()) {
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<c10::ArrayRef<long>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/OptionalArrayRef.h:148:34: note: in instantiation of member function 'c10::optional<c10::ArrayRef<long>>::has_value' requested here
    return wrapped_opt_array_ref.has_value();
                                 ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/OptionalArrayRef.h:216:11: note: in instantiation of member function 'c10::OptionalArrayRef<long>::has_value' requested here
  if (!a1.has_value()) {
          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:755:11: note: in instantiation of member function 'c10::optional<c10::ArrayRef<long>>::contained_val' requested here
        ? contained_val()
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/OptionalArrayRef.h:156:34: note: in instantiation of member function 'c10::optional<c10::ArrayRef<long>>::value' requested here
    return wrapped_opt_array_ref.value();
                                 ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/OptionalArrayRef.h:219:13: note: in instantiation of member function 'c10::OptionalArrayRef<long>::value' requested here
  return a1.value() == other;
            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBase.h:230:30: note: in instantiation of template class 'c10::optional<c10::ArrayRef<at::Dimname>>' requested here
  c10::optional<DimnameList> opt_names() const {
                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBase.h:230:30: note: in instantiation of template class 'c10::optional<c10::ArrayRef<at::Dimname>>' requested here
  c10::optional<DimnameList> opt_names() const {
                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBase.h:951:13: note: in instantiation of template class 'c10::optional<at::TensorBase>' requested here
  return opt.has_value()
            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBase.h:951:13: note: in instantiation of template class 'c10::optional<at::TensorBase>' requested here
  return opt.has_value()
            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<at::TensorBase>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBase.h:951:14: note: in instantiation of member function 'c10::optional<at::TensorBase>::has_value' requested here
  return opt.has_value()
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<at::TensorBase>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBase.h:952:45: note: in instantiation of member function 'c10::optional<at::TensorBase>::operator*' requested here
    ? c10::MaybeOwned<TensorBase>::borrowed(*opt)
                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:424:143: note: in instantiation of template class 'c10::optional<c10::ArrayRef<at::Tensor>>' requested here
  void backward(const Tensor & gradient={}, c10::optional<bool> retain_graph=c10::nullopt, bool create_graph=false, c10::optional<TensorList> inputs=c10::nullopt) const {
                                                                                                                                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:424:143: note: in instantiation of template class 'c10::optional<c10::ArrayRef<at::Tensor>>' requested here
  void backward(const Tensor & gradient={}, c10::optional<bool> retain_graph=c10::nullopt, bool create_graph=false, c10::optional<TensorList> inputs=c10::nullopt) const {
                                                                                                                                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:424:150: note: in instantiation of member function 'c10::optional<c10::ArrayRef<at::Tensor>>::optional' requested here
  void backward(const Tensor & gradient={}, c10::optional<bool> retain_graph=c10::nullopt, bool create_graph=false, c10::optional<TensorList> inputs=c10::nullopt) const {
                                                                                                                                                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:509:95: note: in instantiation of template class 'c10::optional<at::Tensor>' requested here
  void __dispatch__backward(at::TensorList inputs, const c10::optional<at::Tensor> & gradient={}, c10::optional<bool> retain_graph=c10::nullopt, bool create_graph=false) const;
                                                                                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:509:95: note: in instantiation of template class 'c10::optional<at::Tensor>' requested here
  void __dispatch__backward(at::TensorList inputs, const c10::optional<at::Tensor> & gradient={}, c10::optional<bool> retain_graph=c10::nullopt, bool create_graph=false) const;
                                                                                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:509:94: note: in instantiation of member function 'c10::optional<at::Tensor>::optional' requested here
  void __dispatch__backward(at::TensorList inputs, const c10::optional<at::Tensor> & gradient={}, c10::optional<bool> retain_graph=c10::nullopt, bool create_graph=false) const;
                                                                                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:558:44: note: in instantiation of template class 'c10::optional<long>' requested here
  at::Tensor argmax(c10::optional<int64_t> dim=c10::nullopt, bool keepdim=false) const;
                                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:558:44: note: in instantiation of template class 'c10::optional<long>' requested here
  at::Tensor argmax(c10::optional<int64_t> dim=c10::nullopt, bool keepdim=false) const;
                                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:558:48: note: in instantiation of member function 'c10::optional<long>::optional' requested here
  at::Tensor argmax(c10::optional<int64_t> dim=c10::nullopt, bool keepdim=false) const;
                                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:584:63: note: in instantiation of member function 'c10::optional<at::Generator>::optional' requested here
  at::Tensor bernoulli(c10::optional<at::Generator> generator=c10::nullopt) const;
                                                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:612:93: note: in instantiation of template class 'c10::optional<c10::Scalar>' requested here
  at::Tensor clamp(const c10::optional<at::Scalar> & min, const c10::optional<at::Scalar> & max=c10::nullopt) const;
                                                                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:612:93: note: in instantiation of template class 'c10::optional<c10::Scalar>' requested here
  at::Tensor clamp(const c10::optional<at::Scalar> & min, const c10::optional<at::Scalar> & max=c10::nullopt) const;
                                                                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:612:97: note: in instantiation of member function 'c10::optional<c10::Scalar>::optional' requested here
  at::Tensor clamp(const c10::optional<at::Scalar> & min, const c10::optional<at::Scalar> & max=c10::nullopt) const;
                                                                                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:706:97: note: in instantiation of member function 'c10::optional<c10::ArrayRef<at::Dimname>>::optional' requested here
  at::Tensor unflatten(int64_t dim, at::IntArrayRef sizes, c10::optional<at::DimnameList> names=c10::nullopt) const;
                                                                                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:746:51: note: in instantiation of member function 'c10::optional<double>::optional' requested here
  at::Tensor nan_to_num(c10::optional<double> nan=c10::nullopt, c10::optional<double> posinf=c10::nullopt, c10::optional<double> neginf=c10::nullopt) const;
                                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:1215:103: note: in instantiation of template class 'c10::optional<c10::ArrayRef<double>>' requested here
  ::std::tuple<at::Tensor,at::Tensor> histogram(int64_t bins=100, c10::optional<at::ArrayRef<double>> range=c10::nullopt, const c10::optional<at::Tensor> & weight={}, bool density=false) const;
                                                                                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:1215:103: note: in instantiation of template class 'c10::optional<c10::ArrayRef<double>>' requested here
  ::std::tuple<at::Tensor,at::Tensor> histogram(int64_t bins=100, c10::optional<at::ArrayRef<double>> range=c10::nullopt, const c10::optional<at::Tensor> & weight={}, bool density=false) const;
                                                                                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:1215:109: note: in instantiation of member function 'c10::optional<c10::ArrayRef<double>>::optional' requested here
  ::std::tuple<at::Tensor,at::Tensor> histogram(int64_t bins=100, c10::optional<at::ArrayRef<double>> range=c10::nullopt, const c10::optional<at::Tensor> & weight={}, bool density=false) const;
                                                                                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/OptionalArrayRef.h:26:13: note: in instantiation of member function 'c10::optional<c10::ArrayRef<long>>::optional' requested here
  constexpr OptionalArrayRef(nullopt_t) noexcept {}
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:1277:83: note: in instantiation of member function 'c10::OptionalArrayRef<long>::OptionalArrayRef' requested here
  at::Tensor to_padded_tensor(double padding, at::OptionalIntArrayRef output_size=c10::nullopt) const;
                                                                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<c10::ArrayRef<at::Tensor>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:429:16: note: in instantiation of member function 'c10::optional<c10::ArrayRef<at::Tensor>>::has_value' requested here
    if (inputs.has_value()) {
               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:761:11: note: in instantiation of member function 'c10::optional<c10::ArrayRef<at::Tensor>>::contained_val' requested here
        ? contained_val()
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:430:26: note: in instantiation of member function 'c10::optional<c10::ArrayRef<at::Tensor>>::value' requested here
      TORCH_CHECK(inputs.value().size() > 0, "'inputs' argument to backward cannot be empty")
                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:431:39: note: in instantiation of function template specialization 'c10::optional<at::Tensor>::optional<const at::Tensor &, false>' requested here
      this->_backward(inputs.value(), gradient, retain_graph, create_graph);
                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:2156:89: note: in instantiation of template class 'c10::optional<c10::basic_string_view<char>>' requested here
inline at::Tensor Tensor::div(const at::Tensor & other, c10::optional<c10::string_view> rounding_mode) const {
                                                                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:2156:89: note: in instantiation of template class 'c10::optional<c10::basic_string_view<char>>' requested here
inline at::Tensor Tensor::div(const at::Tensor & other, c10::optional<c10::string_view> rounding_mode) const {
                                                                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<at::Tensor>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:5347:14: note: in instantiation of member function 'c10::optional<at::Tensor>::has_value' requested here
  return opt.has_value()
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<at::Tensor>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/TensorBody.h:5348:41: note: in instantiation of member function 'c10::optional<at::Tensor>::operator*' requested here
    ? c10::MaybeOwned<Tensor>::borrowed(*opt)
                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:1215:10: note: in instantiation of function template specialization 'c10::optional<c10::Device>::optional<c10::Device, false>' requested here
  return optional<typename std::decay<T>::type>(constexpr_forward<T>(v));
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/DeviceGuard.h:19:17: note: in instantiation of function template specialization 'c10::make_optional<c10::Device>' requested here
    return c10::make_optional(t.device());
                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/ops/from_blob.h:83:36: note: in instantiation of member function 'c10::optional<long>::optional' requested here
  optional<int64_t> storage_offset_{};
                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/OptionalArrayRef.h:52:9: note: in instantiation of function template specialization 'c10::optional<c10::ArrayRef<long>>::optional<c10::ArrayRef<long> &, false>' requested here
      : wrapped_opt_array_ref(value) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/ops/from_blob.h:102:16: note: in instantiation of function template specialization 'c10::OptionalArrayRef<long>::OptionalArrayRef<c10::ArrayRef<long> &, false>' requested here
      .strides(strides)
               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/ops/_empty_affine_quantized.h:26:189: note: in instantiation of function template specialization 'c10::optional<c10::MemoryFormat>::optional<c10::MemoryFormat, false>' requested here
TORCH_API inline at::Tensor _empty_affine_quantized(at::IntArrayRef size, at::TensorOptions options={}, double scale=1, int64_t zero_point=0, c10::optional<at::MemoryFormat> memory_format=MemoryFormat::Contiguous) {
                                                                                                                                                                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/ops/fft_fft.h:26:154: note: in instantiation of member function 'c10::optional<c10::basic_string_view<char>>::optional' requested here
TORCH_API inline at::Tensor fft_fft(const at::Tensor & self, c10::optional<int64_t> n=c10::nullopt, int64_t dim=-1, c10::optional<c10::string_view> norm=c10::nullopt) {
                                                                                                                                                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/ops/from_file.h:26:135: note: in instantiation of function template specialization 'c10::optional<long>::optional<int, false>' requested here
TORCH_API inline at::Tensor from_file(c10::string_view filename, c10::optional<bool> shared=c10::nullopt, c10::optional<int64_t> size=0, at::TensorOptions options={}) {
                                                                                                                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/ScalarOps.h:33:50: note: in instantiation of function template specialization 'c10::optional<c10::ScalarType>::optional<const c10::ScalarType &, false>' requested here
      return at::detail::scalar_tensor_static(s, at::kDouble, at::kCPU);
                                                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/ScalarOps.h:33:63: note: in instantiation of function template specialization 'c10::optional<c10::Device>::optional<const c10::DeviceType &, false>' requested here
      return at::detail::scalar_tensor_static(s, at::kDouble, at::kCPU);
                                                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/TensorIterator.h:766:28: note: in instantiation of template class 'c10::optional<c10::SmallVector<long, 5>>' requested here
  c10::optional<DimVector> static_shape_ = c10::nullopt;
                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/TensorIterator.h:766:28: note: in instantiation of template class 'c10::optional<c10::SmallVector<long, 5>>' requested here
  c10::optional<DimVector> static_shape_ = c10::nullopt;
                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/TensorIterator.h:766:44: note: in instantiation of member function 'c10::optional<c10::SmallVector<long, 5>>::optional' requested here
  c10::optional<DimVector> static_shape_ = c10::nullopt;
                                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/ops/_cudnn_init_dropout_state_native.h:20:133: note: in instantiation of member function 'c10::optional<c10::ScalarType>::optional' requested here
TORCH_API at::Tensor _cudnn_init_dropout_state(double dropout, bool train, int64_t dropout_seed, c10::optional<at::ScalarType> dtype={}, c10::optional<at::Layout> layout={}, c10::optional<at::Device> device={}, c10::optional<bool> pin_memory={});
                                                                                                                                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/ops/_cudnn_init_dropout_state_native.h:20:170: note: in instantiation of member function 'c10::optional<c10::Layout>::optional' requested here
TORCH_API at::Tensor _cudnn_init_dropout_state(double dropout, bool train, int64_t dropout_seed, c10::optional<at::ScalarType> dtype={}, c10::optional<at::Layout> layout={}, c10::optional<at::Device> device={}, c10::optional<bool> pin_memory={});
                                                                                                                                                                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/ops/_cudnn_init_dropout_state_native.h:20:242: note: in instantiation of member function 'c10::optional<bool>::optional' requested here
TORCH_API at::Tensor _cudnn_init_dropout_state(double dropout, bool train, int64_t dropout_seed, c10::optional<at::ScalarType> dtype={}, c10::optional<at::Layout> layout={}, c10::optional<at::Device> device={}, c10::optional<bool> pin_memory={});
                                                                                                                                                                                                                                                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type_base.h:448:33: note: in instantiation of template class 'c10::optional<std::basic_string<char>>' requested here
      if (auto renamed = printer(*this)) {
                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type_base.h:448:33: note: in instantiation of template class 'c10::optional<std::basic_string<char>>' requested here
      if (auto renamed = printer(*this)) {
                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<std::basic_string<char>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type_base.h:448:16: note: in instantiation of member function 'c10::optional<std::basic_string<char>>::operator bool' requested here
      if (auto renamed = printer(*this)) {
               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<std::basic_string<char>>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type_base.h:449:16: note: in instantiation of member function 'c10::optional<std::basic_string<char>>::operator*' requested here
        return *renamed;
               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type_base.h:696:32: note: in instantiation of template class 'c10::optional<c10::QualifiedName>' requested here
  c10::optional<QualifiedName> name_;
                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type_base.h:696:32: note: in instantiation of template class 'c10::optional<c10::QualifiedName>' requested here
  c10::optional<QualifiedName> name_;
                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/dynamic_type.h:125:14: note: in instantiation of member function 'c10::optional<std::basic_string<char>>::optional' requested here
    explicit LabeledDynamicType(DynamicTypePtr t) : ty(std::move(t)) {}
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1338:63: note: in instantiation of template class 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>' requested here
  c10::optional<std::shared_ptr<torch::jit::CompilationUnit>> strong_ptr_;
                                                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1338:63: note: in instantiation of template class 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>' requested here
  c10::optional<std::shared_ptr<torch::jit::CompilationUnit>> strong_ptr_;
                                                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1339:61: note: in instantiation of template class 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>' requested here
  c10::optional<std::weak_ptr<torch::jit::CompilationUnit>> weak_ptr_;
                                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1339:61: note: in instantiation of template class 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>' requested here
  c10::optional<std::weak_ptr<torch::jit::CompilationUnit>> weak_ptr_;
                                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1312:12: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>::optional' requested here
  explicit WeakOrStrongCompilationUnit(
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1312:12: note: in instantiation of member function 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>::optional' requested here
  explicit WeakOrStrongCompilationUnit(
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:976:15: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>::operator bool' requested here
  return bool(x);
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1325:39: note: in instantiation of function template specialization 'c10::operator!=<std::shared_ptr<torch::jit::CompilationUnit>>' requested here
    TORCH_INTERNAL_ASSERT(strong_ptr_ != c10::nullopt);
                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1326:12: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>::operator*' requested here
    return *strong_ptr_;
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:976:15: note: in instantiation of member function 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>::operator bool' requested here
  return bool(x);
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1330:37: note: in instantiation of function template specialization 'c10::operator!=<std::weak_ptr<torch::jit::CompilationUnit>>' requested here
    TORCH_INTERNAL_ASSERT(weak_ptr_ != c10::nullopt);
                                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1331:12: note: in instantiation of member function 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>::operator*' requested here
    return *weak_ptr_;
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:288:25: note: in instantiation of template class 'c10::optional<unsigned long>' requested here
  c10::optional<size_t> stride_index_;
                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:288:25: note: in instantiation of template class 'c10::optional<unsigned long>' requested here
  c10::optional<size_t> stride_index_;
                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:272:3: note: in instantiation of member function 'c10::optional<unsigned long>::optional' requested here
  Stride() {}
  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<unsigned long>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:935:15: note: in instantiation of member function 'c10::optional<unsigned long>::operator bool' requested here
  return bool(x) != bool(y) ? false : bool(x) == false ? true : *x == *y;
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:280:26: note: in instantiation of function template specialization 'c10::operator==<unsigned long>' requested here
    return stride_index_ == b.stride_index_ && contiguous_ == b.contiguous_ &&
                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<unsigned long>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:935:65: note: in instantiation of member function 'c10::optional<unsigned long>::operator*' requested here
  return bool(x) != bool(y) ? false : bool(x) == false ? true : *x == *y;
                                                                ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:280:26: note: in instantiation of function template specialization 'c10::operator==<unsigned long>' requested here
    return stride_index_ == b.stride_index_ && contiguous_ == b.contiguous_ &&
                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:294:30: note: in instantiation of template class 'c10::optional<c10::Stride>' requested here
inline c10::optional<Stride> merge_primitive(
                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:294:30: note: in instantiation of template class 'c10::optional<c10::Stride>' requested here
inline c10::optional<Stride> merge_primitive(
                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<c10::Stride>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:299:13: note: in instantiation of member function 'c10::optional<c10::Stride>::has_value' requested here
  if (!left.has_value()) {
            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:314:12: note: in instantiation of member function 'c10::optional<c10::Stride>::optional' requested here
    return c10::optional<Stride>{};
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:317:10: note: in instantiation of function template specialization 'c10::optional<c10::Stride>::optional<c10::Stride, false>' requested here
  return r;
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:482:45: note: in instantiation of template class 'c10::optional<std::vector<c10::ShapeSymbol>>' requested here
    c10::optional<std::vector<ShapeSymbol>> dims_;
                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:482:45: note: in instantiation of template class 'c10::optional<std::vector<c10::ShapeSymbol>>' requested here
    c10::optional<std::vector<ShapeSymbol>> dims_;
                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:372:21: note: in instantiation of member function 'c10::optional<std::vector<c10::ShapeSymbol>>::optional' requested here
  SymbolicShape() : dims_(c10::nullopt) {}
                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<unsigned long>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:381:27: note: in instantiation of member function 'c10::optional<unsigned long>::operator*' requested here
    shape_symbols.reserve(*rank);
                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:389:3: note: in instantiation of member function 'c10::optional<std::vector<c10::ShapeSymbol>>::optional' requested here
  SymbolicShape(const std::vector<c10::optional<int64_t>>& dims) {
  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<long>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:393:11: note: in instantiation of member function 'c10::optional<long>::operator bool' requested here
      if(!dim) {
          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<long>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:396:61: note: in instantiation of member function 'c10::optional<long>::operator*' requested here
        shape_symbols.push_back(ShapeSymbol::fromStaticSize(*dim));
                                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:404:50: note: in instantiation of function template specialization 'c10::optional<std::vector<c10::ShapeSymbol>>::optional<std::vector<c10::ShapeSymbol>, false>' requested here
  SymbolicShape(std::vector<ShapeSymbol> dims) : dims_(std::move(dims)) {}
                                                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<std::vector<c10::ShapeSymbol>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:416:10: note: in instantiation of member function 'c10::optional<std::vector<c10::ShapeSymbol>>::operator bool' requested here
    if (!dims_) {
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<std::vector<c10::ShapeSymbol>>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:419:13: note: in instantiation of member function 'c10::optional<std::vector<c10::ShapeSymbol>>::operator*' requested here
    return (*dims_).at(i);
            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:432:14: note: in instantiation of member function 'c10::optional<unsigned long>::optional' requested here
      return c10::nullopt;
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:580:38: note: in instantiation of template type alias 'OptionalBase' requested here
    return detail_::static_addressof(OptionalBase<T>::storage_.value_);
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:731:60: note: in instantiation of member function 'c10::optional<std::vector<c10::ShapeSymbol>>::dataptr' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), dataptr());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:434:17: note: in instantiation of member function 'c10::optional<std::vector<c10::ShapeSymbol>>::operator->' requested here
    return dims_->size();
                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:434:12: note: in instantiation of function template specialization 'c10::optional<unsigned long>::optional<unsigned long, false>' requested here
    return dims_->size();
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:441:36: note: in instantiation of template class 'c10::optional<std::vector<bool>>' requested here
  c10::optional<std::vector<bool>> symbolicDims() const {
                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:441:36: note: in instantiation of template class 'c10::optional<std::vector<bool>>' requested here
  c10::optional<std::vector<bool>> symbolicDims() const {
                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:443:14: note: in instantiation of member function 'c10::optional<std::vector<bool>>::optional' requested here
      return c10::nullopt;
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:449:12: note: in instantiation of function template specialization 'c10::optional<std::vector<bool>>::optional<std::vector<bool>, false>' requested here
    return symbolic_dims;
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:513:44: note: in instantiation of function template specialization 'c10::optional<unsigned long>::optional<unsigned long &, false>' requested here
  VaryingShape(size_t size) : VaryingShape(c10::optional<size_t>(size)) {}
                                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:567:41: note: in instantiation of template class 'c10::optional<std::vector<c10::optional<c10::Stride>>>' requested here
  c10::optional<ListOfOptionalElements> dims_;
                                        ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:843:24: note: in instantiation of template class 'c10::VaryingShape<c10::Stride>' requested here
  VaryingShape<Stride> strides_;
                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:567:41: note: in instantiation of template class 'c10::optional<std::vector<c10::optional<c10::Stride>>>' requested here
  c10::optional<ListOfOptionalElements> dims_;
                                        ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:843:24: note: in instantiation of template class 'c10::VaryingShape<c10::Stride>' requested here
  VaryingShape<Stride> strides_;
                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:585:39: note: in instantiation of function template specialization 'c10::optional<bool>::optional<bool, false>' requested here
      c10::optional<bool> undefined = false,
                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:567:41: note: in instantiation of template class 'c10::optional<std::vector<c10::optional<long>>>' requested here
  c10::optional<ListOfOptionalElements> dims_;
                                        ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:613:12: note: in instantiation of template class 'c10::VaryingShape<long>' requested here
    return sizes().size();
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:567:41: note: in instantiation of template class 'c10::optional<std::vector<c10::optional<long>>>' requested here
  c10::optional<ListOfOptionalElements> dims_;
                                        ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:613:12: note: in instantiation of template class 'c10::VaryingShape<long>' requested here
    return sizes().size();
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:755:11: note: in instantiation of member function 'c10::optional<long>::contained_val' requested here
        ? contained_val()
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:658:24: note: in instantiation of member function 'c10::optional<long>::value' requested here
      prod *= shape[i].value();
                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:726:35: note: in instantiation of template class 'c10::optional<std::vector<long>>' requested here
    TORCH_INTERNAL_ASSERT(sizes().concrete_sizes().has_value());
                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:726:35: note: in instantiation of template class 'c10::optional<std::vector<long>>' requested here
    TORCH_INTERNAL_ASSERT(sizes().concrete_sizes().has_value());
                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<std::vector<long>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:726:52: note: in instantiation of member function 'c10::optional<std::vector<long>>::has_value' requested here
    TORCH_INTERNAL_ASSERT(sizes().concrete_sizes().has_value());
                                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:750:27: note: in instantiation of member function 'c10::optional<std::vector<long>>::contained_val' requested here
    return constexpr_move(contained_val());
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:728:9: note: in instantiation of member function 'c10::optional<std::vector<long>>::operator*' requested here
        *sizes().concrete_sizes(),
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:1121:9: note: in instantiation of member function 'c10::optional<c10::QualifiedName>::optional' requested here
        c10::nullopt,
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:754:12: note: in instantiation of member function 'c10::optional<c10::QualifiedName>::initialized' requested here
    return initialized()
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:1437:28: note: in instantiation of member function 'c10::optional<c10::QualifiedName>::value' requested here
    const auto& n = name().value();
                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:755:11: note: in instantiation of member function 'c10::optional<c10::QualifiedName>::contained_val' requested here
        ? contained_val()
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:1437:28: note: in instantiation of member function 'c10::optional<c10::QualifiedName>::value' requested here
    const auto& n = name().value();
                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:1985:41: note: in instantiation of function template specialization 'c10::optional<std::basic_string<char>>::optional<std::basic_string<char>, false>' requested here
  MatchTypeReturn(std::string reason) : reason_(std::move(reason)) {}
                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:755:11: note: in instantiation of member function 'c10::optional<std::basic_string<char>>::contained_val' requested here
        ? contained_val()
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:1993:20: note: in instantiation of member function 'c10::optional<std::basic_string<char>>::value' requested here
    return reason_.value();
                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:1998:5: note: in instantiation of member function 'c10::optional<std::basic_string<char>>::optional' requested here
  : reason_(c10::nullopt) {}
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:580:38: note: in instantiation of template type alias 'OptionalBase' requested here
    return detail_::static_addressof(OptionalBase<T>::storage_.value_);
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:731:60: note: in instantiation of member function 'c10::optional<c10::QualifiedName>::dataptr' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), dataptr());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:2041:50: note: in instantiation of member function 'c10::optional<c10::QualifiedName>::operator->' requested here
    return std::string("InterfaceType<") + name()->name() + ">";
                                                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:144:55: note: in instantiation of template class 'c10::optional<c10::Stream>' requested here
  explicit InlineOptionalStreamGuard(optional<Stream> stream_opt) : guard_() {
                                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:144:55: note: in instantiation of template class 'c10::optional<c10::Stream>' requested here
  explicit InlineOptionalStreamGuard(optional<Stream> stream_opt) : guard_() {
                                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<c10::Stream>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:145:20: note: in instantiation of member function 'c10::optional<c10::Stream>::has_value' requested here
    if (stream_opt.has_value()) {
                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:761:11: note: in instantiation of member function 'c10::optional<c10::Stream>::contained_val' requested here
        ? contained_val()
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:146:33: note: in instantiation of member function 'c10::optional<c10::Stream>::value' requested here
      guard_.emplace(stream_opt.value());
                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:197:34: note: in instantiation of template class 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>' requested here
  optional<InlineStreamGuard<T>> guard_;
                                 ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:139:64: note: in instantiation of template class 'c10::impl::InlineOptionalStreamGuard<c10::impl::VirtualGuardImpl>' requested here
  c10::impl::InlineOptionalStreamGuard<impl::VirtualGuardImpl> guard_;
                                                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:197:34: note: in instantiation of template class 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>' requested here
  optional<InlineStreamGuard<T>> guard_;
                                 ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:139:64: note: in instantiation of template class 'c10::impl::InlineOptionalStreamGuard<c10::impl::VirtualGuardImpl>' requested here
  c10::impl::InlineOptionalStreamGuard<impl::VirtualGuardImpl> guard_;
                                                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:232:15: note: in instantiation of template class 'c10::optional<c10::impl::VirtualGuardImpl>' requested here
  optional<T> impl_;
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:162:61: note: in instantiation of template class 'c10::impl::InlineMultiStreamGuard<c10::impl::VirtualGuardImpl>' requested here
  c10::impl::InlineMultiStreamGuard<impl::VirtualGuardImpl> guard_;
                                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:232:15: note: in instantiation of template class 'c10::optional<c10::impl::VirtualGuardImpl>' requested here
  optional<T> impl_;
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:162:61: note: in instantiation of template class 'c10::impl::InlineMultiStreamGuard<c10::impl::VirtualGuardImpl>' requested here
  c10::impl::InlineMultiStreamGuard<impl::VirtualGuardImpl> guard_;
                                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:834:47: note: in instantiation of template class 'c10::optional<std::vector<c10::weak_intrusive_ptr<c10::StorageImpl>>>' requested here
      c10::optional<std::vector<WeakStorage>> storages = c10::nullopt) {
                                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:834:47: note: in instantiation of template class 'c10::optional<std::vector<c10::weak_intrusive_ptr<c10::StorageImpl>>>' requested here
      c10::optional<std::vector<WeakStorage>> storages = c10::nullopt) {
                                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:834:58: note: in instantiation of member function 'c10::optional<std::vector<c10::weak_intrusive_ptr<c10::StorageImpl>>>::optional' requested here
      c10::optional<std::vector<WeakStorage>> storages = c10::nullopt) {
                                                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<std::vector<c10::weak_intrusive_ptr<c10::StorageImpl>>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:849:22: note: in instantiation of member function 'c10::optional<std::vector<c10::weak_intrusive_ptr<c10::StorageImpl>>>::has_value' requested here
            storages.has_value() ? std::move(*storages) : extractStorages(value);
                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<std::vector<c10::weak_intrusive_ptr<c10::StorageImpl>>>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:849:46: note: in instantiation of member function 'c10::optional<std::vector<c10::weak_intrusive_ptr<c10::StorageImpl>>>::operator*' requested here
            storages.has_value() ? std::move(*storages) : extractStorages(value);
                                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:1000:57: note: in instantiation of function template specialization 'c10::optional<std::vector<c10::weak_intrusive_ptr<c10::StorageImpl>>>::optional<std::vector<c10::weak_intrusive_ptr<c10::StorageImpl>>, false>' requested here
              childFut->markCompleted(std::move(value), std::move(storages));
                                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:1035:48: note: in instantiation of function template specialization 'c10::optional<std::vector<c10::weak_intrusive_ptr<c10::StorageImpl>>>::optional<const std::vector<c10::weak_intrusive_ptr<c10::StorageImpl>> &, false>' requested here
                      intermediateFut.value(), intermediateFut.storages());
                                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:1462:71: note: in instantiation of template class 'c10::optional<int>' requested here
  virtual IValue toIValue(const TypePtr& type, c10::optional<int32_t> N = c10::nullopt) = 0;
                                                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:1462:71: note: in instantiation of template class 'c10::optional<int>' requested here
  virtual IValue toIValue(const TypePtr& type, c10::optional<int32_t> N = c10::nullopt) = 0;
                                                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:1462:75: note: in instantiation of member function 'c10::optional<int>::optional' requested here
  virtual IValue toIValue(const TypePtr& type, c10::optional<int32_t> N = c10::nullopt) = 0;
                                                                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:2120:5: note: in instantiation of template class 'c10::optional<std::reference_wrapper<const std::basic_string<char>>>' requested here
    toOptionalStringRef() const {
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:2120:5: note: in instantiation of template class 'c10::optional<std::reference_wrapper<const std::basic_string<char>>>' requested here
    toOptionalStringRef() const {
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:2122:12: note: in instantiation of member function 'c10::optional<std::reference_wrapper<const std::basic_string<char>>>::optional' requested here
    return c10::nullopt;
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:2128:10: note: in instantiation of function template specialization 'c10::optional<std::reference_wrapper<const std::basic_string<char>>>::optional<std::reference_wrapper<const std::basic_string<char>>, false>' requested here
  return std::reference_wrapper<const std::string>(
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/TensorIndexing.h:212:26: note: in instantiation of function template specialization 'c10::optional<long>::optional<long &, false>' requested here
  return self.slice(dim, start, stop, step);
                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/TensorIndexing.h:241:27: note: in instantiation of member function 'c10::optional<c10::ArrayRef<at::Dimname>>::optional' requested here
    return at::empty({1}, {}, self.options().dtype(kLong)).fill_(0.);
                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/TensorIndexing.h:279:30: note: in instantiation of function template specialization 'c10::optional<at::Tensor>::optional<const at::Tensor, false>' requested here
    converted_inds.push_back(std::move(i));
                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/variable.h:525:27: note: in instantiation of template class 'c10::optional<torch::autograd::ViewInfo>' requested here
  c10::optional<ViewInfo> backward_info_;
                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/variable.h:525:27: note: in instantiation of template class 'c10::optional<torch::autograd::ViewInfo>' requested here
  c10::optional<ViewInfo> backward_info_;
                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<torch::autograd::ViewInfo>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/variable.h:560:27: note: in instantiation of member function 'c10::optional<torch::autograd::ViewInfo>::has_value' requested here
    return backward_info_.has_value();
                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:755:11: note: in instantiation of member function 'c10::optional<torch::autograd::ViewInfo>::contained_val' requested here
        ? contained_val()
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/variable.h:565:27: note: in instantiation of member function 'c10::optional<torch::autograd::ViewInfo>::value' requested here
    return backward_info_.value();
                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:1215:10: note: in instantiation of function template specialization 'c10::optional<c10::basic_string_view<char>>::optional<c10::basic_string_view<char>, false>' requested here
  return optional<typename std::decay<T>::type>(constexpr_forward<T>(v));
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/operator_name.h:31:19: note: in instantiation of function template specialization 'c10::make_optional<c10::basic_string_view<char>>' requested here
      return c10::make_optional(c10::string_view(name.data(), pos));
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<c10::basic_string_view<char>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/operator_name.h:37:25: note: in instantiation of member function 'c10::optional<c10::basic_string_view<char>>::has_value' requested here
    if (!getNamespace().has_value()) {
                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:179:25: note: in instantiation of template class 'c10::optional<c10::IValue>' requested here
  c10::optional<IValue> default_value_;
                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:179:25: note: in instantiation of template class 'c10::optional<c10::IValue>' requested here
  c10::optional<IValue> default_value_;
                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:30:45: note: in instantiation of member function 'c10::optional<c10::IValue>::optional' requested here
      c10::optional<IValue> default_value = c10::nullopt,
                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:32:32: note: in instantiation of template class 'c10::optional<c10::AliasInfo>' requested here
      c10::optional<AliasInfo> alias_info = c10::nullopt)
                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:32:32: note: in instantiation of template class 'c10::optional<c10::AliasInfo>' requested here
      c10::optional<AliasInfo> alias_info = c10::nullopt)
                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:32:45: note: in instantiation of member function 'c10::optional<c10::AliasInfo>::optional' requested here
      c10::optional<AliasInfo> alias_info = c10::nullopt)
                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:744:12: note: in instantiation of member function 'c10::optional<c10::AliasInfo>::initialized' requested here
    assert(initialized());
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:48:72: note: in instantiation of member function 'c10::optional<c10::AliasInfo>::operator*' requested here
        alias_info_(alias_info ? std::make_unique<AliasInfo>(std::move(*alias_info)) : nullptr),
                                                                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<c10::AliasInfo>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:48:72: note: in instantiation of member function 'c10::optional<c10::AliasInfo>::operator*' requested here
        alias_info_(alias_info ? std::make_unique<AliasInfo>(std::move(*alias_info)) : nullptr),
                                                                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:148:23: note: in instantiation of function template specialization 'c10::optional<c10::AliasInfo>::optional<c10::AliasInfo &, false>' requested here
        alias_info_ ? c10::optional<AliasInfo>(*alias_info_) : c10::nullopt);
                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<int>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:935:15: note: in instantiation of member function 'c10::optional<int>::operator bool' requested here
  return bool(x) != bool(y) ? false : bool(x) == false ? true : *x == *y;
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:193:22: note: in instantiation of function template specialization 'c10::operator==<int>' requested here
          && lhs.N() == rhs.N()
                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<int>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:935:65: note: in instantiation of member function 'c10::optional<int>::operator*' requested here
  return bool(x) != bool(y) ? false : bool(x) == false ? true : *x == *y;
                                                                ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:193:22: note: in instantiation of function template specialization 'c10::operator==<int>' requested here
          && lhs.N() == rhs.N()
                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<c10::IValue>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:935:15: note: in instantiation of member function 'c10::optional<c10::IValue>::operator bool' requested here
  return bool(x) != bool(y) ? false : bool(x) == false ? true : *x == *y;
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:194:34: note: in instantiation of function template specialization 'c10::operator==<c10::IValue>' requested here
          && lhs.default_value() == rhs.default_value()
                                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<c10::IValue>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:935:65: note: in instantiation of member function 'c10::optional<c10::IValue>::operator*' requested here
  return bool(x) != bool(y) ? false : bool(x) == false ? true : *x == *y;
                                                                ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:194:34: note: in instantiation of function template specialization 'c10::operator==<c10::IValue>' requested here
          && lhs.default_value() == rhs.default_value()
                                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:304:36: note: in instantiation of template class 'c10::optional<c10::AliasAnalysisKind>' requested here
  c10::optional<AliasAnalysisKind> alias_kind_;
                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:304:36: note: in instantiation of template class 'c10::optional<c10::AliasAnalysisKind>' requested here
  c10::optional<AliasAnalysisKind> alias_kind_;
                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:208:3: note: in instantiation of member function 'c10::optional<c10::AliasAnalysisKind>::optional' requested here
  FunctionSchema(
  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:366:16: note: in instantiation of function template specialization 'c10::optional<int>::optional<const unsigned long, false>' requested here
        return i;
               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<c10::AliasAnalysisKind>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:435:13: note: in instantiation of member function 'c10::optional<c10::AliasAnalysisKind>::operator bool' requested here
    return !alias_kind_;
            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<c10::AliasAnalysisKind>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:773:20: note: in instantiation of member function 'c10::optional<c10::AliasAnalysisKind>::operator*' requested here
    return *this ? **this : detail_::convert<T>(constexpr_forward<V>(v));
                   ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:438:24: note: in instantiation of function template specialization 'c10::optional<c10::AliasAnalysisKind>::value_or<c10::AliasAnalysisKind>' requested here
    return alias_kind_.value_or(AliasAnalysisKind::CONSERVATIVE);
                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:750:27: note: in instantiation of member function 'c10::optional<int>::contained_val' requested here
    return constexpr_move(contained_val());
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:489:52: note: in instantiation of member function 'c10::optional<int>::operator*' requested here
    out << list->getElementType()->str() << "[" << *arg.N() << "]";
                                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/op_registration/op_registration.h:428:34: note: in instantiation of template class 'c10::optional<c10::DispatchKey>' requested here
      c10::optional<DispatchKey> dispatch_key;
                                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/op_registration/op_registration.h:428:34: note: in instantiation of template class 'c10::optional<c10::DispatchKey>' requested here
      c10::optional<DispatchKey> dispatch_key;
                                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/op_registration/op_registration.h:430:41: note: in instantiation of template class 'c10::optional<c10::impl::CppSignature>' requested here
      c10::optional<impl::CppSignature> cpp_signature;
                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/op_registration/op_registration.h:430:41: note: in instantiation of template class 'c10::optional<c10::impl::CppSignature>' requested here
      c10::optional<impl::CppSignature> cpp_signature;
                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/op_registration/op_registration.h:434:62: note: in instantiation of template class 'c10::optional<c10::either<c10::OperatorName, c10::FunctionSchema>>' requested here
    c10::optional<c10::either<OperatorName, FunctionSchema>> schemaOrName_;
                                                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/op_registration/op_registration.h:434:62: note: in instantiation of template class 'c10::optional<c10::either<c10::OperatorName, c10::FunctionSchema>>' requested here
    c10::optional<c10::either<OperatorName, FunctionSchema>> schemaOrName_;
                                                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<c10::either<c10::OperatorName, c10::FunctionSchema>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/op_registration/op_registration.h:84:36: note: in instantiation of member function 'c10::optional<c10::either<c10::OperatorName, c10::FunctionSchema>>::has_value' requested here
        TORCH_CHECK(!schemaOrName_.has_value(), "You can only specify the schema once per operator registration.");
                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/op_registration/op_registration.h:413:7: note: in instantiation of member function 'c10::optional<c10::either<c10::OperatorName, c10::FunctionSchema>>::optional' requested here
    : schemaOrName_(c10::nullopt)
      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/op_registration/op_registration.h:415:7: note: in instantiation of member function 'c10::optional<c10::AliasAnalysisKind>::optional' requested here
    , aliasAnalysisKind_(c10::nullopt)
      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/op_registration/op_registration.h:422:11: note: in instantiation of member function 'c10::optional<c10::DispatchKey>::optional' requested here
        : dispatch_key(c10::nullopt)
          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/op_registration/op_registration.h:424:11: note: in instantiation of member function 'c10::optional<c10::impl::CppSignature>::optional' requested here
        , cpp_signature(c10::nullopt)
          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:580:38: note: in instantiation of template type alias 'OptionalBase' requested here
    return detail_::static_addressof(OptionalBase<T>::storage_.value_);
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:731:60: note: in instantiation of member function 'c10::optional<at::Tensor>::dataptr' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), dataptr());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/dispatch/DispatchKeyExtractor.h:61:20: note: in instantiation of member function 'c10::optional<at::Tensor>::operator->' requested here
        ts = ts | x->key_set();
                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:761:11: note: in instantiation of member function 'c10::optional<at::Tensor>::contained_val' requested here
        ? contained_val()
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/dispatch/DispatchKeyExtractor.h:73:23: note: in instantiation of member function 'c10::optional<at::Tensor>::value' requested here
          ts = ts | x.value().key_set();
                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/dispatch/OperatorEntry.h:212:34: note: in instantiation of template class 'c10::optional<c10::impl::AnnotatedSchema>' requested here
  c10::optional<AnnotatedSchema> schema_;
                                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/dispatch/OperatorEntry.h:212:34: note: in instantiation of template class 'c10::optional<c10::impl::AnnotatedSchema>' requested here
  c10::optional<AnnotatedSchema> schema_;
                                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/dispatch/OperatorEntry.h:271:40: note: in instantiation of template class 'c10::optional<c10::impl::OperatorEntry::CppSignatureWithDebug>' requested here
  c10::optional<CppSignatureWithDebug> cpp_signature_;
                                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/dispatch/OperatorEntry.h:271:40: note: in instantiation of template class 'c10::optional<c10::impl::OperatorEntry::CppSignatureWithDebug>' requested here
  c10::optional<CppSignatureWithDebug> cpp_signature_;
                                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<c10::impl::AnnotatedSchema>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/dispatch/OperatorEntry.h:78:35: note: in instantiation of member function 'c10::optional<c10::impl::AnnotatedSchema>::has_value' requested here
    TORCH_INTERNAL_ASSERT(schema_.has_value(), "Tried to access the schema for ", name_, " which doesn't have a schema registered yet");
                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:580:38: note: in instantiation of template type alias 'OptionalBase' requested here
    return detail_::static_addressof(OptionalBase<T>::storage_.value_);
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:731:60: note: in instantiation of member function 'c10::optional<c10::impl::AnnotatedSchema>::dataptr' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), dataptr());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/dispatch/OperatorEntry.h:79:19: note: in instantiation of member function 'c10::optional<c10::impl::AnnotatedSchema>::operator->' requested here
    return schema_->schema;
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<c10::impl::OperatorEntry::CppSignatureWithDebug>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/dispatch/OperatorEntry.h:169:37: note: in instantiation of member function 'c10::optional<c10::impl::OperatorEntry::CppSignatureWithDebug>::has_value' requested here
    if (C10_UNLIKELY(cpp_signature_.has_value() && (call_signature != cpp_signature_->signature))) {
                                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:30:3: note: in instantiation of template class 'c10::optional<std::chrono::duration<long, std::ratio<1, 1000>>>' requested here
  TORCH_ARG(optional<std::chrono::milliseconds>, timeout);
  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/arg.h:22:5: note: expanded from macro 'TORCH_ARG'
  T name##_ /* NOLINT */
    ^
<scratch space>:224:1: note: expanded from here
timeout_
^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:30:3: note: in instantiation of template class 'c10::optional<std::chrono::duration<long, std::ratio<1, 1000>>>' requested here
  TORCH_ARG(optional<std::chrono::milliseconds>, timeout);
  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/arg.h:22:5: note: expanded from macro 'TORCH_ARG'
  T name##_ /* NOLINT */
    ^
<scratch space>:224:1: note: expanded from here
timeout_
^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:15:18: note: in instantiation of member function 'c10::optional<std::chrono::duration<long, std::ratio<1, 1000>>>::optional' requested here
  /* implicit */ DataLoaderOptions(size_t batch_size)
                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/detail/queue.h:43:55: note: in instantiation of member function 'c10::optional<std::chrono::duration<long, std::ratio<1, 1000>>>::optional' requested here
  T pop(optional<std::chrono::milliseconds> timeout = nullopt) {
                                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<std::chrono::duration<long, std::ratio<1, 1000>>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/detail/queue.h:45:9: note: in instantiation of member function 'c10::optional<std::chrono::duration<long, std::ratio<1, 1000>>>::operator bool' requested here
    if (timeout) {
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<std::chrono::duration<long, std::ratio<1, 1000>>>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/detail/queue.h:47:21: note: in instantiation of member function 'c10::optional<std::chrono::duration<long, std::ratio<1, 1000>>>::operator*' requested here
              lock, *timeout, [this] { return !this->queue_.empty(); })) {
                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/frontend/source_range.h:357:58: note: in instantiation of template class 'c10::optional<std::tuple<std::basic_string<char>, unsigned long, unsigned long>>' requested here
  c10::optional<std::tuple<std::string, size_t, size_t>> file_line_col() const {
                                                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/frontend/source_range.h:357:58: note: in instantiation of template class 'c10::optional<std::tuple<std::basic_string<char>, unsigned long, unsigned long>>' requested here
  c10::optional<std::tuple<std::string, size_t, size_t>> file_line_col() const {
                                                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/frontend/source_range.h:359:14: note: in instantiation of member function 'c10::optional<std::tuple<std::basic_string<char>, unsigned long, unsigned long>>::optional' requested here
      return c10::nullopt;
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/frontend/source_range.h:365:12: note: in instantiation of function template specialization 'c10::optional<std::tuple<std::basic_string<char>, unsigned long, unsigned long>>::optional<std::tuple<std::basic_string<char>, unsigned long, unsigned long>, false>' requested here
    return std::make_tuple<std::string, size_t, size_t>(
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/frontend/source_range.h:380:30: note: in instantiation of template class 'c10::optional<torch::jit::SourceRange>' requested here
  c10::optional<SourceRange> findSourceRangeThatGenerated() const {
                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/frontend/source_range.h:380:30: note: in instantiation of template class 'c10::optional<torch::jit::SourceRange>' requested here
  c10::optional<SourceRange> findSourceRangeThatGenerated() const {
                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/frontend/source_range.h:382:14: note: in instantiation of member function 'c10::optional<torch::jit::SourceRange>::optional' requested here
      return c10::nullopt;
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/scope.h:127:38: note: in instantiation of template class 'c10::optional<c10::intrusive_ptr<torch::jit::InlinedCallStack>>' requested here
  c10::optional<InlinedCallStackPtr> callee_;
                                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/scope.h:127:38: note: in instantiation of template class 'c10::optional<c10::intrusive_ptr<torch::jit::InlinedCallStack>>' requested here
  c10::optional<InlinedCallStackPtr> callee_;
                                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/scope.h:140:37: note: in instantiation of template class 'c10::optional<torch::jit::ModuleInstanceInfo>' requested here
  c10::optional<ModuleInstanceInfo> module_instance_info_;
                                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/scope.h:140:37: note: in instantiation of template class 'c10::optional<torch::jit::ModuleInstanceInfo>' requested here
  c10::optional<ModuleInstanceInfo> module_instance_info_;
                                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<torch::jit::ModuleInstanceInfo>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/scope.h:187:31: note: in instantiation of member function 'c10::optional<torch::jit::ModuleInstanceInfo>::has_value' requested here
    return (module_instance().has_value() ==
                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:768:22: note: in instantiation of member function 'c10::optional<torch::jit::ModuleInstanceInfo>::contained_val' requested here
    return std::move(contained_val());
                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/scope.h:190:28: note: in instantiation of member function 'c10::optional<torch::jit::ModuleInstanceInfo>::value' requested here
         module_instance().value() == rhs.module_instance().value()) &&
                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<c10::intrusive_ptr<torch::jit::InlinedCallStack>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:935:15: note: in instantiation of member function 'c10::optional<c10::intrusive_ptr<torch::jit::InlinedCallStack>>::operator bool' requested here
  return bool(x) != bool(y) ? false : bool(x) == false ? true : *x == *y;
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/scope.h:191:18: note: in instantiation of function template specialization 'c10::operator==<c10::intrusive_ptr<torch::jit::InlinedCallStack>>' requested here
        callee() == rhs.callee() && source_range() == rhs.source_range();
                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<c10::intrusive_ptr<torch::jit::InlinedCallStack>>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:935:65: note: in instantiation of member function 'c10::optional<c10::intrusive_ptr<torch::jit::InlinedCallStack>>::operator*' requested here
  return bool(x) != bool(y) ? false : bool(x) == false ? true : *x == *y;
                                                                ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/scope.h:191:18: note: in instantiation of function template specialization 'c10::operator==<c10::intrusive_ptr<torch::jit::InlinedCallStack>>' requested here
        callee() == rhs.callee() && source_range() == rhs.source_range();
                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/constants.h:29:29: note: in instantiation of template class 'c10::optional<c10::intrusive_ptr<torch::jit::Scope>>' requested here
    c10::optional<ScopePtr> scope = c10::nullopt);
                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/constants.h:29:29: note: in instantiation of template class 'c10::optional<c10::intrusive_ptr<torch::jit::Scope>>' requested here
    c10::optional<ScopePtr> scope = c10::nullopt);
                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/constants.h:29:37: note: in instantiation of member function 'c10::optional<c10::intrusive_ptr<torch::jit::Scope>>::optional' requested here
    c10::optional<ScopePtr> scope = c10::nullopt);
                                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/named_value.h:18:9: note: in instantiation of function template specialization 'c10::optional<torch::jit::SourceRange>::optional<const torch::jit::SourceRange &, false>' requested here
      : loc_(loc), name_(name), value_(value) {}
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/named_value.h:18:20: note: in instantiation of function template specialization 'c10::optional<std::basic_string<char>>::optional<const std::basic_string<char> &, false>' requested here
      : loc_(loc), name_(name), value_(value) {}
                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/named_value.h:21:18: note: in instantiation of member function 'c10::optional<torch::jit::SourceRange>::optional' requested here
  /* implicit */ NamedValue(Value* value) : value_(value) {}
                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<torch::jit::SourceRange>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/named_value.h:49:10: note: in instantiation of member function 'c10::optional<torch::jit::SourceRange>::operator bool' requested here
    if (!loc_)
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<torch::jit::SourceRange>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/named_value.h:70:12: note: in instantiation of member function 'c10::optional<torch::jit::SourceRange>::operator*' requested here
    return *loc_;
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/runtime/operator.h:86:59: note: in instantiation of function template specialization 'c10::optional<c10::AliasAnalysisKind>::optional<c10::AliasAnalysisKind &, false>' requested here
                UnparsedFunctionSchema{std::move(schema), alias_analysis}),
                                                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<c10::AliasAnalysisKind>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/runtime/operator.h:154:39: note: in instantiation of member function 'c10::optional<c10::AliasAnalysisKind>::operator*' requested here
              schema.setAliasAnalysis(*unmaterializedSchema.alias_analysis_);
                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/runtime/operator.h:256:25: note: in instantiation of template class 'c10::optional<torch::jit::Operator>' requested here
c10::optional<Operator> OperatorGenerator(
                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/runtime/operator.h:256:25: note: in instantiation of template class 'c10::optional<torch::jit::Operator>' requested here
c10::optional<Operator> OperatorGenerator(
                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/runtime/operator.h:280:10: note: in instantiation of member function 'c10::optional<torch::jit::Operator>::optional' requested here
  return c10::nullopt;
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/enum_type.h:83:39: note: in instantiation of function template specialization 'c10::optional<c10::QualifiedName>::optional<c10::QualifiedName, false>' requested here
      : NamedType(TypeKind::EnumType, std::move(qualified_class_name)),
                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<c10::intrusive_ptr<torch::jit::InlinedCallStack>>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/ir.h:430:26: note: in instantiation of member function 'c10::optional<c10::intrusive_ptr<torch::jit::InlinedCallStack>>::operator*' requested here
      this->setCallStack(*cs);
                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/runtime/argument_spec.h:51:27: note: in instantiation of function template specialization 'c10::optional<unsigned long>::optional<int, false>' requested here
        type(), device(), c10::optional<size_t>(dim()), requires_grad());
                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/runtime/argument_spec.h:465:19: note: in instantiation of function template specialization 'c10::optional<signed char>::optional<signed char, false>' requested here
  return (from) ? c10::optional<int8_t>(static_cast<int8_t>(*from))
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/runtime/argument_spec.h:466:19: note: in instantiation of member function 'c10::optional<signed char>::optional' requested here
                : c10::optional<int8_t>{};
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/runtime/interpreter.h:150:39: note: in instantiation of template class 'c10::optional<at::ThreadLocalState>' requested here
  c10::optional<at::ThreadLocalState> tls_state_ = c10::nullopt;
                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/runtime/interpreter.h:150:39: note: in instantiation of template class 'c10::optional<at::ThreadLocalState>' requested here
  c10::optional<at::ThreadLocalState> tls_state_ = c10::nullopt;
                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/runtime/interpreter.h:136:55: note: in instantiation of member function 'c10::optional<at::ThreadLocalState>::optional' requested here
      c10::optional<at::ThreadLocalState> tls_state = c10::nullopt)
                                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:156:48: note: in instantiation of template class 'c10::optional<torch::jit::ExecutorExecutionMode>' requested here
  mutable c10::optional<ExecutorExecutionMode> executor_execution_mode_;
                                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:156:48: note: in instantiation of template class 'c10::optional<torch::jit::ExecutorExecutionMode>' requested here
  mutable c10::optional<ExecutorExecutionMode> executor_execution_mode_;
                                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/array:110:56: note: in instantiation of template class 'c10::optional<std::shared_ptr<torch::jit::Graph>>' requested here
      typename _AT_Type::_Type                         _M_elems;
                                                       ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:165:7: note: in instantiation of template class 'std::array<c10::optional<std::shared_ptr<torch::jit::Graph>>, 4>' requested here
      optimized_graphs_;
      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/array:110:56: note: in instantiation of template class 'c10::optional<std::shared_ptr<torch::jit::Graph>>' requested here
      typename _AT_Type::_Type                         _M_elems;
                                                       ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:165:7: note: in instantiation of template class 'std::array<c10::optional<std::shared_ptr<torch::jit::Graph>>, 4>' requested here
      optimized_graphs_;
      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/array:110:56: note: in instantiation of template class 'c10::optional<torch::jit::GraphExecutor>' requested here
      typename _AT_Type::_Type                         _M_elems;
                                                       ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:179:7: note: in instantiation of template class 'std::array<c10::optional<torch::jit::GraphExecutor>, 4>' requested here
      executors_;
      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/array:110:56: note: in instantiation of template class 'c10::optional<torch::jit::GraphExecutor>' requested here
      typename _AT_Type::_Type                         _M_elems;
                                                       ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:179:7: note: in instantiation of template class 'std::array<c10::optional<torch::jit::GraphExecutor>, 4>' requested here
      executors_;
      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:18:11: note: in instantiation of member function 'c10::optional<torch::jit::ExecutorExecutionMode>::optional' requested here
          c10::nullopt)
          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:13:3: note: in instantiation of member function 'c10::optional<torch::jit::ExecutorExecutionMode>::optional' requested here
  GraphFunction(
  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/array:94:12: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::Graph>>::optional' requested here
    struct array
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:13:3: note: in implicit default constructor for 'std::array<c10::optional<std::shared_ptr<torch::jit::Graph>>, 4>' first required here
  GraphFunction(
  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/array:94:12: note: in instantiation of member function 'c10::optional<torch::jit::GraphExecutor>::optional' requested here
    struct array
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:13:3: note: in implicit default constructor for 'std::array<c10::optional<torch::jit::GraphExecutor>, 4>' first required here
  GraphFunction(
  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::Graph>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:46:9: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::Graph>>::operator bool' requested here
    if (optimized_graph) {
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::Graph>>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:47:14: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::Graph>>::operator*' requested here
      return *optimized_graph;
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<torch::jit::GraphExecutor>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:108:9: note: in instantiation of member function 'c10::optional<torch::jit::GraphExecutor>::operator bool' requested here
    if (executor) {
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<torch::jit::GraphExecutor>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:109:14: note: in instantiation of member function 'c10::optional<torch::jit::GraphExecutor>::operator*' requested here
      return *executor;
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<torch::jit::ExecutorExecutionMode>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:114:10: note: in instantiation of member function 'c10::optional<torch::jit::ExecutorExecutionMode>::operator bool' requested here
    if (!executor_execution_mode_) {
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<torch::jit::ExecutorExecutionMode>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:117:49: note: in instantiation of member function 'c10::optional<torch::jit::ExecutorExecutionMode>::operator*' requested here
      executor = GraphExecutor(opt_graph, name, *executor_execution_mode_);
                                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:132:28: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::Graph>>::optional' requested here
    optimized_graphs_.fill(c10::nullopt);
                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/object.h:46:27: note: in instantiation of template class 'c10::optional<torch::jit::Method>' requested here
    c10::optional<Method> setter_func;
                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/object.h:46:27: note: in instantiation of template class 'c10::optional<torch::jit::Method>' requested here
    c10::optional<Method> setter_func;
                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<torch::jit::Method>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/object.h:105:14: note: in instantiation of member function 'c10::optional<torch::jit::Method>::operator bool' requested here
    if (auto method = find_method(name)) {
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<torch::jit::Method>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/object.h:106:14: note: in instantiation of member function 'c10::optional<torch::jit::Method>::operator*' requested here
      return *method;
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/object.h:129:40: note: in instantiation of member function 'c10::optional<torch::jit::Method>::optional' requested here
        c10::optional<Method> setter = c10::nullopt;
                                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/module.h:304:45: note: in instantiation of template class 'c10::optional<std::vector<std::basic_string<char>>>' requested here
    c10::optional<std::vector<std::string>> preserved_attrs = c10::nullopt,
                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/module.h:304:45: note: in instantiation of template class 'c10::optional<std::vector<std::basic_string<char>>>' requested here
    c10::optional<std::vector<std::string>> preserved_attrs = c10::nullopt,
                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/module.h:304:63: note: in instantiation of member function 'c10::optional<std::vector<std::basic_string<char>>>::optional' requested here
    c10::optional<std::vector<std::string>> preserved_attrs = c10::nullopt,
                                                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/datasets/tensor.h:30:12: note: in instantiation of function template specialization 'c10::optional<unsigned long>::optional<long, false>' requested here
    return tensor.size(0);
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_legacy.h:340:90: note: in instantiation of template class 'c10::optional<torch::autograd::profiler::ProfilerDisableOptions>' requested here
TORCH_API thread_event_lists disableProfilerLegacy(c10::optional<ProfilerDisableOptions> profilerDisableOptions = c10::nullopt);
                                                                                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_legacy.h:340:90: note: in instantiation of template class 'c10::optional<torch::autograd::profiler::ProfilerDisableOptions>' requested here
TORCH_API thread_event_lists disableProfilerLegacy(c10::optional<ProfilerDisableOptions> profilerDisableOptions = c10::nullopt);
                                                                                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_legacy.h:340:115: note: in instantiation of member function 'c10::optional<torch::autograd::profiler::ProfilerDisableOptions>::optional' requested here
TORCH_API thread_event_lists disableProfilerLegacy(c10::optional<ProfilerDisableOptions> profilerDisableOptions = c10::nullopt);
                                                                                                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_legacy.h:400:65: note: in instantiation of template class 'c10::optional<std::function<void (const std::vector<std::vector<torch::autograd::profiler::LegacyEvent>> &)>>' requested here
  c10::optional<std::function<void(const thread_event_lists&)>> cb_;
                                                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_legacy.h:400:65: note: in instantiation of template class 'c10::optional<std::function<void (const std::vector<std::vector<torch::autograd::profiler::LegacyEvent>> &)>>' requested here
  c10::optional<std::function<void(const thread_event_lists&)>> cb_;
                                                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_legacy.h:379:28: note: in instantiation of member function 'c10::optional<std::function<void (const std::vector<std::vector<torch::autograd::profiler::LegacyEvent>> &)>>::optional' requested here
          resultCallback = c10::nullopt,
                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<std::function<void (const std::vector<std::vector<torch::autograd::profiler::LegacyEvent>> &)>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_legacy.h:390:9: note: in instantiation of member function 'c10::optional<std::function<void (const std::vector<std::vector<torch::autograd::profiler::LegacyEvent>> &)>>::operator bool' requested here
    if (cb_) {
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<std::function<void (const std::vector<std::vector<torch::autograd::profiler::LegacyEvent>> &)>>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_legacy.h:392:10: note: in instantiation of member function 'c10::optional<std::function<void (const std::vector<std::vector<torch::autograd::profiler::LegacyEvent>> &)>>::operator*' requested here
        (*cb_)(event_lists);
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_kineto.h:247:52: note: in instantiation of template class 'c10::optional<std::vector<std::vector<long>>>' requested here
  c10::optional<std::vector<std::vector<int64_t>>> shapes_;
                                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_kineto.h:247:52: note: in instantiation of template class 'c10::optional<std::vector<std::vector<long>>>' requested here
  c10::optional<std::vector<std::vector<int64_t>>> shapes_;
                                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<std::vector<std::vector<long>>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:976:15: note: in instantiation of member function 'c10::optional<std::vector<std::vector<long>>>::operator bool' requested here
  return bool(x);
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_kineto.h:52:20: note: in instantiation of function template specialization 'c10::operator!=<std::vector<std::vector<long>>>' requested here
    return shapes_ != c10::nullopt;
                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<std::vector<std::vector<long>>>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_kineto.h:56:12: note: in instantiation of member function 'c10::optional<std::vector<std::vector<long>>>::operator*' requested here
    return *shapes_;
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<std::vector<std::basic_string<char>>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:976:15: note: in instantiation of member function 'c10::optional<std::vector<std::basic_string<char>>>::operator bool' requested here
  return bool(x);
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_kineto.h:65:20: note: in instantiation of function template specialization 'c10::operator!=<std::vector<std::basic_string<char>>>' requested here
    return dtypes_ != c10::nullopt;
                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<std::vector<std::basic_string<char>>>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_kineto.h:69:12: note: in instantiation of member function 'c10::optional<std::vector<std::basic_string<char>>>::operator*' requested here
    return *dtypes_;
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/batchnorm.h:24:48: note: in instantiation of function template specialization 'c10::optional<double>::optional<double, false>' requested here
  TORCH_ARG(c10::optional<double>, momentum) = 0.1;
                                               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:760:12: note: in instantiation of member function 'c10::optional<double>::initialized' requested here
    return initialized()
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/batchnorm.h:38:14: note: in instantiation of member function 'c10::optional<double>::value' requested here
    momentum.value(),
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:761:11: note: in instantiation of member function 'c10::optional<double>::contained_val' requested here
        ? contained_val()
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/batchnorm.h:38:14: note: in instantiation of member function 'c10::optional<double>::value' requested here
    momentum.value(),
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/batchnorm.h:33:5: note: in instantiation of function template specialization 'c10::optional<at::Tensor>::optional<at::Tensor &, false>' requested here
    weight,
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:649:49: note: in instantiation of function template specialization 'c10::optional<long>::optional<int &, false>' requested here
      auto _w = in_proj_weight.slice(/*dim=*/0, _start, _end);
                                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:727:84: note: in instantiation of function template specialization 'c10::optional<long>::optional<const long &, false>' requested here
      q = F::linear(query, q_proj_weight_non_opt, in_proj_bias.slice(/*dim=*/0, 0, embed_dim));
                                                                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/activation.h:728:90: note: in instantiation of function template specialization 'c10::optional<long>::optional<long, false>' requested here
      k = F::linear(key, k_proj_weight_non_opt, in_proj_bias.slice(/*dim=*/0, embed_dim, (embed_dim * 2)));
                                                                                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/loss.h:404:3: note: in instantiation of template class 'c10::optional<std::function<at::Tensor (const at::Tensor &, const at::Tensor &)>>' requested here
  TORCH_ARG(c10::optional<distance_function_t>, distance_function) = c10::nullopt;
  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/arg.h:22:5: note: expanded from macro 'TORCH_ARG'
  T name##_ /* NOLINT */
    ^
<scratch space>:250:1: note: expanded from here
distance_function_
^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/loss.h:404:3: note: in instantiation of template class 'c10::optional<std::function<at::Tensor (const at::Tensor &, const at::Tensor &)>>' requested here
  TORCH_ARG(c10::optional<distance_function_t>, distance_function) = c10::nullopt;
  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/arg.h:22:5: note: expanded from macro 'TORCH_ARG'
  T name##_ /* NOLINT */
    ^
<scratch space>:250:1: note: expanded from here
distance_function_
^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/loss.h:404:70: note: in instantiation of member function 'c10::optional<std::function<at::Tensor (const at::Tensor &, const at::Tensor &)>>::optional' requested here
  TORCH_ARG(c10::optional<distance_function_t>, distance_function) = c10::nullopt;
                                                                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:727:12: note: in instantiation of member function 'c10::optional<std::function<at::Tensor (const at::Tensor &, const at::Tensor &)>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:583:25: note: in instantiation of member function 'c10::optional<std::function<at::Tensor (const at::Tensor &, const at::Tensor &)>>::has_value' requested here
  if (distance_function.has_value()) {
                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:761:11: note: in instantiation of member function 'c10::optional<std::function<at::Tensor (const at::Tensor &, const at::Tensor &)>>::contained_val' requested here
        ? contained_val()
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/loss.h:584:53: note: in instantiation of member function 'c10::optional<std::function<at::Tensor (const at::Tensor &, const at::Tensor &)>>::value' requested here
    auto distance_function_impl = distance_function.value();
                                                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/normalization.h:133:43: note: in instantiation of member function 'c10::optional<at::Tensor>::optional' requested here
  TORCH_ARG(c10::optional<Tensor>, out) = c10::nullopt;
                                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/padding.h:29:25: note: in instantiation of member function 'c10::optional<double>::optional' requested here
  c10::optional<double> fill_value;
                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/pooling.h:393:65: note: in instantiation of member function 'c10::optional<std::vector<long>>::optional' requested here
  TORCH_ARG(c10::optional<std::vector<int64_t>>, output_size) = c10::nullopt;
                                                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:580:38: note: in instantiation of template type alias 'OptionalBase' requested here
    return detail_::static_addressof(OptionalBase<T>::storage_.value_);
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:731:60: note: in instantiation of member function 'c10::optional<std::vector<long>>::dataptr' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), dataptr());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:611:20: note: in instantiation of member function 'c10::optional<std::vector<long>>::operator->' requested here
    if (output_size->size() == kernel_size.size() + 2) {
                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<std::vector<long>>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:612:34: note: in instantiation of member function 'c10::optional<std::vector<long>>::operator*' requested here
      output_size_ = IntArrayRef(*output_size).slice(2).vec();
                                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:764:19: note: in instantiation of template class 'c10::optional<torch::ExpandingArray<2>>' requested here
  if (output_size == c10::nullopt && output_ratio == c10::nullopt) {
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:764:19: note: in instantiation of template class 'c10::optional<torch::ExpandingArray<2>>' requested here
  if (output_size == c10::nullopt && output_ratio == c10::nullopt) {
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<2>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:966:12: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<2>>::operator bool' requested here
  return (!x);
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:764:19: note: in instantiation of function template specialization 'c10::operator==<torch::ExpandingArray<2>>' requested here
  if (output_size == c10::nullopt && output_ratio == c10::nullopt) {
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:764:51: note: in instantiation of template class 'c10::optional<torch::ExpandingArray<2, double>>' requested here
  if (output_size == c10::nullopt && output_ratio == c10::nullopt) {
                                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:764:51: note: in instantiation of template class 'c10::optional<torch::ExpandingArray<2, double>>' requested here
  if (output_size == c10::nullopt && output_ratio == c10::nullopt) {
                                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<2, double>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:966:12: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<2, double>>::operator bool' requested here
  return (!x);
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:764:51: note: in instantiation of function template specialization 'c10::operator==<torch::ExpandingArray<2, double>>' requested here
  if (output_size == c10::nullopt && output_ratio == c10::nullopt) {
                                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:755:11: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<2, double>>::contained_val' requested here
        ? contained_val()
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:773:84: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<2, double>>::value' requested here
    output_size_ = {(int64_t)(static_cast<double>(input.size(-2)) * (*output_ratio.value())[0]),
                                                                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<2>>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:782:59: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<2>>::operator*' requested here
  return torch::fractional_max_pool2d(input, kernel_size, *output_size_, _random_samples_);
                                                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:842:19: note: in instantiation of template class 'c10::optional<torch::ExpandingArray<3>>' requested here
  if (output_size == c10::nullopt && output_ratio == c10::nullopt) {
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:842:19: note: in instantiation of template class 'c10::optional<torch::ExpandingArray<3>>' requested here
  if (output_size == c10::nullopt && output_ratio == c10::nullopt) {
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<3>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:966:12: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<3>>::operator bool' requested here
  return (!x);
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:842:19: note: in instantiation of function template specialization 'c10::operator==<torch::ExpandingArray<3>>' requested here
  if (output_size == c10::nullopt && output_ratio == c10::nullopt) {
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:842:51: note: in instantiation of template class 'c10::optional<torch::ExpandingArray<3, double>>' requested here
  if (output_size == c10::nullopt && output_ratio == c10::nullopt) {
                                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:842:51: note: in instantiation of template class 'c10::optional<torch::ExpandingArray<3, double>>' requested here
  if (output_size == c10::nullopt && output_ratio == c10::nullopt) {
                                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<3, double>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:966:12: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<3, double>>::operator bool' requested here
  return (!x);
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:842:51: note: in instantiation of function template specialization 'c10::operator==<torch::ExpandingArray<3, double>>' requested here
  if (output_size == c10::nullopt && output_ratio == c10::nullopt) {
                                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:755:11: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<3, double>>::contained_val' requested here
        ? contained_val()
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:852:84: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<3, double>>::value' requested here
    output_size_ = {(int64_t)(static_cast<double>(input.size(-3)) * (*output_ratio.value())[0]),
                                                                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:745:12: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<3>>::contained_val' requested here
    return contained_val();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:862:59: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<3>>::operator*' requested here
  return torch::fractional_max_pool3d(input, kernel_size, *output_size_, _random_samples_);
                                                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/normalization.h:21:31: note: in instantiation of function template specialization 'c10::optional<c10::Scalar>::optional<double &, false>' requested here
      auto denom = input.norm(p, dim, true).clamp_min(eps).expand_as(input);
                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/upsampling.h:26:3: note: in instantiation of template class 'c10::optional<std::vector<double>>' requested here
  TORCH_ARG(c10::optional<std::vector<double>>, scale_factor) = c10::nullopt;
  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/arg.h:22:5: note: expanded from macro 'TORCH_ARG'
  T name##_ /* NOLINT */
    ^
<scratch space>:85:1: note: expanded from here
scale_factor_
^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/upsampling.h:26:3: note: in instantiation of template class 'c10::optional<std::vector<double>>' requested here
  TORCH_ARG(c10::optional<std::vector<double>>, scale_factor) = c10::nullopt;
  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/arg.h:22:5: note: expanded from macro 'TORCH_ARG'
  T name##_ /* NOLINT */
    ^
<scratch space>:85:1: note: expanded from here
scale_factor_
^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/upsampling.h:26:65: note: in instantiation of member function 'c10::optional<std::vector<double>>::optional' requested here
  TORCH_ARG(c10::optional<std::vector<double>>, scale_factor) = c10::nullopt;
                                                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:21:39: note: in instantiation of member function 'c10::optional<std::vector<long>>::optional' requested here
  c10::optional<std::vector<int64_t>> size;
                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:22:38: note: in instantiation of member function 'c10::optional<std::vector<double>>::optional' requested here
  c10::optional<std::vector<double>> scale_factor;
                                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<std::vector<double>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:966:12: note: in instantiation of member function 'c10::optional<std::vector<double>>::operator bool' requested here
  return (!x);
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:25:44: note: in instantiation of function template specialization 'c10::operator==<std::vector<double>>' requested here
  if (size == c10::nullopt && scale_factor == c10::nullopt) {
                                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:761:11: note: in instantiation of member function 'c10::optional<std::vector<double>>::contained_val' requested here
        ? contained_val()
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:32:43: note: in instantiation of member function 'c10::optional<std::vector<double>>::value' requested here
    if (static_cast<int64_t>(scale_factor.value().size()) != dim) {
                                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<std::vector<double>>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:104:35: note: in instantiation of member function 'c10::optional<std::vector<double>>::operator*' requested here
    auto _scale_factor_repeated = *scale_factor;
                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/modules/conv.h:344:70: note: in instantiation of member function 'c10::optional<c10::ArrayRef<long>>::optional' requested here
                 const c10::optional<at::IntArrayRef>& output_size = c10::nullopt);
                                                                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:155:70: note: in instantiation of template class 'c10::optional<std::tuple<at::Tensor, at::Tensor>>' requested here
    const Tensor& input, torch::optional<std::tuple<Tensor, Tensor>> hx_opt = {});
                                                                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:155:70: note: in instantiation of template class 'c10::optional<std::tuple<at::Tensor, at::Tensor>>' requested here
    const Tensor& input, torch::optional<std::tuple<Tensor, Tensor>> hx_opt = {});
                                                                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/modules/rnn.h:155:77: note: in instantiation of member function 'c10::optional<std::tuple<at::Tensor, at::Tensor>>::optional' requested here
    const Tensor& input, torch::optional<std::tuple<Tensor, Tensor>> hx_opt = {});
                                                                            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/function.h:230:59: note: in instantiation of function template specialization 'c10::optional<c10::Stream>::optional<c10::Stream, false>' requested here
      if (metadata.device().type() == device_type) return metadata.stream();
                                                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/function.h:233:12: note: in instantiation of member function 'c10::optional<c10::Stream>::optional' requested here
    return c10::nullopt;
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h:72:76: note: in instantiation of function template specialization 'c10::optional<c10::Scalar>::optional<double, false>' requested here
  auto clip_coef_clamped = torch::clamp(clip_coef, c10::nullopt /* min */, 1.0 /* max */);
                                                                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/optim/lbfgs.h:46:3: note: in instantiation of template class 'c10::optional<std::vector<at::Tensor>>' requested here
  TORCH_ARG(c10::optional<std::vector<Tensor>>, al) = c10::nullopt;
  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/arg.h:22:5: note: expanded from macro 'TORCH_ARG'
  T name##_ /* NOLINT */
    ^
<scratch space>:162:1: note: expanded from here
al_
^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/optim/lbfgs.h:46:3: note: in instantiation of template class 'c10::optional<std::vector<at::Tensor>>' requested here
  TORCH_ARG(c10::optional<std::vector<Tensor>>, al) = c10::nullopt;
  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/arg.h:22:5: note: expanded from macro 'TORCH_ARG'
  T name##_ /* NOLINT */
    ^
<scratch space>:162:1: note: expanded from here
al_
^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/optim/lbfgs.h:46:55: note: in instantiation of member function 'c10::optional<std::vector<at::Tensor>>::optional' requested here
  TORCH_ARG(c10::optional<std::vector<Tensor>>, al) = c10::nullopt;
                                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:4:
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:102:5: warning: 'deviceCount' has a non-throwing exception specification but can still throw [-Wexceptions]
    C10_HIP_CHECK(hipGetDeviceCount(&deviceCnt));
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/hip/HIPException.h:45:7: note: expanded from macro 'C10_HIP_CHECK'
      throw c10::HIPError(                                         \
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:100:15: note: function declared non-throwing here
  DeviceIndex deviceCount() const noexcept override {
              ^                   ~~~~~~~~
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:192:7: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
      hipGetLastError();
      ^~~~~~~~~~~~~~~
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:427:34: note: in instantiation of template class 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>' requested here
  optional<InlineDeviceGuard<T>> guard_;
                                 ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:261:72: note: in instantiation of template class 'c10::impl::InlineOptionalDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>' requested here
  c10::impl::InlineOptionalDeviceGuard<HIPGuardImplMasqueradingAsCUDA> guard_;
                                                                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:427:34: note: in instantiation of template class 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>' requested here
  optional<InlineDeviceGuard<T>> guard_;
                                 ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:261:72: note: in instantiation of template class 'c10::impl::InlineOptionalDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>' requested here
  c10::impl::InlineOptionalDeviceGuard<HIPGuardImplMasqueradingAsCUDA> guard_;
                                                                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:197:34: note: in instantiation of template class 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>' requested here
  optional<InlineStreamGuard<T>> guard_;
                                 ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:321:72: note: in instantiation of template class 'c10::impl::InlineOptionalStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>' requested here
  c10::impl::InlineOptionalStreamGuard<HIPGuardImplMasqueradingAsCUDA> guard_;
                                                                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:197:34: note: in instantiation of template class 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>' requested here
  optional<InlineStreamGuard<T>> guard_;
                                 ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:321:72: note: in instantiation of template class 'c10::impl::InlineOptionalStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>' requested here
  c10::impl::InlineOptionalStreamGuard<HIPGuardImplMasqueradingAsCUDA> guard_;
                                                                       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:300:41: note: in instantiation of template class 'c10::optional<c10::hip::HIPStreamMasqueradingAsCUDA>' requested here
  optional<HIPStreamMasqueradingAsCUDA> original_stream() const {
                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:300:41: note: in instantiation of template class 'c10::optional<c10::hip::HIPStreamMasqueradingAsCUDA>' requested here
  optional<HIPStreamMasqueradingAsCUDA> original_stream() const {
                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:1215:10: note: in instantiation of function template specialization 'c10::optional<c10::hip::HIPStreamMasqueradingAsCUDA>::optional<c10::hip::HIPStreamMasqueradingAsCUDA, false>' requested here
  return optional<typename std::decay<T>::type>(constexpr_forward<T>(v));
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:303:14: note: in instantiation of function template specialization 'c10::make_optional<c10::hip::HIPStreamMasqueradingAsCUDA>' requested here
      return make_optional(HIPStreamMasqueradingAsCUDA(HIPStreamMasqueradingAsCUDA::UNCHECKED, r.value()));
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:305:14: note: in instantiation of member function 'c10::optional<c10::hip::HIPStreamMasqueradingAsCUDA>::optional' requested here
      return nullopt;
             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:522:13: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
            C10_IS_TRIVIALLY_COPYABLE(T) &&
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:540:26: note: in instantiation of template type alias 'OptionalBase' requested here
class optional : private OptionalBase<T> {
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:232:15: note: in instantiation of template class 'c10::optional<c10::hip::HIPGuardImplMasqueradingAsCUDA>' requested here
  optional<T> impl_;
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:334:69: note: in instantiation of template class 'c10::impl::InlineMultiStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>' requested here
  c10::impl::InlineMultiStreamGuard<HIPGuardImplMasqueradingAsCUDA> guard_;
                                                                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:232:15: note: in instantiation of template class 'c10::optional<c10::hip::HIPGuardImplMasqueradingAsCUDA>' requested here
  optional<T> impl_;
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:334:69: note: in instantiation of template class 'c10::impl::InlineMultiStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>' requested here
  c10::impl::InlineMultiStreamGuard<HIPGuardImplMasqueradingAsCUDA> guard_;
                                                                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:5:
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1192:20: warning: argument to '#pragma unroll' should not be in parentheses in CUDA C/C++ [-Wcuda-compat]
    #pragma unroll(1)
                   ^
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1470:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
    hipDeviceSynchronize();
    ^~~~~~~~~~~~~~~~~~~~
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:736:12: note: in instantiation of member function 'c10::optional<caffe2::TypeMeta>::dataptr' requested here
    return dataptr();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:652:9: note: in instantiation of template type alias 'OptionalBase' requested here
      : OptionalBase<T>(in_place_t{}, constexpr_forward<Args>(args)...) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:205:9: note: in instantiation of function template specialization 'c10::optional<c10::Device>::optional<c10::DeviceType, signed char &>' requested here
        c10::optional<Device>(c10::in_place, std::forward<Args>(args)...));
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:215:12: note: in instantiation of function template specialization 'c10::TensorOptions::device<c10::DeviceType, signed char &>' requested here
    return device(Device::Type::CUDA, device_index);
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:652:9: note: in instantiation of template type alias 'OptionalBase' requested here
      : OptionalBase<T>(in_place_t{}, constexpr_forward<Args>(args)...) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:205:9: note: in instantiation of function template specialization 'c10::optional<c10::Device>::optional<c10::Device>' requested here
        c10::optional<Device>(c10::in_place, std::forward<Args>(args)...));
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:585:26: note: in instantiation of function template specialization 'c10::TensorOptions::device<c10::Device>' requested here
  return TensorOptions().device(std::move(device));
                         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:652:9: note: in instantiation of template type alias 'OptionalBase' requested here
      : OptionalBase<T>(in_place_t{}, constexpr_forward<Args>(args)...) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:205:9: note: in instantiation of function template specialization 'c10::optional<c10::Device>::optional<c10::DeviceType>' requested here
        c10::optional<Device>(c10::in_place, std::forward<Args>(args)...));
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:829:8: note: in instantiation of function template specialization 'c10::TensorOptions::device<c10::DeviceType>' requested here
      .device(dispatchKeyToDeviceType(dispatch_key));
       ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<c10::Device>::initialize<c10::Device>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:1853:19: note: in instantiation of function template specialization 'c10::optional<c10::Device>::operator=<c10::Device>' requested here
      device_opt_ = storage_.device();
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<c10::Device>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<c10::Device>::initialize<c10::Device>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:1853:19: note: in instantiation of function template specialization 'c10::optional<c10::Device>::operator=<c10::Device>' requested here
      device_opt_ = storage_.device();
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:736:12: note: in instantiation of member function 'c10::optional<at::Generator>::dataptr' requested here
    return dataptr();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:652:9: note: in instantiation of template type alias 'OptionalBase' requested here
      : OptionalBase<T>(in_place_t{}, constexpr_forward<Args>(args)...) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:205:9: note: in instantiation of function template specialization 'c10::optional<c10::Device>::optional<c10::DeviceType, signed char>' requested here
        c10::optional<Device>(c10::in_place, std::forward<Args>(args)...));
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/DeprecatedTypeProperties.h:100:28: note: in instantiation of function template specialization 'c10::TensorOptions::device<c10::DeviceType, signed char>' requested here
                          .device(device_type(), static_cast<c10::DeviceIndex>(device_index))
                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:223:9: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::optional' requested here
      : guard_() // See Note [Explicit initialization of optional fields]
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceGuard.h:127:36: note: in instantiation of member function 'c10::impl::InlineOptionalDeviceGuard<c10::impl::VirtualGuardImpl>::InlineOptionalDeviceGuard' requested here
  explicit OptionalDeviceGuard() : guard_() {}
                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:652:9: note: in instantiation of template type alias 'OptionalBase' requested here
      : OptionalBase<T>(in_place_t{}, constexpr_forward<Args>(args)...) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:250:9: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::optional<c10::Device &>' requested here
      : guard_(in_place, std::forward<Args>(args)...) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceGuard.h:130:49: note: in instantiation of function template specialization 'c10::impl::InlineOptionalDeviceGuard<c10::impl::VirtualGuardImpl>::InlineOptionalDeviceGuard<c10::Device &>' requested here
  explicit OptionalDeviceGuard(Device device) : guard_(device) {}
                                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:594:9: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::initialized' requested here
    if (initialized())
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:695:5: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:230:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::emplace<c10::Device &>' requested here
      guard_.emplace(device_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceGuard.h:134:59: note: in instantiation of member function 'c10::impl::InlineOptionalDeviceGuard<c10::impl::VirtualGuardImpl>::InlineOptionalDeviceGuard' requested here
  explicit OptionalDeviceGuard(optional<Device> device) : guard_(device) {}
                                                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:596:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(false);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:695:5: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:230:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::emplace<c10::Device &>' requested here
      guard_.emplace(device_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceGuard.h:134:59: note: in instantiation of member function 'c10::impl::InlineOptionalDeviceGuard<c10::impl::VirtualGuardImpl>::InlineOptionalDeviceGuard' requested here
  explicit OptionalDeviceGuard(optional<Device> device) : guard_(device) {}
                                                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:595:7: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::dataptr' requested here
      dataptr()->~T();
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:695:5: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:230:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::emplace<c10::Device &>' requested here
      guard_.emplace(device_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceGuard.h:134:59: note: in instantiation of member function 'c10::impl::InlineOptionalDeviceGuard<c10::impl::VirtualGuardImpl>::InlineOptionalDeviceGuard' requested here
  explicit OptionalDeviceGuard(optional<Device> device) : guard_(device) {}
                                                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:696:5: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::initialize<c10::Device &>' requested here
    initialize(std::forward<Args>(args)...);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:230:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::emplace<c10::Device &>' requested here
      guard_.emplace(device_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceGuard.h:134:59: note: in instantiation of member function 'c10::impl::InlineOptionalDeviceGuard<c10::impl::VirtualGuardImpl>::InlineOptionalDeviceGuard' requested here
  explicit OptionalDeviceGuard(optional<Device> device) : guard_(device) {}
                                                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:652:9: note: in instantiation of template type alias 'OptionalBase' requested here
      : OptionalBase<T>(in_place_t{}, constexpr_forward<Args>(args)...) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:250:9: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::optional<c10::Device &, const c10::impl::DeviceGuardImplInterface *&>' requested here
      : guard_(in_place, std::forward<Args>(args)...) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceGuard.h:140:9: note: in instantiation of function template specialization 'c10::impl::InlineOptionalDeviceGuard<c10::impl::VirtualGuardImpl>::InlineOptionalDeviceGuard<c10::Device &, const c10::impl::DeviceGuardImplInterface *&>' requested here
      : guard_(device, impl) {}
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:696:5: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::initialize<c10::Device &, const c10::impl::DeviceGuardImplInterface *&>' requested here
    initialize(std::forward<Args>(args)...);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:370:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::emplace<c10::Device &, const c10::impl::DeviceGuardImplInterface *&>' requested here
      guard_.emplace(device, impl);
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceGuard.h:156:12: note: in instantiation of function template specialization 'c10::impl::InlineOptionalDeviceGuard<c10::impl::VirtualGuardImpl>::reset_device<c10::impl::VirtualGuardImpl, void>' requested here
    guard_.reset_device(device);
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:580:38: note: in instantiation of template type alias 'OptionalBase' requested here
    return detail_::static_addressof(OptionalBase<T>::storage_.value_);
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:731:60: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::dataptr' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), dataptr());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:409:53: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::impl::VirtualGuardImpl>>::operator->' requested here
    return guard_.has_value() ? make_optional(guard_->original_device())
                                                    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/DeviceGuard.h:168:19: note: in instantiation of member function 'c10::impl::InlineOptionalDeviceGuard<c10::impl::VirtualGuardImpl>::original_device' requested here
    return guard_.original_device();
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:686:7: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>::contained_val' requested here
      contained_val() = std::forward<U>(v);
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1314:17: note: in instantiation of function template specialization 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>::operator=<std::shared_ptr<torch::jit::CompilationUnit> &>' requested here
    strong_ptr_ = shared_cu;
                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>::initialize<std::shared_ptr<torch::jit::CompilationUnit> &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1314:17: note: in instantiation of function template specialization 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>::operator=<std::shared_ptr<torch::jit::CompilationUnit> &>' requested here
    strong_ptr_ = shared_cu;
                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>::initialize<std::shared_ptr<torch::jit::CompilationUnit> &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1314:17: note: in instantiation of function template specialization 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>::operator=<std::shared_ptr<torch::jit::CompilationUnit> &>' requested here
    strong_ptr_ = shared_cu;
                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:596:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(false);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:669:5: note: in instantiation of member function 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1315:15: note: in instantiation of member function 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>::operator=' requested here
    weak_ptr_ = c10::nullopt;
              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:595:7: note: in instantiation of member function 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>::dataptr' requested here
      dataptr()->~T();
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:669:5: note: in instantiation of member function 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1315:15: note: in instantiation of member function 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>::operator=' requested here
    weak_ptr_ = c10::nullopt;
              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:596:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(false);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:669:5: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1320:17: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::CompilationUnit>>::operator=' requested here
    strong_ptr_ = c10::nullopt;
                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:686:7: note: in instantiation of member function 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>::contained_val' requested here
      contained_val() = std::forward<U>(v);
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1321:15: note: in instantiation of function template specialization 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>::operator=<std::weak_ptr<torch::jit::CompilationUnit> &>' requested here
    weak_ptr_ = weak_cu;
              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>::initialize<std::weak_ptr<torch::jit::CompilationUnit> &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue.h:1321:15: note: in instantiation of function template specialization 'c10::optional<std::weak_ptr<torch::jit::CompilationUnit>>::operator=<std::weak_ptr<torch::jit::CompilationUnit> &>' requested here
    weak_ptr_ = weak_cu;
              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:686:7: note: in instantiation of member function 'c10::optional<c10::Stride>::contained_val' requested here
      contained_val() = std::forward<U>(v);
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:300:10: note: in instantiation of function template specialization 'c10::optional<c10::Stride>::operator=<c10::Stride>' requested here
    left = {Stride()};
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<c10::Stride>::initialize<c10::Stride>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:300:10: note: in instantiation of function template specialization 'c10::optional<c10::Stride>::operator=<c10::Stride>' requested here
    left = {Stride()};
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:736:12: note: in instantiation of member function 'c10::optional<c10::Stride>::dataptr' requested here
    return dataptr();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:686:7: note: in instantiation of member function 'c10::optional<std::vector<c10::ShapeSymbol>>::contained_val' requested here
      contained_val() = std::forward<U>(v);
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:385:11: note: in instantiation of function template specialization 'c10::optional<std::vector<c10::ShapeSymbol>>::operator=<std::vector<c10::ShapeSymbol> &>' requested here
    dims_ = shape_symbols;
          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<std::vector<c10::ShapeSymbol>>::initialize<std::vector<c10::ShapeSymbol> &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:385:11: note: in instantiation of function template specialization 'c10::optional<std::vector<c10::ShapeSymbol>>::operator=<std::vector<c10::ShapeSymbol> &>' requested here
    dims_ = shape_symbols;
          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<std::vector<c10::ShapeSymbol>>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<std::vector<c10::ShapeSymbol>>::initialize<std::vector<c10::ShapeSymbol> &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:385:11: note: in instantiation of function template specialization 'c10::optional<std::vector<c10::ShapeSymbol>>::operator=<std::vector<c10::ShapeSymbol> &>' requested here
    dims_ = shape_symbols;
          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:724:12: note: in instantiation of member function 'c10::optional<std::vector<c10::optional<long>>>::initialized' requested here
    return initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:527:10: note: in instantiation of member function 'c10::optional<std::vector<c10::optional<long>>>::operator bool' requested here
    if (!dims_) {
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:613:20: note: in instantiation of member function 'c10::VaryingShape<long>::size' requested here
    return sizes().size();
                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:755:11: note: in instantiation of member function 'c10::optional<std::vector<c10::optional<long>>>::contained_val' requested here
        ? contained_val()
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:530:30: note: in instantiation of member function 'c10::optional<std::vector<c10::optional<long>>>::value' requested here
    const auto& dims = dims_.value();
                             ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:613:20: note: in instantiation of member function 'c10::VaryingShape<long>::size' requested here
    return sizes().size();
                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:505:61: note: in instantiation of member function 'c10::optional<std::vector<c10::optional<c10::Stride>>>::optional' requested here
  VaryingShape(c10::optional<size_t> size = c10::nullopt) : dims_(c10::nullopt) {
                                                            ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:680:22: note: in instantiation of member function 'c10::VaryingShape<c10::Stride>::VaryingShape' requested here
    copy->strides_ = VaryingShape<Stride>(d);
                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:685:9: note: in instantiation of member function 'c10::optional<std::vector<c10::optional<c10::Stride>>>::initialized' requested here
    if (initialized()) {
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:507:13: note: in instantiation of function template specialization 'c10::optional<std::vector<c10::optional<c10::Stride>>>::operator=<std::vector<c10::optional<c10::Stride>>>' requested here
      dims_ = ListOfOptionalElements(*size);
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:680:22: note: in instantiation of member function 'c10::VaryingShape<c10::Stride>::VaryingShape' requested here
    copy->strides_ = VaryingShape<Stride>(d);
                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:686:7: note: in instantiation of member function 'c10::optional<std::vector<c10::optional<c10::Stride>>>::contained_val' requested here
      contained_val() = std::forward<U>(v);
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:507:13: note: in instantiation of function template specialization 'c10::optional<std::vector<c10::optional<c10::Stride>>>::operator=<std::vector<c10::optional<c10::Stride>>>' requested here
      dims_ = ListOfOptionalElements(*size);
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:680:22: note: in instantiation of member function 'c10::VaryingShape<c10::Stride>::VaryingShape' requested here
    copy->strides_ = VaryingShape<Stride>(d);
                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<std::vector<c10::optional<c10::Stride>>>::initialize<std::vector<c10::optional<c10::Stride>>>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:507:13: note: in instantiation of function template specialization 'c10::optional<std::vector<c10::optional<c10::Stride>>>::operator=<std::vector<c10::optional<c10::Stride>>>' requested here
      dims_ = ListOfOptionalElements(*size);
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:680:22: note: in instantiation of member function 'c10::VaryingShape<c10::Stride>::VaryingShape' requested here
    copy->strides_ = VaryingShape<Stride>(d);
                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<std::vector<c10::optional<c10::Stride>>>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<std::vector<c10::optional<c10::Stride>>>::initialize<std::vector<c10::optional<c10::Stride>>>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:507:13: note: in instantiation of function template specialization 'c10::optional<std::vector<c10::optional<c10::Stride>>>::operator=<std::vector<c10::optional<c10::Stride>>>' requested here
      dims_ = ListOfOptionalElements(*size);
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:680:22: note: in instantiation of member function 'c10::VaryingShape<c10::Stride>::VaryingShape' requested here
    copy->strides_ = VaryingShape<Stride>(d);
                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:551:12: note: in instantiation of function template specialization 'c10::optional<std::vector<long>>::optional<std::vector<long>, false>' requested here
    return sizes;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:726:35: note: in instantiation of member function 'c10::VaryingShape<long>::concrete_sizes' requested here
    TORCH_INTERNAL_ASSERT(sizes().concrete_sizes().has_value());
                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<std::vector<c10::optional<c10::Stride>>>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:558:19: note: in instantiation of member function 'c10::optional<std::vector<c10::optional<c10::Stride>>>::operator*' requested here
    for (auto d : *dims_) {
                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:745:71: note: in instantiation of member function 'c10::VaryingShape<c10::Stride>::isComplete' requested here
    return scalar_type_ && device_ && sizes_.isComplete() && strides_.isComplete();
                                                                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<bool>::initialize<bool>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:773:19: note: in instantiation of function template specialization 'c10::optional<bool>::operator=<bool>' requested here
    r->undefined_ = true;
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<bool>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<bool>::initialize<bool>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:773:19: note: in instantiation of function template specialization 'c10::optional<bool>::operator=<bool>' requested here
    r->undefined_ = true;
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:596:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(false);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:669:5: note: in instantiation of member function 'c10::optional<bool>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:779:19: note: in instantiation of member function 'c10::optional<bool>::operator=' requested here
    r->undefined_ = c10::nullopt;
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:138:9: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>::optional' requested here
      : guard_() // See Note [Explicit initialization of optional fields]
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:88:36: note: in instantiation of member function 'c10::impl::InlineOptionalStreamGuard<c10::impl::VirtualGuardImpl>::InlineOptionalStreamGuard' requested here
  explicit OptionalStreamGuard() : guard_() {}
                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:652:9: note: in instantiation of template type alias 'OptionalBase' requested here
      : OptionalBase<T>(in_place_t{}, constexpr_forward<Args>(args)...) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:153:9: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>::optional<c10::Stream &>' requested here
      : guard_(in_place, std::forward<Args>(args)...) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:92:49: note: in instantiation of function template specialization 'c10::impl::InlineOptionalStreamGuard<c10::impl::VirtualGuardImpl>::InlineOptionalStreamGuard<c10::Stream &>' requested here
  explicit OptionalStreamGuard(Stream stream) : guard_(stream) {}
                                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:594:9: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>::initialized' requested here
    if (initialized())
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:695:5: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:146:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>::emplace<c10::Stream &>' requested here
      guard_.emplace(stream_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:98:9: note: in instantiation of member function 'c10::impl::InlineOptionalStreamGuard<c10::impl::VirtualGuardImpl>::InlineOptionalStreamGuard' requested here
      : guard_(stream_opt) {}
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:596:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(false);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:695:5: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:146:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>::emplace<c10::Stream &>' requested here
      guard_.emplace(stream_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:98:9: note: in instantiation of member function 'c10::impl::InlineOptionalStreamGuard<c10::impl::VirtualGuardImpl>::InlineOptionalStreamGuard' requested here
      : guard_(stream_opt) {}
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:595:7: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>::dataptr' requested here
      dataptr()->~T();
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:695:5: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:146:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>::emplace<c10::Stream &>' requested here
      guard_.emplace(stream_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:98:9: note: in instantiation of member function 'c10::impl::InlineOptionalStreamGuard<c10::impl::VirtualGuardImpl>::InlineOptionalStreamGuard' requested here
      : guard_(stream_opt) {}
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:696:5: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>::initialize<c10::Stream &>' requested here
    initialize(std::forward<Args>(args)...);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:146:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>::emplace<c10::Stream &>' requested here
      guard_.emplace(stream_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:98:9: note: in instantiation of member function 'c10::impl::InlineOptionalStreamGuard<c10::impl::VirtualGuardImpl>::InlineOptionalStreamGuard' requested here
      : guard_(stream_opt) {}
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:580:38: note: in instantiation of template type alias 'OptionalBase' requested here
    return detail_::static_addressof(OptionalBase<T>::storage_.value_);
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:731:60: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>::dataptr' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), dataptr());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:178:53: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::impl::VirtualGuardImpl>>::operator->' requested here
    return guard_.has_value() ? make_optional(guard_->original_stream())
                                                    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:122:19: note: in instantiation of member function 'c10::impl::InlineOptionalStreamGuard<c10::impl::VirtualGuardImpl>::original_stream' requested here
    return guard_.original_stream();
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:206:12: note: in instantiation of member function 'c10::optional<c10::impl::VirtualGuardImpl>::optional' requested here
  explicit InlineMultiStreamGuard(ArrayRef<Stream> streams) {
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:149:57: note: in instantiation of member function 'c10::impl::InlineMultiStreamGuard<c10::impl::VirtualGuardImpl>::InlineMultiStreamGuard' requested here
  explicit MultiStreamGuard(ArrayRef<Stream> streams) : guard_(streams) {}
                                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:735:12: note: in instantiation of member function 'c10::optional<c10::impl::VirtualGuardImpl>::initialized' requested here
    assert(initialized());
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:211:48: note: in instantiation of member function 'c10::optional<c10::impl::VirtualGuardImpl>::operator->' requested here
        original_streams_.push_back(this->impl_->exchangeStream(s));
                                               ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:149:57: note: in instantiation of member function 'c10::impl::InlineMultiStreamGuard<c10::impl::VirtualGuardImpl>::InlineMultiStreamGuard' requested here
  explicit MultiStreamGuard(ArrayRef<Stream> streams) : guard_(streams) {}
                                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:596:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(false);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:695:5: note: in instantiation of member function 'c10::optional<c10::impl::VirtualGuardImpl>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:208:13: note: in instantiation of function template specialization 'c10::optional<c10::impl::VirtualGuardImpl>::emplace<c10::DeviceType>' requested here
      impl_.emplace(getDeviceTypeOfStreams(streams));
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:149:57: note: in instantiation of member function 'c10::impl::InlineMultiStreamGuard<c10::impl::VirtualGuardImpl>::InlineMultiStreamGuard' requested here
  explicit MultiStreamGuard(ArrayRef<Stream> streams) : guard_(streams) {}
                                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:696:5: note: in instantiation of function template specialization 'c10::optional<c10::impl::VirtualGuardImpl>::initialize<c10::DeviceType>' requested here
    initialize(std::forward<Args>(args)...);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:208:13: note: in instantiation of function template specialization 'c10::optional<c10::impl::VirtualGuardImpl>::emplace<c10::DeviceType>' requested here
      impl_.emplace(getDeviceTypeOfStreams(streams));
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:149:57: note: in instantiation of member function 'c10::impl::InlineMultiStreamGuard<c10::impl::VirtualGuardImpl>::InlineMultiStreamGuard' requested here
  explicit MultiStreamGuard(ArrayRef<Stream> streams) : guard_(streams) {}
                                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:736:12: note: in instantiation of member function 'c10::optional<c10::impl::VirtualGuardImpl>::dataptr' requested here
    return dataptr();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/StreamGuard.h:149:57: note: in instantiation of member function 'c10::impl::InlineMultiStreamGuard<c10::impl::VirtualGuardImpl>::InlineMultiStreamGuard' requested here
  explicit MultiStreamGuard(ArrayRef<Stream> streams) : guard_(streams) {}
                                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:1759:10: note: in instantiation of function template specialization 'c10::optional<at::Tensor>::optional<at::Tensor, false>' requested here
  return std::move(ivalue).to<T>();
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:1801:10: note: in instantiation of function template specialization 'c10::generic_to<at::Tensor>' requested here
  return generic_to(*this, _fake_type<T>{});
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:1675:36: note: in instantiation of function template specialization 'c10::IValue::to<c10::optional<at::Tensor>>' requested here
    result.push_back(impl->list[i].to<typename T::value_type>());
                                   ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:1682:10: note: in instantiation of function template specialization 'c10::createVectorLikeFromList<std::vector<c10::optional<at::Tensor>>>' requested here
  return createVectorLikeFromList<std::vector<T>>(impl);
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/ivalue_inl.h:1897:10: note: in instantiation of function template specialization 'c10::createVectorFromList<c10::optional<at::Tensor>>' requested here
  return createVectorFromList<c10::optional<at::Tensor>>(
         ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:652:9: note: in instantiation of template type alias 'OptionalBase' requested here
      : OptionalBase<T>(in_place_t{}, constexpr_forward<Args>(args)...) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:205:9: note: in instantiation of function template specialization 'c10::optional<c10::Device>::optional<const c10::DeviceType &>' requested here
        c10::optional<Device>(c10::in_place, std::forward<Args>(args)...));
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/detail/TensorDataContainer.h:163:51: note: in instantiation of function template specialization 'c10::TensorOptions::device<const c10::DeviceType &>' requested here
AT_FORALL_SCALAR_TYPES_AND3(Bool, Half, BFloat16, TENSOR)
                                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<c10::AliasAnalysisKind>::initialize<c10::AliasAnalysisKind &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:441:17: note: in instantiation of function template specialization 'c10::optional<c10::AliasAnalysisKind>::operator=<c10::AliasAnalysisKind &>' requested here
    alias_kind_ = v;
                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<c10::AliasAnalysisKind>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<c10::AliasAnalysisKind>::initialize<c10::AliasAnalysisKind &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema.h:441:17: note: in instantiation of function template specialization 'c10::optional<c10::AliasAnalysisKind>::operator=<c10::AliasAnalysisKind &>' requested here
    alias_kind_ = v;
                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:686:7: note: in instantiation of member function 'c10::optional<c10::either<c10::OperatorName, c10::FunctionSchema>>::contained_val' requested here
      contained_val() = std::forward<U>(v);
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/op_registration/op_registration.h:85:23: note: in instantiation of function template specialization 'c10::optional<c10::either<c10::OperatorName, c10::FunctionSchema>>::operator=<c10::either<c10::OperatorName, c10::FunctionSchema>>' requested here
        schemaOrName_ = c10::make_right<OperatorName, FunctionSchema>(std::move(schema));
                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<c10::either<c10::OperatorName, c10::FunctionSchema>>::initialize<c10::either<c10::OperatorName, c10::FunctionSchema>>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/op_registration/op_registration.h:85:23: note: in instantiation of function template specialization 'c10::optional<c10::either<c10::OperatorName, c10::FunctionSchema>>::operator=<c10::either<c10::OperatorName, c10::FunctionSchema>>' requested here
        schemaOrName_ = c10::make_right<OperatorName, FunctionSchema>(std::move(schema));
                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<c10::either<c10::OperatorName, c10::FunctionSchema>>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<c10::either<c10::OperatorName, c10::FunctionSchema>>::initialize<c10::either<c10::OperatorName, c10::FunctionSchema>>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/op_registration/op_registration.h:85:23: note: in instantiation of function template specialization 'c10::optional<c10::either<c10::OperatorName, c10::FunctionSchema>>::operator=<c10::either<c10::OperatorName, c10::FunctionSchema>>' requested here
        schemaOrName_ = c10::make_right<OperatorName, FunctionSchema>(std::move(schema));
                      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function_schema_inl.h:355:42: note: in instantiation of function template specialization 'c10::optional<unsigned long>::optional<const unsigned long &, false>' requested here
      checkArg<T>(inputs[pos], argument, pos);
                                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/function.h:61:17: note: in instantiation of function template specialization 'c10::FunctionSchema::checkAndNormalizeInputs<c10::Type>' requested here
    getSchema().checkAndNormalizeInputs(stack, kwargs);
                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:686:7: note: in instantiation of member function 'c10::optional<c10::IValue>::contained_val' requested here
      contained_val() = std::forward<U>(v);
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/custom_class_detail.h:54:12: note: in instantiation of function template specialization 'c10::optional<c10::IValue>::operator=<const c10::IValue &>' requested here
    value_ = rhs;
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<c10::IValue>::initialize<const c10::IValue &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/custom_class_detail.h:54:12: note: in instantiation of function template specialization 'c10::optional<c10::IValue>::operator=<const c10::IValue &>' requested here
    value_ = rhs;
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:736:12: note: in instantiation of member function 'c10::optional<c10::impl::AnnotatedSchema>::dataptr' requested here
    return dataptr();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:736:12: note: in instantiation of member function 'c10::optional<c10::impl::OperatorEntry::CppSignatureWithDebug>::dataptr' requested here
    return dataptr();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:736:12: note: in instantiation of member function 'c10::optional<std::chrono::duration<long, std::ratio<1, 1000>>>::dataptr' requested here
    return dataptr();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:736:12: note: in instantiation of member function 'c10::optional<c10::IValue>::dataptr' requested here
    return dataptr();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<std::basic_string<char>>::initialize<const std::basic_string<char> &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/ir.h:376:27: note: in instantiation of function template specialization 'c10::optional<std::basic_string<char>>::operator=<const std::basic_string<char> &>' requested here
    historic_schema_name_ = name;
                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<std::basic_string<char>>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<std::basic_string<char>>::initialize<const std::basic_string<char> &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/ir.h:376:27: note: in instantiation of function template specialization 'c10::optional<std::basic_string<char>>::operator=<const std::basic_string<char> &>' requested here
    historic_schema_name_ = name;
                          ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:686:7: note: in instantiation of member function 'c10::optional<torch::jit::SourceRange>::contained_val' requested here
      contained_val() = std::forward<U>(v);
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/ir.h:396:19: note: in instantiation of function template specialization 'c10::optional<torch::jit::SourceRange>::operator=<torch::jit::SourceRange>' requested here
    source_range_ = std::move(r);
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<torch::jit::SourceRange>::initialize<torch::jit::SourceRange>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/ir.h:396:19: note: in instantiation of function template specialization 'c10::optional<torch::jit::SourceRange>::operator=<torch::jit::SourceRange>' requested here
    source_range_ = std::move(r);
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<torch::jit::SourceRange>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<torch::jit::SourceRange>::initialize<torch::jit::SourceRange>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/ir.h:396:19: note: in instantiation of function template specialization 'c10::optional<torch::jit::SourceRange>::operator=<torch::jit::SourceRange>' requested here
    source_range_ = std::move(r);
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<c10::intrusive_ptr<torch::jit::InlinedCallStack>>::initialize<c10::intrusive_ptr<torch::jit::InlinedCallStack> &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/ir.h:439:16: note: in instantiation of function template specialization 'c10::optional<c10::intrusive_ptr<torch::jit::InlinedCallStack>>::operator=<c10::intrusive_ptr<torch::jit::InlinedCallStack> &>' requested here
    callstack_ = cs;
               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<c10::intrusive_ptr<torch::jit::InlinedCallStack>>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<c10::intrusive_ptr<torch::jit::InlinedCallStack>>::initialize<c10::intrusive_ptr<torch::jit::InlinedCallStack> &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/ir/ir.h:439:16: note: in instantiation of function template specialization 'c10::optional<c10::intrusive_ptr<torch::jit::InlinedCallStack>>::operator=<c10::intrusive_ptr<torch::jit::InlinedCallStack> &>' requested here
    callstack_ = cs;
               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:511:47: note: in instantiation of function template specialization 'c10::optional<std::vector<c10::optional<long>>>::optional<std::vector<c10::optional<long>>, false>' requested here
  VaryingShape(ListOfOptionalElements dims) : dims_(std::move(dims)) {}
                                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/jit_type.h:503:9: note: in instantiation of member function 'c10::VaryingShape<long>::VaryingShape' requested here
      : VaryingShape(ListOfOptionalElements(vec.begin(), vec.end())) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/runtime/argument_spec.h:384:9: note: in instantiation of member function 'c10::VaryingShape<long>::VaryingShape' requested here
        c10::VaryingShape<int64_t>{sizes()},
        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:584:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:740:60: note: in instantiation of member function 'c10::optional<signed char>::contained_val' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), contained_val());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:1232:33: note: in instantiation of member function 'c10::optional<signed char>::operator*' requested here
    return arg ? std::hash<T>{}(*arg) : result_type{};
                                ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/hash.h:258:10: note: in instantiation of member function 'std::hash<c10::optional<signed char>>::operator()' requested here
  return std::hash<T>()(o);
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/hash.h:279:26: note: in instantiation of function template specialization 'c10::_hash_detail::dispatch_hash<c10::optional<signed char>>' requested here
    return _hash_detail::dispatch_hash(o);
                         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/hash.h:330:10: note: (skipping 3 contexts in backtrace; use -ftemplate-backtrace-limit=0 to see all)
  return c10::hash<T>()(o);
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/hash.h:291:11: note: in instantiation of member function 'c10::hash<std::tuple<const c10::optional<signed char> &, const c10::VaryingShape<long> &, const c10::VaryingShape<long> &, const c10::optional<bool> &>>::tuple_hash<1, const c10::optional<signed char> &, const c10::VaryingShape<long> &, const c10::VaryingShape<long> &, const c10::optional<bool> &>::operator()' requested here
          tuple_hash<idx - 1, Ts...>()(t));
          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/hash.h:291:11: note: in instantiation of member function 'c10::hash<std::tuple<const c10::optional<signed char> &, const c10::VaryingShape<long> &, const c10::VaryingShape<long> &, const c10::optional<bool> &>>::tuple_hash<2, const c10::optional<signed char> &, const c10::VaryingShape<long> &, const c10::VaryingShape<long> &, const c10::optional<bool> &>::operator()' requested here
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/hash.h:303:12: note: in instantiation of member function 'c10::hash<std::tuple<const c10::optional<signed char> &, const c10::VaryingShape<long> &, const c10::VaryingShape<long> &, const c10::optional<bool> &>>::tuple_hash<3, const c10::optional<signed char> &, const c10::VaryingShape<long> &, const c10::VaryingShape<long> &, const c10::optional<bool> &>::operator()' requested here
    return tuple_hash<sizeof...(Types) - 1, Types...>()(t);
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/hash.h:344:10: note: in instantiation of member function 'c10::hash<std::tuple<const c10::optional<signed char> &, const c10::VaryingShape<long> &, const c10::VaryingShape<long> &, const c10::optional<bool> &>>::operator()' requested here
  return c10::hash<decltype(std::tie(args...))>()(std::tie(args...));
         ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/runtime/argument_spec.h:486:17: note: in instantiation of function template specialization 'c10::get_hash<c10::optional<signed char>, c10::VaryingShape<long>, c10::VaryingShape<long>, c10::optional<bool>>' requested here
    return c10::get_hash<
                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<std::shared_ptr<torch::jit::Graph>>::initialize<std::shared_ptr<torch::jit::Graph>>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:49:21: note: in instantiation of function template specialization 'c10::optional<std::shared_ptr<torch::jit::Graph>>::operator=<std::shared_ptr<torch::jit::Graph>>' requested here
    optimized_graph = graph_->copy();
                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<std::shared_ptr<torch::jit::Graph>>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<std::shared_ptr<torch::jit::Graph>>::initialize<std::shared_ptr<torch::jit::Graph>>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:49:21: note: in instantiation of function template specialization 'c10::optional<std::shared_ptr<torch::jit::Graph>>::operator=<std::shared_ptr<torch::jit::Graph>>' requested here
    optimized_graph = graph_->copy();
                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<torch::jit::ExecutorExecutionMode>::initialize<torch::jit::ExecutorExecutionMode &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:64:30: note: in instantiation of function template specialization 'c10::optional<torch::jit::ExecutorExecutionMode>::operator=<torch::jit::ExecutorExecutionMode &>' requested here
    executor_execution_mode_ = mode;
                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<torch::jit::ExecutorExecutionMode>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<torch::jit::ExecutorExecutionMode>::initialize<torch::jit::ExecutorExecutionMode &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:64:30: note: in instantiation of function template specialization 'c10::optional<torch::jit::ExecutorExecutionMode>::operator=<torch::jit::ExecutorExecutionMode &>' requested here
    executor_execution_mode_ = mode;
                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<torch::jit::GraphExecutor>::initialize<torch::jit::GraphExecutor>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:115:16: note: in instantiation of function template specialization 'c10::optional<torch::jit::GraphExecutor>::operator=<torch::jit::GraphExecutor>' requested here
      executor = GraphExecutor(opt_graph, name);
               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<torch::jit::GraphExecutor>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<torch::jit::GraphExecutor>::initialize<torch::jit::GraphExecutor>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/function_impl.h:115:16: note: in instantiation of function template specialization 'c10::optional<torch::jit::GraphExecutor>::operator=<torch::jit::GraphExecutor>' requested here
      executor = GraphExecutor(opt_graph, name);
               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<torch::jit::Method>::initialize<torch::jit::Method>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/object.h:131:18: note: in instantiation of function template specialization 'c10::optional<torch::jit::Method>::operator=<torch::jit::Method>' requested here
          setter = Method(_ivalue(), prop.setter);
                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<torch::jit::Method>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<torch::jit::Method>::initialize<torch::jit::Method>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/jit/api/object.h:131:18: note: in instantiation of function template specialization 'c10::optional<torch::jit::Method>::operator=<torch::jit::Method>' requested here
          setter = Method(_ivalue(), prop.setter);
                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:686:7: note: in instantiation of member function 'c10::optional<std::vector<std::vector<long>>>::contained_val' requested here
      contained_val() = std::forward<U>(v);
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_kineto.h:60:13: note: in instantiation of function template specialization 'c10::optional<std::vector<std::vector<long>>>::operator=<const std::vector<std::vector<long>> &>' requested here
    shapes_ = shapes;
            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<std::vector<std::vector<long>>>::initialize<const std::vector<std::vector<long>> &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_kineto.h:60:13: note: in instantiation of function template specialization 'c10::optional<std::vector<std::vector<long>>>::operator=<const std::vector<std::vector<long>> &>' requested here
    shapes_ = shapes;
            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<std::vector<std::vector<long>>>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<std::vector<std::vector<long>>>::initialize<const std::vector<std::vector<long>> &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_kineto.h:60:13: note: in instantiation of function template specialization 'c10::optional<std::vector<std::vector<long>>>::operator=<const std::vector<std::vector<long>> &>' requested here
    shapes_ = shapes;
            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:590:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::storage_.value_;
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:686:7: note: in instantiation of member function 'c10::optional<std::vector<std::basic_string<char>>>::contained_val' requested here
      contained_val() = std::forward<U>(v);
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_kineto.h:73:13: note: in instantiation of function template specialization 'c10::optional<std::vector<std::basic_string<char>>>::operator=<const std::vector<std::basic_string<char>> &>' requested here
    dtypes_ = dtypes;
            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<std::vector<std::basic_string<char>>>::initialize<const std::vector<std::basic_string<char>> &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_kineto.h:73:13: note: in instantiation of function template specialization 'c10::optional<std::vector<std::basic_string<char>>>::operator=<const std::vector<std::basic_string<char>> &>' requested here
    dtypes_ = dtypes;
            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<std::vector<std::basic_string<char>>>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<std::vector<std::basic_string<char>>>::initialize<const std::vector<std::basic_string<char>> &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/autograd/profiler_kineto.h:73:13: note: in instantiation of function template specialization 'c10::optional<std::vector<std::basic_string<char>>>::operator=<const std::vector<std::basic_string<char>> &>' requested here
    dtypes_ = dtypes;
            ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<long>::initialize<long>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/embedding.h:35:19: note: in instantiation of function template specialization 'c10::optional<long>::operator=<long>' requested here
      padding_idx = weight.size(0) + *padding_idx;
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<long>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<long>::initialize<long>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/embedding.h:35:19: note: in instantiation of function template specialization 'c10::optional<long>::operator=<long>' requested here
      padding_idx = weight.size(0) + *padding_idx;
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<long>::initialize<int>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/embedding.h:38:17: note: in instantiation of function template specialization 'c10::optional<long>::operator=<int>' requested here
    padding_idx = -1;
                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<double>::initialize<double &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/padding.h:31:16: note: in instantiation of function template specialization 'c10::optional<double>::operator=<double &>' requested here
    fill_value = value;
               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<double>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<double>::initialize<double &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/padding.h:31:16: note: in instantiation of function template specialization 'c10::optional<double>::operator=<double &>' requested here
    fill_value = value;
               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<torch::ExpandingArray<2>>::initialize<torch::ExpandingArray<2>>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:773:18: note: in instantiation of function template specialization 'c10::optional<torch::ExpandingArray<2>>::operator=<torch::ExpandingArray<2>>' requested here
    output_size_ = {(int64_t)(static_cast<double>(input.size(-2)) * (*output_ratio.value())[0]),
                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<2>>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<torch::ExpandingArray<2>>::initialize<torch::ExpandingArray<2>>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:773:18: note: in instantiation of function template specialization 'c10::optional<torch::ExpandingArray<2>>::operator=<torch::ExpandingArray<2>>' requested here
    output_size_ = {(int64_t)(static_cast<double>(input.size(-2)) * (*output_ratio.value())[0]),
                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<torch::ExpandingArray<3>>::initialize<torch::ExpandingArray<3>>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:852:18: note: in instantiation of function template specialization 'c10::optional<torch::ExpandingArray<3>>::operator=<torch::ExpandingArray<3>>' requested here
    output_size_ = {(int64_t)(static_cast<double>(input.size(-3)) * (*output_ratio.value())[0]),
                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:603:31: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<3>>::dataptr' requested here
    ::new (static_cast<void*>(dataptr())) T(std::forward<Args>(args)...);
                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<torch::ExpandingArray<3>>::initialize<torch::ExpandingArray<3>>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/pooling.h:852:18: note: in instantiation of function template specialization 'c10::optional<torch::ExpandingArray<3>>::operator=<torch::ExpandingArray<3>>' requested here
    output_size_ = {(int64_t)(static_cast<double>(input.size(-3)) * (*output_ratio.value())[0]),
                 ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:638:31: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(U&& u) : OptionalBase<T>(std::forward<U>(u)) {}
                              ^
/usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/ext/new_allocator.h:146:23: note: in instantiation of function template specialization 'c10::optional<double>::optional<const double &, false>' requested here
        { ::new((void *)__p) _Up(std::forward<_Args>(__args)...); }
                             ^
/usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/bits/alloc_traits.h:483:8: note: in instantiation of function template specialization '__gnu_cxx::new_allocator<c10::optional<double>>::construct<c10::optional<double>, const double &>' requested here
        { __a.construct(__p, std::forward<_Args>(__args)...); }
              ^
/usr/lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/bits/vector.tcc:115:21: note: in instantiation of function template specialization 'std::allocator_traits<std::allocator<c10::optional<double>>>::construct<c10::optional<double>, const double &>' requested here
            _Alloc_traits::construct(this->_M_impl, this->_M_impl._M_finish,
                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:107:25: note: in instantiation of function template specialization 'std::vector<c10::optional<double>>::emplace_back<const double &>' requested here
      scale_factor_list.emplace_back(elem);
                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<long>::initialize<const long &>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/expanding_array.h:137:24: note: in instantiation of function template specialization 'c10::optional<long>::operator=<const long &>' requested here
      this->values_[i] = values[i];
                       ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/expanding_array.h:125:9: note: in instantiation of member function 'torch::ExpandingArrayWithOptionalElem<2>::ExpandingArrayWithOptionalElem' requested here
      : ExpandingArrayWithOptionalElem(at::ArrayRef<T>(vec)) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/functional/upsampling.h:137:47: note: in instantiation of member function 'torch::ExpandingArrayWithOptionalElem<2>::ExpandingArrayWithOptionalElem' requested here
    return detail::adaptive_avg_pool2d(input, _interp_output_size(2, closed_over_args));
                                              ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/pooling.h:437:62: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<2>>::optional' requested here
  TORCH_ARG(c10::optional<ExpandingArray<D>>, output_size) = c10::nullopt;
                                                             ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/pooling.h:430:3: note: in instantiation of default member initializer 'torch::nn::FractionalMaxPoolOptions<2>::output_size_' requested here
  FractionalMaxPoolOptions(ExpandingArray<D> kernel_size)
  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/modules/pooling.h:587:33: note: in instantiation of member function 'torch::nn::FractionalMaxPoolOptions<2>::FractionalMaxPoolOptions' requested here
      : FractionalMaxPool2dImpl(FractionalMaxPool2dOptions(kernel_size)) {}
                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/pooling.h:442:66: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<2, double>>::optional' requested here
  TORCH_ARG(c10::optional<ExpandingArrayDouble>, output_ratio) = c10::nullopt;
                                                                 ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/pooling.h:430:3: note: in instantiation of default member initializer 'torch::nn::FractionalMaxPoolOptions<2>::output_ratio_' requested here
  FractionalMaxPoolOptions(ExpandingArray<D> kernel_size)
  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/modules/pooling.h:587:33: note: in instantiation of member function 'torch::nn::FractionalMaxPoolOptions<2>::FractionalMaxPoolOptions' requested here
      : FractionalMaxPool2dImpl(FractionalMaxPool2dOptions(kernel_size)) {}
                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/pooling.h:437:62: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<3>>::optional' requested here
  TORCH_ARG(c10::optional<ExpandingArray<D>>, output_size) = c10::nullopt;
                                                             ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/pooling.h:430:3: note: in instantiation of default member initializer 'torch::nn::FractionalMaxPoolOptions<3>::output_size_' requested here
  FractionalMaxPoolOptions(ExpandingArray<D> kernel_size)
  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/modules/pooling.h:631:33: note: in instantiation of member function 'torch::nn::FractionalMaxPoolOptions<3>::FractionalMaxPoolOptions' requested here
      : FractionalMaxPool3dImpl(FractionalMaxPool3dOptions(kernel_size)) {}
                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:620:44: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional(nullopt_t) noexcept : OptionalBase<T>(){};
                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/pooling.h:442:66: note: in instantiation of member function 'c10::optional<torch::ExpandingArray<3, double>>::optional' requested here
  TORCH_ARG(c10::optional<ExpandingArrayDouble>, output_ratio) = c10::nullopt;
                                                                 ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/options/pooling.h:430:3: note: in instantiation of default member initializer 'torch::nn::FractionalMaxPoolOptions<3>::output_ratio_' requested here
  FractionalMaxPoolOptions(ExpandingArray<D> kernel_size)
  ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/modules/pooling.h:631:33: note: in instantiation of member function 'torch::nn::FractionalMaxPoolOptions<3>::FractionalMaxPoolOptions' requested here
      : FractionalMaxPool3dImpl(FractionalMaxPool3dOptions(kernel_size)) {}
                                ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:688:7: note: in instantiation of function template specialization 'c10::optional<double>::initialize<double>' requested here
      initialize(std::forward<U>(v));
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/nn/utils/clip_grad.h:63:16: note: in instantiation of function template specialization 'c10::optional<double>::operator=<double>' requested here
    total_norm = total_norm_tensor.item().toDouble();
               ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:596:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(false);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:669:5: note: in instantiation of member function 'c10::optional<long>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/optim/lbfgs.h:65:19: note: in instantiation of member function 'c10::optional<long>::operator=' requested here
     _numel_cache = c10::nullopt;
                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:223:9: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::optional' requested here
      : guard_() // See Note [Explicit initialization of optional fields]
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:244:51: note: in instantiation of member function 'c10::impl::InlineOptionalDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineOptionalDeviceGuard' requested here
  explicit OptionalHIPGuardMasqueradingAsCUDA() : guard_() {}
                                                  ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:594:9: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::initialized' requested here
    if (initialized())
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:695:5: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:230:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::emplace<c10::Device &>' requested here
      guard_.emplace(device_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:245:78: note: in instantiation of member function 'c10::impl::InlineOptionalDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineOptionalDeviceGuard' requested here
  explicit OptionalHIPGuardMasqueradingAsCUDA(optional<Device> device_opt) : guard_(device_opt) {}
                                                                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:596:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(false);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:695:5: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:230:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::emplace<c10::Device &>' requested here
      guard_.emplace(device_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:245:78: note: in instantiation of member function 'c10::impl::InlineOptionalDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineOptionalDeviceGuard' requested here
  explicit OptionalHIPGuardMasqueradingAsCUDA(optional<Device> device_opt) : guard_(device_opt) {}
                                                                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:595:7: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::dataptr' requested here
      dataptr()->~T();
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:695:5: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:230:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::emplace<c10::Device &>' requested here
      guard_.emplace(device_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:245:78: note: in instantiation of member function 'c10::impl::InlineOptionalDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineOptionalDeviceGuard' requested here
  explicit OptionalHIPGuardMasqueradingAsCUDA(optional<Device> device_opt) : guard_(device_opt) {}
                                                                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:696:5: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::initialize<c10::Device &>' requested here
    initialize(std::forward<Args>(args)...);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:230:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::emplace<c10::Device &>' requested here
      guard_.emplace(device_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:245:78: note: in instantiation of member function 'c10::impl::InlineOptionalDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineOptionalDeviceGuard' requested here
  explicit OptionalHIPGuardMasqueradingAsCUDA(optional<Device> device_opt) : guard_(device_opt) {}
                                                                             ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:696:5: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::initialize<signed char &>' requested here
    initialize(std::forward<Args>(args)...);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:242:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::emplace<signed char &>' requested here
      guard_.emplace(device_index_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:246:89: note: in instantiation of function template specialization 'c10::impl::InlineOptionalDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineOptionalDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA, void>' requested here
  explicit OptionalHIPGuardMasqueradingAsCUDA(optional<DeviceIndex> device_index_opt) : guard_(device_index_opt) {}
                                                                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:580:38: note: in instantiation of template type alias 'OptionalBase' requested here
    return detail_::static_addressof(OptionalBase<T>::storage_.value_);
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:731:60: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::dataptr' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), dataptr());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineDeviceGuard.h:409:53: note: in instantiation of member function 'c10::optional<c10::impl::InlineDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::operator->' requested here
    return guard_.has_value() ? make_optional(guard_->original_device())
                                                    ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:256:60: note: in instantiation of member function 'c10::impl::InlineOptionalDeviceGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::original_device' requested here
  optional<Device> original_device() const { return guard_.original_device(); }
                                                           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:138:9: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::optional' requested here
      : guard_() // See Note [Explicit initialization of optional fields]
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:289:57: note: in instantiation of member function 'c10::impl::InlineOptionalStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineOptionalStreamGuard' requested here
  explicit OptionalHIPStreamGuardMasqueradingAsCUDA() : guard_() {}
                                                        ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:652:9: note: in instantiation of template type alias 'OptionalBase' requested here
      : OptionalBase<T>(in_place_t{}, constexpr_forward<Args>(args)...) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:153:9: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::optional<c10::Stream &>' requested here
      : guard_(in_place, std::forward<Args>(args)...) {}
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:290:70: note: in instantiation of function template specialization 'c10::impl::InlineOptionalStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineOptionalStreamGuard<c10::Stream &>' requested here
  explicit OptionalHIPStreamGuardMasqueradingAsCUDA(Stream stream) : guard_(stream) {}
                                                                     ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:594:9: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::initialized' requested here
    if (initialized())
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:695:5: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:146:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::emplace<c10::Stream &>' requested here
      guard_.emplace(stream_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:291:84: note: in instantiation of member function 'c10::impl::InlineOptionalStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineOptionalStreamGuard' requested here
  explicit OptionalHIPStreamGuardMasqueradingAsCUDA(optional<Stream> stream_opt) : guard_(stream_opt) {}
                                                                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:596:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(false);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:695:5: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:146:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::emplace<c10::Stream &>' requested here
      guard_.emplace(stream_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:291:84: note: in instantiation of member function 'c10::impl::InlineOptionalStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineOptionalStreamGuard' requested here
  explicit OptionalHIPStreamGuardMasqueradingAsCUDA(optional<Stream> stream_opt) : guard_(stream_opt) {}
                                                                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:595:7: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::dataptr' requested here
      dataptr()->~T();
      ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:695:5: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:146:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::emplace<c10::Stream &>' requested here
      guard_.emplace(stream_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:291:84: note: in instantiation of member function 'c10::impl::InlineOptionalStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineOptionalStreamGuard' requested here
  explicit OptionalHIPStreamGuardMasqueradingAsCUDA(optional<Stream> stream_opt) : guard_(stream_opt) {}
                                                                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:696:5: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::initialize<c10::Stream &>' requested here
    initialize(std::forward<Args>(args)...);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:146:14: note: in instantiation of function template specialization 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::emplace<c10::Stream &>' requested here
      guard_.emplace(stream_opt.value());
             ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:291:84: note: in instantiation of member function 'c10::impl::InlineOptionalStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineOptionalStreamGuard' requested here
  explicit OptionalHIPStreamGuardMasqueradingAsCUDA(optional<Stream> stream_opt) : guard_(stream_opt) {}
                                                                                   ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:580:38: note: in instantiation of template type alias 'OptionalBase' requested here
    return detail_::static_addressof(OptionalBase<T>::storage_.value_);
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:731:60: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::dataptr' requested here
    return TR2_OPTIONAL_ASSERTED_EXPRESSION(initialized(), dataptr());
                                                           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:178:53: note: in instantiation of member function 'c10::optional<c10::impl::InlineStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>>::operator->' requested here
    return guard_.has_value() ? make_optional(guard_->original_stream())
                                                    ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:301:21: note: in instantiation of member function 'c10::impl::InlineOptionalStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::original_stream' requested here
    auto r = guard_.original_stream();
                    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:619:35: note: in instantiation of template type alias 'OptionalBase' requested here
  constexpr optional() noexcept : OptionalBase<T>(){};
                                  ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:206:12: note: in instantiation of member function 'c10::optional<c10::hip::HIPGuardImplMasqueradingAsCUDA>::optional' requested here
  explicit InlineMultiStreamGuard(ArrayRef<Stream> streams) {
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:326:7: note: in instantiation of member function 'c10::impl::InlineMultiStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineMultiStreamGuard' requested here
    : guard_(unwrapStreams(streams)) {}
      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:574:12: note: in instantiation of template type alias 'OptionalBase' requested here
    return OptionalBase<T>::initialized();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:735:12: note: in instantiation of member function 'c10::optional<c10::hip::HIPGuardImplMasqueradingAsCUDA>::initialized' requested here
    assert(initialized());
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:211:48: note: in instantiation of member function 'c10::optional<c10::hip::HIPGuardImplMasqueradingAsCUDA>::operator->' requested here
        original_streams_.push_back(this->impl_->exchangeStream(s));
                                               ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:326:7: note: in instantiation of member function 'c10::impl::InlineMultiStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineMultiStreamGuard' requested here
    : guard_(unwrapStreams(streams)) {}
      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:596:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(false);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:695:5: note: in instantiation of member function 'c10::optional<c10::hip::HIPGuardImplMasqueradingAsCUDA>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:208:13: note: in instantiation of function template specialization 'c10::optional<c10::hip::HIPGuardImplMasqueradingAsCUDA>::emplace<c10::DeviceType>' requested here
      impl_.emplace(getDeviceTypeOfStreams(streams));
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:326:7: note: in instantiation of member function 'c10::impl::InlineMultiStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineMultiStreamGuard' requested here
    : guard_(unwrapStreams(streams)) {}
      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:696:5: note: in instantiation of function template specialization 'c10::optional<c10::hip::HIPGuardImplMasqueradingAsCUDA>::initialize<c10::DeviceType>' requested here
    initialize(std::forward<Args>(args)...);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/core/impl/InlineStreamGuard.h:208:13: note: in instantiation of function template specialization 'c10::optional<c10::hip::HIPGuardImplMasqueradingAsCUDA>::emplace<c10::DeviceType>' requested here
      impl_.emplace(getDeviceTypeOfStreams(streams));
            ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:326:7: note: in instantiation of member function 'c10::impl::InlineMultiStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineMultiStreamGuard' requested here
    : guard_(unwrapStreams(streams)) {}
      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:736:12: note: in instantiation of member function 'c10::optional<c10::hip::HIPGuardImplMasqueradingAsCUDA>::dataptr' requested here
    return dataptr();
           ^
/opt/conda/lib/python3.8/site-packages/torch/include/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h:326:7: note: in instantiation of member function 'c10::impl::InlineMultiStreamGuard<c10::hip::HIPGuardImplMasqueradingAsCUDA>::InlineMultiStreamGuard' requested here
    : guard_(unwrapStreams(streams)) {}
      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:577:27: note: in instantiation of template type alias 'OptionalBase' requested here
    return std::addressof(OptionalBase<T>::storage_.value_);
                          ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:736:12: note: in instantiation of member function 'c10::optional<at::Tensor>::dataptr' requested here
    return dataptr();
           ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:5:
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1470:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
    hipDeviceSynchronize();
    ^~~~~~~~~~~~~~~~~~~~
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:83:18: note: in instantiation of function template specialization 'launch_attention_kernel<16U, 16U>' requested here
        case 16: LAUNCH_WITH_ARGS(16, 16); break;
                 ^
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:8:5: note: expanded from macro 'LAUNCH_WITH_ARGS'
    launch_attention_kernel<head_dim, chunk_size>(                          \
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:5:
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1470:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
    hipDeviceSynchronize();
    ^~~~~~~~~~~~~~~~~~~~
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:84:18: note: in instantiation of function template specialization 'launch_attention_kernel<16U, 32U>' requested here
        case 32: LAUNCH_WITH_ARGS(16, 32); break;
                 ^
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:8:5: note: expanded from macro 'LAUNCH_WITH_ARGS'
    launch_attention_kernel<head_dim, chunk_size>(                          \
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:5:
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1470:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
    hipDeviceSynchronize();
    ^~~~~~~~~~~~~~~~~~~~
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:91:18: note: in instantiation of function template specialization 'launch_attention_kernel<32U, 16U>' requested here
        case 16: LAUNCH_WITH_ARGS(32, 16); break;
                 ^
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:8:5: note: expanded from macro 'LAUNCH_WITH_ARGS'
    launch_attention_kernel<head_dim, chunk_size>(                          \
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:5:
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1470:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
    hipDeviceSynchronize();
    ^~~~~~~~~~~~~~~~~~~~
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:92:18: note: in instantiation of function template specialization 'launch_attention_kernel<32U, 32U>' requested here
        case 32: LAUNCH_WITH_ARGS(32, 32); break;
                 ^
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:8:5: note: expanded from macro 'LAUNCH_WITH_ARGS'
    launch_attention_kernel<head_dim, chunk_size>(                          \
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:5:
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1470:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
    hipDeviceSynchronize();
    ^~~~~~~~~~~~~~~~~~~~
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:93:18: note: in instantiation of function template specialization 'launch_attention_kernel<32U, 64U>' requested here
        case 64: LAUNCH_WITH_ARGS(32, 64); break;
                 ^
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:8:5: note: expanded from macro 'LAUNCH_WITH_ARGS'
    launch_attention_kernel<head_dim, chunk_size>(                          \
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:5:
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1470:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
    hipDeviceSynchronize();
    ^~~~~~~~~~~~~~~~~~~~
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:100:18: note: in instantiation of function template specialization 'launch_attention_kernel<64U, 16U>' requested here
        case 16: LAUNCH_WITH_ARGS(64, 16); break;
                 ^
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:8:5: note: expanded from macro 'LAUNCH_WITH_ARGS'
    launch_attention_kernel<head_dim, chunk_size>(                          \
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:5:
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1470:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
    hipDeviceSynchronize();
    ^~~~~~~~~~~~~~~~~~~~
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:101:18: note: in instantiation of function template specialization 'launch_attention_kernel<64U, 32U>' requested here
        case 32: LAUNCH_WITH_ARGS(64, 32); break;
                 ^
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:8:5: note: expanded from macro 'LAUNCH_WITH_ARGS'
    launch_attention_kernel<head_dim, chunk_size>(                          \
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:5:
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1470:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
    hipDeviceSynchronize();
    ^~~~~~~~~~~~~~~~~~~~
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:102:18: note: in instantiation of function template specialization 'launch_attention_kernel<64U, 64U>' requested here
        case 64: LAUNCH_WITH_ARGS(64, 64); break;
                 ^
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:8:5: note: expanded from macro 'LAUNCH_WITH_ARGS'
    launch_attention_kernel<head_dim, chunk_size>(                          \
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:5:
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1470:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
    hipDeviceSynchronize();
    ^~~~~~~~~~~~~~~~~~~~
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:103:19: note: in instantiation of function template specialization 'launch_attention_kernel<64U, 128U>' requested here
        case 128: LAUNCH_WITH_ARGS(64, 128); break;
                  ^
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:8:5: note: expanded from macro 'LAUNCH_WITH_ARGS'
    launch_attention_kernel<head_dim, chunk_size>(                          \
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:5:
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1470:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
    hipDeviceSynchronize();
    ^~~~~~~~~~~~~~~~~~~~
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:110:18: note: in instantiation of function template specialization 'launch_attention_kernel<128U, 16U>' requested here
        case 16: LAUNCH_WITH_ARGS(128, 16); break;
                 ^
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:8:5: note: expanded from macro 'LAUNCH_WITH_ARGS'
    launch_attention_kernel<head_dim, chunk_size>(                          \
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:5:
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1470:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
    hipDeviceSynchronize();
    ^~~~~~~~~~~~~~~~~~~~
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:111:18: note: in instantiation of function template specialization 'launch_attention_kernel<128U, 32U>' requested here
        case 32: LAUNCH_WITH_ARGS(128, 32); break;
                 ^
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:8:5: note: expanded from macro 'LAUNCH_WITH_ARGS'
    launch_attention_kernel<head_dim, chunk_size>(                          \
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:5:
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1470:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
    hipDeviceSynchronize();
    ^~~~~~~~~~~~~~~~~~~~
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:112:18: note: in instantiation of function template specialization 'launch_attention_kernel<128U, 64U>' requested here
        case 64: LAUNCH_WITH_ARGS(128, 64); break;
                 ^
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:8:5: note: expanded from macro 'LAUNCH_WITH_ARGS'
    launch_attention_kernel<head_dim, chunk_size>(                          \
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:5:
/data/zhaorong/code/fused-attention/include/fused_attn_hip.cuh:1470:5: warning: ignoring return value of function declared with 'nodiscard' attribute [-Wunused-result]
    hipDeviceSynchronize();
    ^~~~~~~~~~~~~~~~~~~~
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:113:19: note: in instantiation of function template specialization 'launch_attention_kernel<128U, 128U>' requested here
        case 128: LAUNCH_WITH_ARGS(128, 128); break;
                  ^
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:8:5: note: expanded from macro 'LAUNCH_WITH_ARGS'
    launch_attention_kernel<head_dim, chunk_size>(                          \
    ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:596:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(false);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:695:5: note: in instantiation of member function 'c10::optional<at::Tensor>::clear' requested here
    clear();
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/pybind11/stl.h:285:15: note: in instantiation of function template specialization 'c10::optional<at::Tensor>::emplace<at::Tensor>' requested here
        value.emplace(cast_op<typename T::value_type &&>(std::move(inner_caster)));
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/pybind11/cast.h:2030:47: note: in instantiation of member function 'pybind11::detail::optional_caster<c10::optional<at::Tensor>>::load' requested here
        if ((... || !std::get<Is>(argcasters).load(call.args[Is], call.args_convert[Is])))
                                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/pybind11/cast.h:2009:16: note: in instantiation of function template specialization 'pybind11::detail::argument_loader<int, int, at::Tensor, at::Tensor, at::Tensor, c10::optional<at::Tensor>>::load_impl_sequence<0UL, 1UL, 2UL, 3UL, 4UL, 5UL>' requested here
        return load_impl_sequence(call, indices{});
               ^
/opt/conda/lib/python3.8/site-packages/torch/include/pybind11/pybind11.h:174:33: note: in instantiation of member function 'pybind11::detail::argument_loader<int, int, at::Tensor, at::Tensor, at::Tensor, c10::optional<at::Tensor>>::load_args' requested here
            if (!args_converter.load_args(call))
                                ^
/opt/conda/lib/python3.8/site-packages/torch/include/pybind11/pybind11.h:70:9: note: in instantiation of function template specialization 'pybind11::cpp_function::initialize<at::Tensor (*&)(int, int, at::Tensor, at::Tensor, at::Tensor, c10::optional<at::Tensor>), at::Tensor, int, int, at::Tensor, at::Tensor, at::Tensor, c10::optional<at::Tensor>, pybind11::name, pybind11::scope, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg_v, char[26]>' requested here
        initialize(f, f, extra...);
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/pybind11/pybind11.h:962:22: note: in instantiation of function template specialization 'pybind11::cpp_function::cpp_function<at::Tensor, int, int, at::Tensor, at::Tensor, at::Tensor, c10::optional<at::Tensor>, pybind11::name, pybind11::scope, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg_v, char[26]>' requested here
        cpp_function func(std::forward<Func>(f), name(name_), scope(*this),
                     ^
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:127:7: note: in instantiation of function template specialization 'pybind11::module_::def<at::Tensor (*)(int, int, at::Tensor, at::Tensor, at::Tensor, c10::optional<at::Tensor>), pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg_v, char[26]>' requested here
    m.def("attention_forward",
      ^
In file included from /data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:2:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/extension.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/all.h:8:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/stateful.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader/base.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/data/dataloader_options.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/torch/csrc/api/include/torch/types.h:3:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/ATen.h:9:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/Context.h:4:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/ATen/core/Generator.h:22:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/GeneratorImpl.h:12:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorImpl.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/TensorOptions.h:10:
In file included from /opt/conda/lib/python3.8/site-packages/torch/include/c10/core/ScalarTypeToTypeMeta.h:4:
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:547:15: warning: builtin __has_trivial_copy is deprecated; use __is_trivially_constructible instead [-Wdeprecated-builtins]
              C10_IS_TRIVIALLY_COPYABLE(U) &&
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/macros/Macros.h:408:38: note: expanded from macro 'C10_IS_TRIVIALLY_COPYABLE'
#define C10_IS_TRIVIALLY_COPYABLE(T) __has_trivial_copy(T)
                                     ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:604:5: note: in instantiation of template type alias 'OptionalBase' requested here
    OptionalBase<T>::setInitialized(true);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/c10/util/Optional.h:696:5: note: in instantiation of function template specialization 'c10::optional<at::Tensor>::initialize<at::Tensor>' requested here
    initialize(std::forward<Args>(args)...);
    ^
/opt/conda/lib/python3.8/site-packages/torch/include/pybind11/stl.h:285:15: note: in instantiation of function template specialization 'c10::optional<at::Tensor>::emplace<at::Tensor>' requested here
        value.emplace(cast_op<typename T::value_type &&>(std::move(inner_caster)));
              ^
/opt/conda/lib/python3.8/site-packages/torch/include/pybind11/cast.h:2030:47: note: in instantiation of member function 'pybind11::detail::optional_caster<c10::optional<at::Tensor>>::load' requested here
        if ((... || !std::get<Is>(argcasters).load(call.args[Is], call.args_convert[Is])))
                                              ^
/opt/conda/lib/python3.8/site-packages/torch/include/pybind11/cast.h:2009:16: note: in instantiation of function template specialization 'pybind11::detail::argument_loader<int, int, at::Tensor, at::Tensor, at::Tensor, c10::optional<at::Tensor>>::load_impl_sequence<0UL, 1UL, 2UL, 3UL, 4UL, 5UL>' requested here
        return load_impl_sequence(call, indices{});
               ^
/opt/conda/lib/python3.8/site-packages/torch/include/pybind11/pybind11.h:174:33: note: in instantiation of member function 'pybind11::detail::argument_loader<int, int, at::Tensor, at::Tensor, at::Tensor, c10::optional<at::Tensor>>::load_args' requested here
            if (!args_converter.load_args(call))
                                ^
/opt/conda/lib/python3.8/site-packages/torch/include/pybind11/pybind11.h:70:9: note: in instantiation of function template specialization 'pybind11::cpp_function::initialize<at::Tensor (*&)(int, int, at::Tensor, at::Tensor, at::Tensor, c10::optional<at::Tensor>), at::Tensor, int, int, at::Tensor, at::Tensor, at::Tensor, c10::optional<at::Tensor>, pybind11::name, pybind11::scope, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg_v, char[26]>' requested here
        initialize(f, f, extra...);
        ^
/opt/conda/lib/python3.8/site-packages/torch/include/pybind11/pybind11.h:962:22: note: in instantiation of function template specialization 'pybind11::cpp_function::cpp_function<at::Tensor, int, int, at::Tensor, at::Tensor, at::Tensor, c10::optional<at::Tensor>, pybind11::name, pybind11::scope, pybind11::sibling, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg_v, char[26]>' requested here
        cpp_function func(std::forward<Func>(f), name(name_), scope(*this),
                     ^
/data/zhaorong/code/fused-attention/src/fused_attn_extention.hip:127:7: note: in instantiation of function template specialization 'pybind11::module_::def<at::Tensor (*)(int, int, at::Tensor, at::Tensor, at::Tensor, c10::optional<at::Tensor>), pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg, pybind11::arg_v, char[26]>' requested here
    m.def("attention_forward",
      ^
594 warnings generated when compiling for host.
creating build/lib.linux-x86_64-cpython-38
g++ -pthread -B /opt/conda/compiler_compat -Wl,--sysroot=/ -pthread -shared -B /opt/conda/compiler_compat -L/opt/conda/lib -Wl,-rpath=/opt/conda/lib -Wl,--no-as-needed -Wl,--sysroot=/ /data/zhaorong/code/fused-attention/build/temp.linux-x86_64-cpython-38/data/zhaorong/code/fused-attention/src/fused_attn_extention.o -L/opt/conda/lib/python3.8/site-packages/torch/lib -L/opt/rocm/lib -L/opt/rocm/hip/lib -lc10 -ltorch -ltorch_cpu -ltorch_python -lamdhip64 -lc10_hip -ltorch_hip -o build/lib.linux-x86_64-cpython-38/fused_attn.cpython-38-x86_64-linux-gnu.so
creating build/bdist.linux-x86_64
creating build/bdist.linux-x86_64/egg
copying build/lib.linux-x86_64-cpython-38/fused_attn.cpython-38-x86_64-linux-gnu.so -> build/bdist.linux-x86_64/egg
creating stub loader for fused_attn.cpython-38-x86_64-linux-gnu.so
byte-compiling build/bdist.linux-x86_64/egg/fused_attn.py to fused_attn.cpython-38.pyc
creating build/bdist.linux-x86_64/egg/EGG-INFO
copying fused_attn.egg-info/PKG-INFO -> build/bdist.linux-x86_64/egg/EGG-INFO
copying fused_attn.egg-info/SOURCES.txt -> build/bdist.linux-x86_64/egg/EGG-INFO
copying fused_attn.egg-info/dependency_links.txt -> build/bdist.linux-x86_64/egg/EGG-INFO
copying fused_attn.egg-info/top_level.txt -> build/bdist.linux-x86_64/egg/EGG-INFO
writing build/bdist.linux-x86_64/egg/EGG-INFO/native_libs.txt
creating 'dist/fused_attn-0.0.0-py3.8-linux-x86_64.egg' and adding 'build/bdist.linux-x86_64/egg' to it
removing 'build/bdist.linux-x86_64/egg' (and everything under it)
Processing fused_attn-0.0.0-py3.8-linux-x86_64.egg
removing '/opt/conda/lib/python3.8/site-packages/fused_attn-0.0.0-py3.8-linux-x86_64.egg' (and everything under it)
creating /opt/conda/lib/python3.8/site-packages/fused_attn-0.0.0-py3.8-linux-x86_64.egg
Extracting fused_attn-0.0.0-py3.8-linux-x86_64.egg to /opt/conda/lib/python3.8/site-packages
fused-attn 0.0.0 is already the active version in easy-install.pth

Installed /opt/conda/lib/python3.8/site-packages/fused_attn-0.0.0-py3.8-linux-x86_64.egg
Processing dependencies for fused-attn==0.0.0
Finished processing dependencies for fused-attn==0.0.0
